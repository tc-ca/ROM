{
  "properties": {
    "connectionReferences": {
      "shared_commondataserviceforapps_1": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "tdg_ConnectionReferenceDataverseServicePrinciple"
        },
        "api": {
          "name": "shared_commondataserviceforapps"
        }
      },
      "shared_commondataserviceforapps": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "tdg_ConnectionReferenceDataverseServicePrinciple"
        },
        "api": {
          "name": "shared_commondataserviceforapps"
        }
      },
      "shared_sharepointonline": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "tdg_ConnectionReferenceSharepointTDGCoreUser"
        },
        "api": {
          "name": "shared_sharepointonline"
        }
      },
      "shared_webcontents": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "cid_sharedwebcontents_efbe7"
        },
        "api": {
          "name": "shared_webcontents"
        }
      },
      "shared_sendmail": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "cid_sharedsendmail_2ba8f"
        },
        "api": {
          "name": "shared_sendmail"
        }
      }
    },
    "definition": {
      "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
      "contentVersion": "1.0.0.0",
      "parameters": {
        "$connections": {
          "defaultValue": {},
          "type": "Object"
        },
        "$authentication": {
          "defaultValue": {},
          "type": "SecureObject"
        }
      },
      "triggers": {
        "manual": {
          "metadata": {
            "operationMetadataId": "81beb847-f790-4030-9fef-18701d4ec075"
          },
          "type": "Request",
          "kind": "Button",
          "inputs": {
            "schema": {
              "type": "object",
              "properties": {
                "text": {
                  "title": "accountid",
                  "type": "string",
                  "x-ms-dynamically-added": true,
                  "description": "Please enter your input",
                  "x-ms-content-hint": "TEXT"
                },
                "text_1": {
                  "title": "fileLocation",
                  "type": "string",
                  "x-ms-dynamically-added": true,
                  "description": "Please enter your input",
                  "x-ms-content-hint": "TEXT"
                },
                "text_2": {
                  "title": "activityid",
                  "type": "string",
                  "x-ms-dynamically-added": true,
                  "description": "Please enter your input",
                  "x-ms-content-hint": "TEXT"
                },
                "text_3": {
                  "title": "ContactID",
                  "type": "string",
                  "x-ms-dynamically-added": true,
                  "description": "Please enter your input",
                  "x-ms-content-hint": "TEXT"
                }
              },
              "required": [
                "text",
                "text_1",
                "text_2",
                "text_3"
              ]
            }
          }
        }
      },
      "actions": {
        "get_environment_folder_index": {
          "runAfter": {
            "Initialize_Environment_folder_variable_": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "cac997f7-6d35-4460-bc0a-4e8cec6a876f"
          },
          "type": "Compose",
          "inputs": "@indexOf(triggerBody()['text_1'] , concat('/',variables('Environment_folder') ,'/'))"
        },
        "file_Ref_URL": {
          "runAfter": {
            "get_environment_folder_index": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "d0ebb858-c069-49cc-bed9-e450d11f29e8"
          },
          "type": "Compose",
          "inputs": "@substring(triggerBody()['text_1'] , outputs('get_environment_folder_index'))"
        },
        "Get_Account_Info": {
          "runAfter": {
            "file_Ref_URL": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f328cc40-e1a3-4029-9f69-19071dc13921"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "GetItem",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "accounts",
              "recordId": "@triggerBody()['text']"
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "Loop_in_Retrieved_Modes_table": {
          "foreach": "@outputs('Mode_of_Transportation_GUID')?['body/value']",
          "actions": {
            "current_Mode_row": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "d1567616-2137-475e-92c7-4f826991da9c"
              },
              "type": "Compose",
              "inputs": "@items('Loop_in_Retrieved_Modes_table')"
            },
            "Switch": {
              "runAfter": {
                "current_Mode_row": [
                  "Succeeded"
                ]
              },
              "cases": {
                "Case": {
                  "case": "Air",
                  "actions": {
                    "Set_variable_Air": {
                      "runAfter": {},
                      "type": "SetVariable",
                      "inputs": {
                        "name": "Air",
                        "value": "@{outputs('current_Mode_row')?['ovs_modesid']}"
                      }
                    }
                  }
                },
                "Case_2": {
                  "case": "Marine",
                  "actions": {
                    "Set_variable_Marine": {
                      "runAfter": {},
                      "type": "SetVariable",
                      "inputs": {
                        "name": "Marine",
                        "value": "@{outputs('current_Mode_row')?['ovs_modesid']}"
                      }
                    }
                  }
                },
                "Case_3": {
                  "case": "Rail",
                  "actions": {
                    "Set_Variable_Rail": {
                      "runAfter": {},
                      "type": "SetVariable",
                      "inputs": {
                        "name": "Rail",
                        "value": "@{outputs('current_Mode_row')?['ovs_modesid']}"
                      }
                    }
                  }
                },
                "Case_4": {
                  "case": "Road",
                  "actions": {
                    "Set_Variable_Road": {
                      "runAfter": {},
                      "type": "SetVariable",
                      "inputs": {
                        "name": "Road",
                        "value": "@{outputs('current_Mode_row')?['ovs_modesid']}"
                      }
                    }
                  }
                }
              },
              "default": {
                "actions": {}
              },
              "expression": "@outputs('current_Mode_row')?['ovs_name']",
              "metadata": {
                "operationMetadataId": "7e6a3574-afd7-498f-9e04-0f2d4a2f0d1d"
              },
              "type": "Switch"
            }
          },
          "runAfter": {
            "Mode_of_Transportation_GUID": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "bd691b6d-cdb5-4a48-8cba-2602d7d8502d"
          },
          "type": "Foreach"
        },
        "Mode_of_Transportation_GUID": {
          "runAfter": {
            "accountlookup": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "8c1351c7-35f8-4f3e-a230-15320d7ec768"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "ListRecords",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "ovs_modeses",
              "$select": "ovs_name"
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "List_UN_numbers": {
          "runAfter": {
            "accountlookup": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "dcf9fd85-9ef3-4860-802f-660f43841906"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "ListRecords",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "tdg_unnumbers",
              "$select": "tdg_name,tdg_unnumberid,tdg_packinggroupcd,tdg_undisplayname"
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "accountlookup": {
          "runAfter": {
            "Site-Sheet-columns": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "018b08e2-85b4-4259-9f95-2080218b835d"
          },
          "type": "Compose",
          "inputs": "@concat('/','accounts','/',triggerBody()['text'])"
        },
        "CID_Site_Requirement_Level": {
          "runAfter": {
            "Loop_in_Retrieved_Modes_table": [
              "Succeeded"
            ],
            "List_UN_numbers": [
              "Succeeded"
            ],
            "Choice_String_Maps": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "785d85ec-b4ca-460c-8e4e-d612c4eebefe"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "CID_Site_Requirement_Level",
                "type": "integer",
                "value": 100000000
              }
            ]
          }
        },
        "Loop_Excel_sheet_Sites_table": {
          "foreach": "@body('List_All_Sites_with_data')",
          "actions": {
            "current_row": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "420a8e5f-805b-440c-a13a-d5f047f098da"
              },
              "type": "Compose",
              "inputs": "@items('Loop_Excel_sheet_Sites_table')"
            },
            "Site_Classification": {
              "runAfter": {
                "current_row": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "341301d8-c2f1-4f28-8b7e-b5ceb7f72ab8"
              },
              "type": "Compose",
              "inputs": "@outputs('current_row')['values'][0][int(outputs('extendedYN'))]"
            },
            "Class_List": {
              "runAfter": {
                "check_if_extended_site": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "018b08e2-85b4-4259-9f95-2080218b835d"
              },
              "type": "Compose",
              "inputs": "@split(outputs('current_row')['values'][0][int(outputs('Class-column'))],',')"
            },
            "Add_Mode_of_Marine_if_exist": {
              "actions": {
                "Relate_rows-modes-to-operation-Marine": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "9f0f41b5-a0ab-4bb6-9722-f171365ad42d"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps_1",
                      "operationId": "AssociateEntities",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "ovs_modeses",
                      "recordId": "@variables('Marine')",
                      "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                      "item/@odata.id": "@outputs('Add_operation')?['body/@odata.id']"
                    },
                    "authentication": {
                      "type": "Raw",
                      "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                    }
                  }
                }
              },
              "runAfter": {
                "OperationId": [
                  "Succeeded"
                ]
              },
              "expression": {
                "or": [
                  {
                    "contains": [
                      "@outputs('current_row')['values'][0][int(outputs('Marine-column'))]",
                      "Yes"
                    ]
                  },
                  {
                    "equals": [
                      "@outputs('current_row')['values'][0][int(outputs('Marine-column'))]",
                      "Oui"
                    ]
                  }
                ]
              },
              "metadata": {
                "operationMetadataId": "2896c688-9b3b-415d-b77a-07e999028569"
              },
              "type": "If"
            },
            "account_id": {
              "runAfter": {
                "Add_Site": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "cd5817b9-00a5-4ebd-9fc2-139e037c84ea"
              },
              "type": "Compose",
              "inputs": "@outputs('Add_Site')?['body/accountid']"
            },
            "Add_Site": {
              "runAfter": {
                "check_Import_flag": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "4183b4c2-5f46-4aee-8cd7-1e5512f2e3bb"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "CreateRecord",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "accounts",
                  "item/address1_city": "@toUpper(outputs('current_row')['values'][0][int(outputs('City'))])",
                  "item/address1_country": "Canada",
                  "item/ovs_address_type": 0,
                  "item/ovs_legalname": "@outputs('Get_Account_Info')?['body/ovs_legalname']",
                  "item/name": "@outputs('Get_Account_Info')?['body/name']",
                  "item/customertypecode": 948010001,
                  "item/ovs_romid": " ",
                  "item/address1_stateorprovince": "@variables('Province')",
                  "item/address1_line1": "@toUpper(outputs('current_row')['values'][0][int(outputs('Address1'))])",
                  "item/address1_postalcode": "@toUpper(outputs('current_row')['values'][0][int(outputs('PostalCode'))])",
                  "item/cid_requirementlevel": "@variables('CID_Site_Requirement_Level')",
                  "item/cid_handlingsitetype": "@variables('Handle')",
                  "item/cid_importingsitetype": "@variables('Import')",
                  "item/address1_latitude": "@variables('Latitude')",
                  "item/address1_longitude": "@variables('Longtitud')",
                  "item/ovs_lld_meridian": "@outputs('Meridian_value')",
                  "item/cid_offeringfortransportsitetype": "@variables('OfferForTransport')",
                  "item/cid_operatingname": "@outputs('Get_Account_Info')?['body/cid_operatingname']",
                  "item/parentaccountid@odata.bind": "@outputs('accountlookup')",
                  "item/ovs_lld_quarter": "@outputs('Quarter_value')",
                  "item/ovs_lld_range": "@outputs('Range_value')",
                  "item/ovs_lld_section": "@outputs('Section_value_')",
                  "item/cid_sitename": "@outputs('current_row')['values'][0][int(outputs('SiteName'))]",
                  "item/cid_cidsitestatus": 100000004,
                  "item/address1_line2": "@outputs('current_row')['values'][0][int(outputs('Address2'))]",
                  "item/address1_line3": "@outputs('current_row')['values'][0][6]",
                  "item/ovs_lld_township": "@outputs('Township_value')",
                  "item/cid_transportingsitetype": "@variables('Transport')"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            },
            "Add_operation": {
              "runAfter": {
                "account_id": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "f0e14f9f-08f0-4bb9-b42d-abb8305d4693"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "CreateRecord",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "ovs_mocregistrations",
                  "item/ovs_registrationexpiry": "@addDays(utcNow(),364)",
                  "item/ovs_lineofbusiness@odata.bind": "@'/ovs_lobs/f3f10b28-a23c-ec11-8c62-0022483d7564'",
                  "item/ovs_operationtype": 918640038,
                  "item/ovs_SiteId@odata.bind": "@concat('/accounts/', outputs('account_id'))"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            },
            "check_if_extended_site": {
              "actions": {
                "Filter_string_map_with_Extended": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "b1543108-d7de-43e7-b374-bddc440f6daf"
                  },
                  "type": "Query",
                  "inputs": {
                    "from": "@outputs('StringMap_-_CID_Requirement_level_option_set')?['body/value']",
                    "where": "@equals(item()?['value'], 'Extended')"
                  }
                },
                "Set_requirement_level_to_extended_index": {
                  "runAfter": {
                    "Filter_string_map_with_Extended": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "b1c39805-1722-457c-a7e5-29ba5a6da411"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "CID_Site_Requirement_Level",
                    "value": "@int(body('Filter_string_map_with_Extended')?[0]['attributevalue'])"
                  }
                }
              },
              "runAfter": {
                "check_Longtitud_is_null": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "filter_string_map_with_Basic": {
                    "runAfter": {},
                    "metadata": {
                      "operationMetadataId": "2d9482cd-19f2-43d9-b4ce-bfbd7392ddc8"
                    },
                    "type": "Query",
                    "inputs": {
                      "from": "@outputs('StringMap_-_CID_Requirement_level_option_set')?['body/value']",
                      "where": "@equals(item()?['value'], 'Basic')"
                    }
                  },
                  "Set_variable": {
                    "runAfter": {
                      "filter_string_map_with_Basic": [
                        "Succeeded"
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "f7107a5d-bbc6-438c-bec6-ccf5b2864f3a"
                    },
                    "type": "SetVariable",
                    "inputs": {
                      "name": "CID_Site_Requirement_Level",
                      "value": "@int(body('filter_string_map_with_Basic')?[0]?['attributevalue'])"
                    }
                  }
                }
              },
              "expression": {
                "or": [
                  {
                    "contains": [
                      "@outputs('Site_Classification')",
                      "Yes"
                    ]
                  },
                  {
                    "equals": [
                      "@outputs('Site_Classification')",
                      "Oui"
                    ]
                  }
                ]
              },
              "metadata": {
                "operationMetadataId": "4248dcee-d3e5-46f8-a540-1c9267994d9e"
              },
              "type": "If"
            },
            "Add_Mode_Air_if_exist_in_excel_rows": {
              "actions": {
                "Relate_rows-modes-to-operation-Air": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "9f0f41b5-a0ab-4bb6-9722-f171365ad42d"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps_1",
                      "operationId": "AssociateEntities",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "ovs_modeses",
                      "recordId": "@variables('Air')",
                      "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                      "item/@odata.id": "@outputs('Add_operation')?['body/@odata.id']"
                    },
                    "authentication": {
                      "type": "Raw",
                      "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                    }
                  }
                }
              },
              "runAfter": {
                "OperationId": [
                  "Succeeded"
                ]
              },
              "expression": {
                "or": [
                  {
                    "contains": [
                      "@outputs('current_row')['values'][0][int(outputs('Air-column'))]",
                      "Yes"
                    ]
                  },
                  {
                    "equals": [
                      "@outputs('current_row')['values'][0][int(outputs('Air-column'))]",
                      "Oui"
                    ]
                  }
                ]
              },
              "metadata": {
                "operationMetadataId": "a5376aaa-2564-47f0-92b3-c1f7ae49a174"
              },
              "type": "If"
            },
            "Add_Mode_of_Road_if_exist_2": {
              "actions": {
                "Relate_rows-modes-to-operation-Road": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "9f0f41b5-a0ab-4bb6-9722-f171365ad42d"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps_1",
                      "operationId": "AssociateEntities",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "ovs_modeses",
                      "recordId": "@variables('Road')",
                      "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                      "item/@odata.id": "@outputs('Add_operation')?['body/@odata.id']"
                    },
                    "authentication": {
                      "type": "Raw",
                      "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                    }
                  }
                }
              },
              "runAfter": {
                "OperationId": [
                  "Succeeded"
                ]
              },
              "expression": {
                "or": [
                  {
                    "contains": [
                      "@outputs('current_row')['values'][0][int(outputs('Road-column'))]",
                      "Yes"
                    ]
                  },
                  {
                    "equals": [
                      "@outputs('current_row')['values'][0][int(outputs('Road-column'))]",
                      "Oui"
                    ]
                  }
                ]
              },
              "metadata": {
                "operationMetadataId": "5980f604-8f9d-4c2a-92d7-c639df25873e"
              },
              "type": "If"
            },
            "Add_Mode_of_Rail_if_exist": {
              "actions": {
                "Relate_rows-modes-to-operation-Rail": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "9f0f41b5-a0ab-4bb6-9722-f171365ad42d"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps_1",
                      "operationId": "AssociateEntities",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "ovs_modeses",
                      "recordId": "@variables('Rail')",
                      "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                      "item/@odata.id": "@outputs('Add_operation')?['body/@odata.id']"
                    },
                    "authentication": {
                      "type": "Raw",
                      "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                    }
                  }
                }
              },
              "runAfter": {
                "OperationId": [
                  "Succeeded"
                ]
              },
              "expression": {
                "or": [
                  {
                    "contains": [
                      "@outputs('current_row')['values'][0][int(outputs('Rail-column'))]",
                      "Yes"
                    ]
                  },
                  {
                    "equals": [
                      "@outputs('current_row')['values'][0][int(outputs('Rail-column'))]",
                      "Oui"
                    ]
                  }
                ]
              },
              "metadata": {
                "operationMetadataId": "51aa8e06-1273-4bd3-b4b3-36e96227dcf4"
              },
              "type": "If"
            },
            "Check_if_UN_number_found": {
              "actions": {
                "For_each_UN_number": {
                  "foreach": "@body('Filter_UnNumber_Table_with_Site')",
                  "actions": {
                    "UN_row": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "285f3692-c760-4400-8e86-c726bd09097a"
                      },
                      "type": "Compose",
                      "inputs": "@items('For_each_UN_number')"
                    },
                    "Check_if_UN_number_is_not_null": {
                      "actions": {
                        "Get_Type_of_measurement_option_set_index": {
                          "runAfter": {
                            "Check_if_more_than_un_found": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "7471031a-5efb-4103-a623-250e404dadb1"
                          },
                          "type": "Query",
                          "inputs": {
                            "from": "@outputs('StringMap_-_Type_of_measurement_list')?['body/value']",
                            "where": "@equals(item()?['value'], outputs('UN_row')['values'][0][3])"
                          }
                        },
                        "Add_Operation_UN_number": {
                          "runAfter": {
                            "Index_-_unit_of_measurement_type_": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "05ae44b8-6a21-4f37-b285-0ef585f2987b"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps_1",
                              "operationId": "CreateRecord",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "ovs_operationunnumbers",
                              "item/ovs_supplychaindirection": "930840000",
                              "item/ovs_UNNumber@odata.bind": "@concat('/tdg_unnumbers/', variables('UN_GUID') )",
                              "item/cid_annualnumberofshipment": "@outputs('UN_row')['values'][0][int(outputs('ExtendedAnnulaConsignment'))]",
                              "item/cid_annualquantityvolume": "@outputs('UN_row')['values'][0][int(outputs('ExtendedQuantity'))]",
                              "item/ovs_OperationUNNumber@odata.bind": "@\r\nconcat('/ovs_mocregistrations/',outputs('OperationId'))",
                              "item/cid_Site@odata.bind": "@concat('/accounts/', outputs('account_id'))",
                              "item/cid_unitofmeasurement": "@outputs('Index_-_unit_of_measurement_type_')"
                            },
                            "authentication": {
                              "type": "Raw",
                              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                            }
                          }
                        },
                        "Index_-_unit_of_measurement_type_": {
                          "runAfter": {
                            "Get_Type_of_measurement_option_set_index": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "9238ee04-e629-4672-a1ad-e7684ae864e8"
                          },
                          "type": "Compose",
                          "inputs": "@body('Get_Type_of_measurement_option_set_index')?[0]?['attributevalue']"
                        },
                        "UNNumber_Split": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "3489cbf9-0940-44d8-9b9b-7030d00bfe59"
                          },
                          "type": "Compose",
                          "inputs": "@split(outputs('UN_row')['values'][0][int(outputs('ExtendedUNNumber'))],'-')"
                        },
                        "UNNumber_Value": {
                          "runAfter": {
                            "UNNumber_Length": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "30b2551c-eaf1-48b2-aec9-16ef692b7829"
                          },
                          "type": "Compose",
                          "inputs": "@Trim(outputs('UNNumber_Split')[0])"
                        },
                        "UNNumber_Length": {
                          "runAfter": {
                            "UNNumber_Split": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "f1c64c63-d24f-4306-95a2-bb6dc41f32b9"
                          },
                          "type": "Compose",
                          "inputs": "@length(outputs('UNNumber_Split'))"
                        },
                        "Check_UNsplit_length": {
                          "actions": {
                            "Set_variable_-_UN_Number_display_Name": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "1476583d-a179-48d8-bc2d-55ce7c527b21"
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "UNDisplayName",
                                "value": "@{outputs('UNNumber_Value')} - @{Trim(outputs('UNNumber_Split')[1])}"
                              }
                            },
                            "Set_variable_-_shipping_name_index_2": {
                              "runAfter": {
                                "Set_variable_-_UN_Number_display_Name": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "4d694237-53ef-4e5f-82a1-fd0a485e9c76"
                              },
                              "type": "SetVariable",
                              "inputs": {
                                "name": "ShippingName",
                                "value": "@{Trim(outputs('UNNumber_Split')[2])}"
                              }
                            }
                          },
                          "runAfter": {
                            "UNNumber_Value": [
                              "Succeeded"
                            ]
                          },
                          "else": {
                            "actions": {
                              "Set_variable__UNDisplay_Name": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "b8a6e457-44c7-4957-99bd-7d17574a1abc"
                                },
                                "type": "SetVariable",
                                "inputs": {
                                  "name": "UNDisplayName",
                                  "value": "@{outputs('UNNumber_Value')}"
                                }
                              },
                              "Set_variable_Shipping_name_index_1": {
                                "runAfter": {
                                  "Set_variable__UNDisplay_Name": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "f257f527-d37e-4509-aa7e-31005e6c17d2"
                                },
                                "type": "SetVariable",
                                "inputs": {
                                  "name": "ShippingName",
                                  "value": "@{Trim(outputs('UNNumber_Split')[1])}"
                                }
                              }
                            }
                          },
                          "expression": {
                            "equals": [
                              "@outputs('UNNumber_Length')",
                              3
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "b7cc359a-65d6-4cd5-880d-32264e1fd8e4"
                          },
                          "type": "If"
                        },
                        "Check_if_more_than_un_found": {
                          "actions": {
                            "Apply_to_each_UN_filter_with_Display_Name": {
                              "foreach": "@body('Filter_UN_with_UNDisplayName')",
                              "actions": {
                                "currentRow-UN": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "1e2a20c0-b111-4fb8-8d99-cba07f67072a"
                                  },
                                  "type": "Compose",
                                  "inputs": "@items('Apply_to_each_UN_filter_with_Display_Name')"
                                },
                                "check_if_shipping_name_match_English_or_French": {
                                  "actions": {
                                    "Set_variable_UNGUID_match_by_shippingname": {
                                      "runAfter": {},
                                      "metadata": {
                                        "operationMetadataId": "065330c3-171e-482c-b379-c893c488e806"
                                      },
                                      "type": "SetVariable",
                                      "inputs": {
                                        "name": "UN_GUID",
                                        "value": "@{outputs('currentRow-UN')['tdg_unnumberid']}"
                                      }
                                    }
                                  },
                                  "runAfter": {
                                    "currentRow-UN": [
                                      "Succeeded"
                                    ]
                                  },
                                  "expression": {
                                    "or": [
                                      {
                                        "equals": [
                                          "@outputs('currentRow-UN')['tdg_shippingnamedescriptionetxt']",
                                          "@variables('ShippingName')"
                                        ]
                                      },
                                      {
                                        "equals": [
                                          "@outputs('currentRow-UN')['tdg_shippingnamedescriptionftxt']",
                                          "@variables('ShippingName')"
                                        ]
                                      }
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "4a376feb-1225-428b-8d9e-de5141067b2c"
                                  },
                                  "type": "If"
                                }
                              },
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "68c2e923-eb19-4339-9cc6-b3e440d39604"
                              },
                              "type": "Foreach"
                            }
                          },
                          "runAfter": {
                            "Set_variable_UNGUID": [
                              "Succeeded"
                            ]
                          },
                          "expression": {
                            "greater": [
                              "@length(body('Filter_UN_with_UNDisplayName'))",
                              1
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "7e4d5a2f-a421-406d-8b6c-60b5e4345e37"
                          },
                          "type": "If"
                        },
                        "Filter_UN_with_UNDisplayName": {
                          "runAfter": {
                            "Check_UNsplit_length": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "ccece463-ad60-44bb-be52-68dc4785f3fd"
                          },
                          "type": "Query",
                          "inputs": {
                            "from": "@outputs('List_UN_numbers')?['body/value']",
                            "where": "@equals(item()['tdg_undisplayname'], variables('UNDisplayName'))"
                          }
                        },
                        "Set_variable_UNGUID": {
                          "runAfter": {
                            "Filter_UN_with_UNDisplayName": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "1e70bed4-0a6d-4ef7-8f60-6edf0f6daaf7"
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "UN_GUID",
                            "value": "@{body('Filter_UN_with_UNDisplayName')?[0]['tdg_unnumberid']}"
                          }
                        }
                      },
                      "runAfter": {
                        "UN_row": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "greater": [
                          "@length(trim(outputs('UN_row')['values'][0][int(outputs('ExtendedUNNumber'))]))",
                          0
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "2ac58c16-5959-4c78-87fc-10684cfdbfb3"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "eed152cc-0c52-40af-b240-b00e466d8aed"
                  },
                  "type": "Foreach"
                }
              },
              "runAfter": {
                "Filter_UnNumber_Table_with_Site": [
                  "Succeeded"
                ]
              },
              "expression": {
                "greater": [
                  "@length(body('Filter_UnNumber_Table_with_Site'))",
                  0
                ]
              },
              "metadata": {
                "operationMetadataId": "27762c5a-e5d8-4aea-9ebc-da6d76714f03"
              },
              "type": "If"
            },
            "Loop_in_the_class_List": {
              "foreach": "@outputs('Class_List')",
              "actions": {
                "get_option_set_index": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "3874b476-84dc-4823-898f-1af674f9b7d3"
                  },
                  "type": "Query",
                  "inputs": {
                    "from": "@outputs('StringMap_-_List_Class')?['body/value']",
                    "where": "@equals(item()?['value'], items('Loop_in_the_class_List'))"
                  }
                },
                "Class_option_set_value": {
                  "runAfter": {
                    "get_option_set_index": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "067c96d1-9269-4851-8df7-173ef3d741e2"
                  },
                  "type": "Compose",
                  "inputs": "@body('get_option_set_index')?[0]?['attributevalue']"
                },
                "If_class_index_found": {
                  "actions": {
                    "integer_value_for_the_index": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "710c2984-a95a-45f4-8820-3f4eb9d36f59"
                      },
                      "type": "Compose",
                      "inputs": "@int(outputs('Class_option_set_value'))"
                    },
                    "Add_operation_class": {
                      "runAfter": {
                        "integer_value_for_the_index": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "920c2fd2-060f-469d-b24c-0f89d3779bc4"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps_1",
                          "operationId": "CreateRecord",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "ovs_operationclasses",
                          "item/ovs_primeclass": 48,
                          "item/ovs_supplychaindirection": "930840000",
                          "item/ovs_OperationClass@odata.bind": "@\r\nconcat('/ovs_mocregistrations/',outputs('OperationId'))"
                        },
                        "authentication": {
                          "type": "Raw",
                          "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                        }
                      }
                    }
                  },
                  "runAfter": {
                    "Class_option_set_value": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "greaterOrEquals": [
                      "@outputs('Class_option_set_value')",
                      0
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "83735453-fbb6-459a-8cbd-79fdad1f0392"
                  },
                  "type": "If"
                }
              },
              "runAfter": {
                "Filter_UnNumber_Table_with_Site": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "7ccc3b18-109a-4bdd-bc1a-c7e36794fd4b"
              },
              "type": "Foreach",
              "runtimeConfiguration": {
                "concurrency": {
                  "repetitions": 23
                }
              }
            },
            "Filter_UnNumber_Table_with_Site": {
              "runAfter": {
                "Add_Mode_Air_if_exist_in_excel_rows": [
                  "Succeeded"
                ],
                "Add_Mode_of_Marine_if_exist": [
                  "Succeeded"
                ],
                "Add_Mode_of_Rail_if_exist": [
                  "Succeeded"
                ],
                "Add_Mode_of_Road_if_exist_2": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "0199dc9b-c60d-49dd-8d1c-9d2b9521333b"
              },
              "type": "Query",
              "inputs": {
                "from": "@outputs('Invoke_an_HTTP_request_-_unnumber')?['body']['value']",
                "where": "@equals(item()['values'][0][int(outputs('ExtendedSite'))], outputs('current_row')['values'][0][int(outputs('SiteFullAddress'))])"
              }
            },
            "OperationId": {
              "runAfter": {
                "Add_operation": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "b2c11011-6bc8-4de4-b959-2607f8180c5f"
              },
              "type": "Compose",
              "inputs": "@outputs('Add_operation')?['body/ovs_mocregistrationid']"
            },
            "check_handle_flag": {
              "actions": {
                "set_handle_flag_to_yes": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "3c91026a-5396-4874-a753-01833c0ad131"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "Handle",
                    "value": "@true"
                  }
                }
              },
              "runAfter": {
                "Class_List": [
                  "Succeeded"
                ]
              },
              "expression": {
                "or": [
                  {
                    "contains": [
                      "@outputs('current_row')['values'][0][int(outputs('Handle'))]",
                      "Yes"
                    ]
                  },
                  {
                    "equals": [
                      "@outputs('current_row')['values'][0][int(outputs('Handle'))]",
                      "Oui"
                    ]
                  }
                ]
              },
              "metadata": {
                "operationMetadataId": "0243868a-0b92-45cf-b975-60127b55e54f"
              },
              "type": "If"
            },
            "check_offer_for_transport_flag": {
              "actions": {
                "set_offer_for_transport_flag_to_yes_2": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "9c4b9c63-d6b9-4270-8c9d-18b9cf140b57"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "OfferForTransport",
                    "value": "@true"
                  }
                }
              },
              "runAfter": {
                "check_handle_flag": [
                  "Succeeded"
                ]
              },
              "expression": {
                "or": [
                  {
                    "contains": [
                      "@outputs('current_row')['values'][0][int(outputs('OfferForTransport'))]",
                      "Yes"
                    ]
                  },
                  {
                    "equals": [
                      "@outputs('current_row')['values'][0][int(outputs('OfferForTransport'))]",
                      "Oui"
                    ]
                  }
                ]
              },
              "metadata": {
                "operationMetadataId": "f8e2f3f0-9882-44a8-9b4b-fef4751caec1"
              },
              "type": "If"
            },
            "check_Transport_flag": {
              "actions": {
                "set_Transport_flag_to_yes_2": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "ff8cda54-bc7e-459c-ad45-d5b6cb620fd9"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "Transport",
                    "value": "@true"
                  }
                }
              },
              "runAfter": {
                "check_offer_for_transport_flag": [
                  "Succeeded"
                ]
              },
              "expression": {
                "or": [
                  {
                    "contains": [
                      "@outputs('current_row')['values'][0][int(outputs('Transport'))]",
                      "Yes"
                    ]
                  },
                  {
                    "equals": [
                      "@outputs('current_row')['values'][0][int(outputs('Transport'))]",
                      "Oui"
                    ]
                  }
                ]
              },
              "metadata": {
                "operationMetadataId": "59306e03-00c5-4263-8380-45bff85f4ae8"
              },
              "type": "If"
            },
            "check_Import_flag": {
              "actions": {
                "set_Import_flag_to_yes_": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "56fcfed0-60f1-4b5e-a3b4-8fd8e84d2453"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "Import",
                    "value": "@true"
                  }
                }
              },
              "runAfter": {
                "check_Transport_flag": [
                  "Succeeded"
                ]
              },
              "expression": {
                "or": [
                  {
                    "contains": [
                      "@outputs('current_row')['values'][0][int(outputs('Import'))]",
                      "Yes"
                    ]
                  },
                  {
                    "equals": [
                      "@outputs('current_row')['values'][0][int(outputs('Import'))]",
                      "Oui"
                    ]
                  }
                ]
              },
              "metadata": {
                "operationMetadataId": "31ece6f0-0f94-4493-8047-602ac4ea9ce8"
              },
              "type": "If"
            },
            "Scope-LLD": {
              "actions": {
                "get_Quarter_index": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "3874b476-84dc-4823-898f-1af674f9b7d3"
                  },
                  "type": "Query",
                  "inputs": {
                    "from": "@outputs('StringMap-Quarter-LLD')?['body/value']",
                    "where": "@equals(item()?['value'], outputs('current_row')['values'][0][int(outputs('Quarter'))])"
                  }
                },
                "Quarter_value": {
                  "runAfter": {
                    "get_Quarter_index": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "067c96d1-9269-4851-8df7-173ef3d741e2"
                  },
                  "type": "Compose",
                  "inputs": "@body('get_Quarter_index')?[0]?['attributevalue']"
                },
                "get_Section_index": {
                  "runAfter": {
                    "Compose": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "3874b476-84dc-4823-898f-1af674f9b7d3"
                  },
                  "type": "Query",
                  "inputs": {
                    "from": "@outputs('StringMap-Section')?['body/value']",
                    "where": "@equals(item()?['value'], Trim(String(outputs('current_row')['values'][0][int(outputs('Section'))])))"
                  }
                },
                "Section_value_": {
                  "runAfter": {
                    "get_Section_index": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "067c96d1-9269-4851-8df7-173ef3d741e2"
                  },
                  "type": "Compose",
                  "inputs": "@body('get_Section_index')?[0]?['attributevalue']"
                },
                "Township_value": {
                  "runAfter": {
                    "get_Township_index": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "067c96d1-9269-4851-8df7-173ef3d741e2"
                  },
                  "type": "Compose",
                  "inputs": "@body('get_Township_index')?[0]?['attributevalue']"
                },
                "Range_value": {
                  "runAfter": {
                    "get_Range_index": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "067c96d1-9269-4851-8df7-173ef3d741e2"
                  },
                  "type": "Compose",
                  "inputs": "@body('get_Range_index')?[0]?['attributevalue']"
                },
                "Meridian_value": {
                  "runAfter": {
                    "get_Meridian_index": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "067c96d1-9269-4851-8df7-173ef3d741e2"
                  },
                  "type": "Compose",
                  "inputs": "@body('get_Meridian_index')?[0]?['attributevalue']"
                },
                "get_Township_index": {
                  "runAfter": {
                    "Section_value_": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "3874b476-84dc-4823-898f-1af674f9b7d3"
                  },
                  "type": "Query",
                  "inputs": {
                    "from": "@outputs('StringMap-TownShip')?['body/value']",
                    "where": "@equals(item()?['value'], Trim(string(outputs('current_row')['values'][0][int(outputs('TownShip'))])))"
                  }
                },
                "get_Range_index": {
                  "runAfter": {
                    "Township_value": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "3874b476-84dc-4823-898f-1af674f9b7d3"
                  },
                  "type": "Query",
                  "inputs": {
                    "from": "@outputs('StringMap-Range')?['body/value']",
                    "where": "@equals(item()?['value'], Trim(String(outputs('current_row')['values'][0][int(outputs('Range'))])))"
                  }
                },
                "get_Meridian_index": {
                  "runAfter": {
                    "Range_value": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "3874b476-84dc-4823-898f-1af674f9b7d3"
                  },
                  "type": "Query",
                  "inputs": {
                    "from": "@outputs('StringMap-Quarter-Meridian')?['body/value']",
                    "where": "@equals(item()?['value'], Trim(String(outputs('current_row')['values'][0][int(outputs('Meridian'))])))"
                  }
                },
                "Compose": {
                  "runAfter": {
                    "Quarter_value": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "da4578ff-2ab7-4d5f-b541-3f5cac50b27a"
                  },
                  "type": "Compose",
                  "inputs": "@body('get_Quarter_index')?[0]?['attributevalue']"
                }
              },
              "runAfter": {
                "Site_Classification": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "86fec622-8eb1-4685-8245-373c34709bc6"
              },
              "type": "Scope"
            },
            "check_if_Lat_is_null": {
              "actions": {
                "Set_variable_4": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "02b1acd3-d16c-4818-bda9-a50a9eb0fe9a"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "Latitude",
                    "value": 0
                  }
                }
              },
              "runAfter": {
                "Check_Province_source_-_address_or_LLD": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "set_Lat": {
                    "runAfter": {},
                    "metadata": {
                      "operationMetadataId": "271f9b94-90b9-46a2-90ea-23c0be67103e"
                    },
                    "type": "SetVariable",
                    "inputs": {
                      "name": "Latitude",
                      "value": "@float(outputs('current_row')['values'][0][int(outputs('Lat'))])"
                    }
                  }
                }
              },
              "expression": {
                "equals": [
                  "@length(outputs('current_row')['values'][0][int(outputs('Lat'))])",
                  0
                ]
              },
              "metadata": {
                "operationMetadataId": "05059c41-a063-4ab7-8a38-8e5db727ae00"
              },
              "type": "If"
            },
            "check_Longtitud_is_null": {
              "actions": {
                "Set_Longtitude_to_null": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "c18ceebe-d73c-49d1-a67b-dc529e5b544e"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "Longtitud",
                    "value": 0
                  }
                }
              },
              "runAfter": {
                "check_if_Lat_is_null": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "set_Long": {
                    "runAfter": {},
                    "metadata": {
                      "operationMetadataId": "b159d4a8-0d52-4c64-a1ef-258f0e697e57"
                    },
                    "type": "SetVariable",
                    "inputs": {
                      "name": "Longtitud",
                      "value": "@float(outputs('current_row')['values'][0][int(outputs('Long'))])"
                    }
                  }
                }
              },
              "expression": {
                "equals": [
                  "@length(outputs('current_row')['values'][0][int(outputs('Long'))])",
                  0
                ]
              },
              "metadata": {
                "operationMetadataId": "7e4d4ff0-87cb-457e-874b-5ab5bd4b3a5b"
              },
              "type": "If"
            },
            "Check_Province_source_-_address_or_LLD": {
              "actions": {
                "Set_Province": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "400cbef1-0378-4ab5-a7da-b7cc1bad18fa"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "Province",
                    "value": "@{outputs('current_row')['values'][0][int(outputs('LLDProvince'))]}"
                  }
                }
              },
              "runAfter": {
                "Scope-LLD": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "check_address_province": {
                    "actions": {
                      "Set_variable_province_to_address-province": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "578b7c8a-902f-4dd1-8d63-56ba0733741f"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "Province",
                          "value": "@{outputs('current_row')['values'][0][int(outputs('Province'))]}"
                        }
                      }
                    },
                    "runAfter": {},
                    "else": {
                      "actions": {
                        "Set_variable_2": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "0aa27d07-883d-4b6a-9bb8-c861d6b52638"
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "Province",
                            "value": "@{null}"
                          }
                        }
                      }
                    },
                    "expression": {
                      "greater": [
                        "@length(outputs('current_row')['values'][0][int(outputs('Province'))])",
                        0
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "db37e645-34d1-40c8-a4e9-dd43c7b71838"
                    },
                    "type": "If"
                  }
                }
              },
              "expression": {
                "greater": [
                  "@length(outputs('current_row')['values'][0][int(outputs('LLDProvince'))])",
                  0
                ]
              },
              "metadata": {
                "operationMetadataId": "1e2e1199-8263-4253-b8b7-fd016dc46269"
              },
              "type": "If"
            }
          },
          "runAfter": {
            "List_All_Sites_with_data": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "ad5faa3e-a3e7-4932-8d71-888d43b71829"
          },
          "type": "Foreach",
          "runtimeConfiguration": {
            "concurrency": {
              "repetitions": 1
            }
          }
        },
        "List_All_Sites_with_data": {
          "runAfter": {
            "check_if_delete_UN_number_is_required": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "05c212d4-bdab-4ba9-a408-cc89507d9cdd"
          },
          "type": "Query",
          "inputs": {
            "from": "@outputs('Invoke_http_Get_Sites')?['body']['value']",
            "where": "@and(greater(length(item()['values'][0][int(outputs('SiteFullAddress'))]), 0) , equals(length(item()['values'][0][int(outputs('SiteGUID'))]), 0))"
          }
        },
        "Apply_to_each_site_to_update": {
          "foreach": "@body('List_All_updated_site')",
          "actions": {
            "Current_site_row_2": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "7f909a97-918e-4174-9474-7a7a30bab9fa"
              },
              "type": "Compose",
              "inputs": "@items('Apply_to_each_site_to_update')"
            },
            "Site_ID": {
              "runAfter": {
                "Current_site_row_2": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3f083f13-d063-4fc0-be1d-89bab79bf7b5"
              },
              "type": "Compose",
              "inputs": "@outputs('Current_site_row_2')?['values'][0][int(outputs('SiteGUID'))]"
            },
            "Check_site_id_length": {
              "actions": {
                "Class": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "357efc72-d6be-449b-ae95-a6ff0dd03755"
                  },
                  "type": "Compose",
                  "inputs": "@split(outputs('Current_site_row_2')?['values'][0][int(outputs('Class-column'))], ',')"
                },
                "Extended": {
                  "runAfter": {
                    "Class": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "3e73f3b8-6f8e-4da7-bafe-4208b2cf27da"
                  },
                  "type": "Compose",
                  "inputs": "@outputs('Current_site_row_2')?['values'][0][int(outputs('extendedYN'))]"
                },
                "check_extended_flag_in_the_update_2": {
                  "actions": {
                    "Filter_string_map_with_Extended_3": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "b1543108-d7de-43e7-b374-bddc440f6daf"
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@outputs('StringMap_-_CID_Requirement_level_option_set')?['body/value']",
                        "where": "@equals(item()?['value'], 'Extended')"
                      }
                    },
                    "Set_requirement_level_to_extended_index_3": {
                      "runAfter": {
                        "Filter_string_map_with_Extended_3": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "b1c39805-1722-457c-a7e5-29ba5a6da411"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "CID_Site_Requirement_Level",
                        "value": "@int(body('Filter_string_map_with_Extended_3')?[0]['attributevalue'])"
                      }
                    }
                  },
                  "runAfter": {
                    "For_each_UN_number_2": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "filter_string_map_with_Basic_3": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "2d9482cd-19f2-43d9-b4ce-bfbd7392ddc8"
                        },
                        "type": "Query",
                        "inputs": {
                          "from": "@outputs('StringMap_-_CID_Requirement_level_option_set')?['body/value']",
                          "where": "@equals(item()?['value'], 'Basic')"
                        }
                      },
                      "Set_variable_3": {
                        "runAfter": {
                          "filter_string_map_with_Basic_3": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "f7107a5d-bbc6-438c-bec6-ccf5b2864f3a"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "CID_Site_Requirement_Level",
                          "value": "@int(body('filter_string_map_with_Basic_3')?[0]?['attributevalue'])"
                        }
                      }
                    }
                  },
                  "expression": {
                    "contains": [
                      "@outputs('Extended')",
                      "Yes"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "4248dcee-d3e5-46f8-a540-1c9267994d9e"
                  },
                  "type": "If"
                },
                "get_Site": {
                  "runAfter": {
                    "OperationOdataID": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "30894a90-dbf8-4449-b0fd-b244c426ba65"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps_1",
                      "operationId": "GetItem",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "accounts",
                      "recordId": "@outputs('Site_ID')"
                    },
                    "authentication": {
                      "type": "Raw",
                      "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                    }
                  }
                },
                "check_if_requirement_level_match": {
                  "actions": {
                    "update_site_requirement_level": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "73118e6b-102d-437c-93d3-90bfff31ae16"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps_1",
                          "operationId": "UpdateRecord",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "accounts",
                          "recordId": "@outputs('Site_ID')",
                          "item/address1_city": "@outputs('get_Site')?['body/address1_city']",
                          "item/address1_country": "@outputs('get_Site')?['body/address1_country']",
                          "item/ovs_address_type": "@outputs('get_Site')?['body/ovs_address_type']",
                          "item/ovs_legalname": "@outputs('get_Site')?['body/ovs_legalname']",
                          "item/name": "@outputs('get_Site')?['body/name']",
                          "item/customertypecode": 948010001,
                          "item/ovs_romid": "@outputs('get_Site')?['body/ovs_romid']",
                          "item/address1_stateorprovince": "@outputs('get_Site')?['body/address1_stateorprovince']",
                          "item/address1_line1": "@outputs('get_Site')?['body/address1_line1']",
                          "item/address1_postalcode": "@outputs('get_Site')?['body/address1_postalcode']",
                          "item/cid_requirementlevel": "@variables('CID_Site_Requirement_Level')"
                        },
                        "authentication": {
                          "type": "Raw",
                          "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                        }
                      }
                    }
                  },
                  "runAfter": {
                    "check_extended_flag_in_the_update_2": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "not": {
                      "equals": [
                        "@variables('CID_Site_Requirement_Level')",
                        ""
                      ]
                    }
                  },
                  "metadata": {
                    "operationMetadataId": "e10bdbde-5191-472a-82b4-67df67a1b348"
                  },
                  "type": "If"
                },
                "Mode_of_Transportation_update_logic": {
                  "actions": {
                    "Transport_by_Marine": {
                      "runAfter": {
                        "Filter_array_-Marine": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "5880405b-bf2c-49ad-868b-d94b0c244287"
                      },
                      "type": "Compose",
                      "inputs": "@outputs('Current_site_row_2')?['values'][0][int(outputs('Marine-column'))]"
                    },
                    "Transport_by_Rail": {
                      "runAfter": {
                        "Filter_array_-_Rail": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "10f5c0ce-5d9c-4217-b5a7-b5bf6f6c7443"
                      },
                      "type": "Compose",
                      "inputs": "@outputs('Current_site_row_2')?['values'][0][int(outputs('Rail-column'))]"
                    },
                    "Transport_by_Road": {
                      "runAfter": {
                        "Filter_array_-_Road": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "a6383c34-4dae-4445-8076-99465053a1a8"
                      },
                      "type": "Compose",
                      "inputs": "@outputs('Current_site_row_2')?['values'][0][int(outputs('Road-column'))]"
                    },
                    "check_if_air": {
                      "actions": {
                        "Relate_rows-modes-to-operation-Air-SiteUpdate": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "9f0f41b5-a0ab-4bb6-9722-f171365ad42d"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps_1",
                              "operationId": "AssociateEntities",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "ovs_modeses",
                              "recordId": "@variables('Air')",
                              "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                              "item/@odata.id": "@outputs('OperationOdataID')"
                            },
                            "authentication": {
                              "type": "Raw",
                              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                            }
                          }
                        }
                      },
                      "runAfter": {
                        "Filter_array_-_Air": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Check_if_No": {
                            "actions": {
                              "Unrelate_Air": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "9fd93d58-6af7-44fd-915a-31f493f8cc65"
                                },
                                "type": "OpenApiConnection",
                                "inputs": {
                                  "host": {
                                    "connectionName": "shared_commondataserviceforapps",
                                    "operationId": "DisassociateEntities",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                  },
                                  "parameters": {
                                    "entityName": "ovs_modeses",
                                    "recordId": "@variables('Air')",
                                    "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                                    "$id": "@outputs('OperationOdataID')"
                                  },
                                  "authentication": {
                                    "type": "Raw",
                                    "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                                  }
                                }
                              }
                            },
                            "runAfter": {},
                            "expression": {
                              "and": [
                                {
                                  "not": {
                                    "contains": [
                                      "@outputs('Transport_by_Air')",
                                      "Yes"
                                    ]
                                  }
                                },
                                {
                                  "greater": [
                                    "@length(body('Filter_array_-_Air'))",
                                    0
                                  ]
                                }
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "7e6a1588-d2a6-4c8f-ab7f-41007034cfc0"
                            },
                            "type": "If"
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "or": [
                              {
                                "contains": [
                                  "@outputs('Transport_by_Air')",
                                  "Yes"
                                ]
                              },
                              {
                                "equals": [
                                  "@outputs('Transport_by_Air')",
                                  "Oui"
                                ]
                              }
                            ]
                          },
                          {
                            "equals": [
                              "@length(body('Filter_array_-_Air'))",
                              0
                            ]
                          }
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "956e0af2-382c-44b9-bd79-5359c49b158e"
                      },
                      "type": "If"
                    },
                    "Transport_by_Air": {
                      "runAfter": {
                        "List_Modes_rows_from_Manyto_Many_relation_with_operation": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "9b8cc802-abf3-4d0c-9095-87f914a3ea8a"
                      },
                      "type": "Compose",
                      "inputs": "@outputs('Current_site_row_2')?['values'][0][int(outputs('Air-column'))]"
                    },
                    "Filter_array_-_Air": {
                      "runAfter": {
                        "Transport_by_Air": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "7233e8fe-f386-423f-9d47-f0ba3c87c983"
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@outputs('List_Modes_rows_from_Manyto_Many_relation_with_operation')?['body/value']",
                        "where": "@equals(item()['ovs_name'], 'Air')"
                      }
                    },
                    "check_if_Marine": {
                      "actions": {
                        "Relate_rows-modes-to-operation-Marine-SiteUpdate": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "9f0f41b5-a0ab-4bb6-9722-f171365ad42d"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps_1",
                              "operationId": "AssociateEntities",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "ovs_modeses",
                              "recordId": "@variables('Marine')",
                              "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                              "item/@odata.id": "@outputs('OperationOdataID')"
                            },
                            "authentication": {
                              "type": "Raw",
                              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                            }
                          }
                        }
                      },
                      "runAfter": {
                        "Transport_by_Marine": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Check_if_No_Marine": {
                            "actions": {
                              "Unrelate_Marine": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "0853f7c8-8686-43fe-bb6c-7e4822d01ce5"
                                },
                                "type": "OpenApiConnection",
                                "inputs": {
                                  "host": {
                                    "connectionName": "shared_commondataserviceforapps",
                                    "operationId": "DisassociateEntities",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                  },
                                  "parameters": {
                                    "entityName": "ovs_modeses",
                                    "recordId": "@variables('Marine')",
                                    "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                                    "$id": "@outputs('OperationOdataID')"
                                  },
                                  "authentication": {
                                    "type": "Raw",
                                    "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                                  }
                                }
                              }
                            },
                            "runAfter": {},
                            "expression": {
                              "and": [
                                {
                                  "not": {
                                    "contains": [
                                      "@outputs('Transport_by_Marine')",
                                      "Yes"
                                    ]
                                  }
                                },
                                {
                                  "greater": [
                                    "@length(body('Filter_array_-Marine'))",
                                    0
                                  ]
                                }
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "7e6a1588-d2a6-4c8f-ab7f-41007034cfc0"
                            },
                            "type": "If"
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "or": [
                              {
                                "contains": [
                                  "@outputs('Transport_by_Marine')",
                                  "Yes"
                                ]
                              },
                              {
                                "equals": [
                                  "@outputs('Transport_by_Marine')",
                                  "Oui"
                                ]
                              }
                            ]
                          },
                          {
                            "equals": [
                              "@length(body('Filter_array_-Marine'))",
                              0
                            ]
                          }
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "956e0af2-382c-44b9-bd79-5359c49b158e"
                      },
                      "type": "If"
                    },
                    "Filter_array_-Marine": {
                      "runAfter": {
                        "check_if_air": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "7233e8fe-f386-423f-9d47-f0ba3c87c983"
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@outputs('List_Modes_rows_from_Manyto_Many_relation_with_operation')?['body/value']",
                        "where": "@equals(item()['ovs_name'], 'Marine')"
                      }
                    },
                    "Filter_array_-_Rail": {
                      "runAfter": {
                        "check_if_Marine": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "7233e8fe-f386-423f-9d47-f0ba3c87c983"
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@outputs('List_Modes_rows_from_Manyto_Many_relation_with_operation')?['body/value']",
                        "where": "@equals(item()['ovs_name'], 'Rail')"
                      }
                    },
                    "check_if_Rail": {
                      "actions": {
                        "Relate_rows-modes-to-operation-Rail-SiteUpdate_": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "9f0f41b5-a0ab-4bb6-9722-f171365ad42d"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps_1",
                              "operationId": "AssociateEntities",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "ovs_modeses",
                              "recordId": "@variables('Rail')",
                              "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                              "item/@odata.id": "@outputs('OperationOdataID')"
                            },
                            "authentication": {
                              "type": "Raw",
                              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                            }
                          }
                        }
                      },
                      "runAfter": {
                        "Transport_by_Rail": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Check_if_No__-_Rail": {
                            "actions": {
                              "Unrelate_Rail": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "4a136a57-fe81-49e5-afce-04c2e735ff60"
                                },
                                "type": "OpenApiConnection",
                                "inputs": {
                                  "host": {
                                    "connectionName": "shared_commondataserviceforapps",
                                    "operationId": "DisassociateEntities",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                  },
                                  "parameters": {
                                    "entityName": "ovs_modeses",
                                    "recordId": "@variables('Rail')",
                                    "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                                    "$id": "@outputs('OperationOdataID')"
                                  },
                                  "authentication": {
                                    "type": "Raw",
                                    "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                                  }
                                }
                              }
                            },
                            "runAfter": {},
                            "expression": {
                              "and": [
                                {
                                  "not": {
                                    "contains": [
                                      "@outputs('Transport_by_Rail')",
                                      "Yes"
                                    ]
                                  }
                                },
                                {
                                  "greater": [
                                    "@length(body('Filter_array_-_Rail'))",
                                    0
                                  ]
                                }
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "7e6a1588-d2a6-4c8f-ab7f-41007034cfc0"
                            },
                            "type": "If"
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "or": [
                              {
                                "contains": [
                                  "@outputs('Transport_by_Rail')",
                                  "Yes"
                                ]
                              },
                              {
                                "equals": [
                                  "@outputs('Transport_by_Rail')",
                                  "Oui"
                                ]
                              }
                            ]
                          },
                          {
                            "equals": [
                              "@length(body('Filter_array_-_Rail'))",
                              0
                            ]
                          }
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "956e0af2-382c-44b9-bd79-5359c49b158e"
                      },
                      "type": "If"
                    },
                    "check_if_Road": {
                      "actions": {
                        "Relate_rows-modes-to-operation-Road-SiteUpdate": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "9f0f41b5-a0ab-4bb6-9722-f171365ad42d"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps_1",
                              "operationId": "AssociateEntities",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "ovs_modeses",
                              "recordId": "@variables('Road')",
                              "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                              "item/@odata.id": "@outputs('OperationOdataID')"
                            },
                            "authentication": {
                              "type": "Raw",
                              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                            }
                          }
                        }
                      },
                      "runAfter": {
                        "Transport_by_Road": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Check_if_No__-_Road": {
                            "actions": {
                              "Unrelate_Road": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "8fbe6f96-55a1-43a7-8fd8-806e9097f5b1"
                                },
                                "type": "OpenApiConnection",
                                "inputs": {
                                  "host": {
                                    "connectionName": "shared_commondataserviceforapps",
                                    "operationId": "DisassociateEntities",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                  },
                                  "parameters": {
                                    "entityName": "ovs_modeses",
                                    "recordId": "@variables('Road')",
                                    "associationEntityRelationship": "ovs_mocregistration_ovs_modes",
                                    "$id": "@outputs('OperationOdataID')"
                                  },
                                  "authentication": {
                                    "type": "Raw",
                                    "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                                  }
                                }
                              }
                            },
                            "runAfter": {},
                            "expression": {
                              "and": [
                                {
                                  "not": {
                                    "contains": [
                                      "@outputs('Transport_by_Road')",
                                      "Yes"
                                    ]
                                  }
                                },
                                {
                                  "greater": [
                                    "@length(body('Filter_array_-_Road'))",
                                    0
                                  ]
                                }
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "7e6a1588-d2a6-4c8f-ab7f-41007034cfc0"
                            },
                            "type": "If"
                          }
                        }
                      },
                      "expression": {
                        "and": [
                          {
                            "or": [
                              {
                                "contains": [
                                  "@outputs('Transport_by_Road')",
                                  "Yes"
                                ]
                              },
                              {
                                "equals": [
                                  "@outputs('Transport_by_Road')",
                                  "Oui"
                                ]
                              }
                            ]
                          },
                          {
                            "equals": [
                              "@length(body('Filter_array_-_Road'))",
                              0
                            ]
                          }
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "956e0af2-382c-44b9-bd79-5359c49b158e"
                      },
                      "type": "If"
                    },
                    "List_Modes_rows_from_Manyto_Many_relation_with_operation": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "6cfaade8-002a-4675-a9ec-e7032b468b35"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps_1",
                          "operationId": "ListRecords",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "ovs_modeses",
                          "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"true\">\n<entity name=\"ovs_modes\">\n<attribute name=\"ovs_modesid\"/>\n<attribute name=\"ovs_name\"/>\n<attribute name=\"createdon\"/>\n<order attribute=\"ovs_name\" descending=\"false\"/>\n<link-entity name=\"ovs_mocregistration_ovs_modes\" from=\"ovs_modesid\" to=\"ovs_modesid\" visible=\"false\" intersect=\"true\">\n<link-entity name=\"ovs_mocregistration\" from=\"ovs_mocregistrationid\" to=\"ovs_mocregistrationid\" alias=\"aj\">\n<filter type=\"and\">\n<condition attribute=\"ovs_mocregistrationid\" operator=\"eq\"  value=\"@{outputs('Opeartion_GUID')}\"/>\n</filter>\n</link-entity>\n</link-entity>\n</entity>\n</fetch>"
                        },
                        "authentication": {
                          "type": "Raw",
                          "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                        }
                      }
                    },
                    "Filter_array_-_Road": {
                      "runAfter": {
                        "check_if_Rail": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "7233e8fe-f386-423f-9d47-f0ba3c87c983"
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@outputs('List_Modes_rows_from_Manyto_Many_relation_with_operation')?['body/value']",
                        "where": "@equals(item()['ovs_name'], 'Road')"
                      }
                    }
                  },
                  "runAfter": {
                    "OperationOdataID": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "3e960be9-bb7e-418e-85ea-703cec83bb38"
                  },
                  "type": "Scope"
                },
                "Get_operation_id": {
                  "runAfter": {
                    "Extended": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "abf641c3-6a01-4b51-b8fd-164d3c9db6e2"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps_1",
                      "operationId": "ListRecords",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "ovs_mocregistrations",
                      "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"ovs_mocregistration\">\n    <attribute name=\"ovs_name\" />\n    <attribute name=\"createdon\" />\n    <attribute name=\"ovs_registrationexpiry\" />\n    <attribute name=\"ovs_hubind\" />\n    <attribute name=\"ovs_mocregistrationid\" />\n    <order attribute=\"ovs_name\" descending=\"false\" />\n    <filter type=\"and\">\n      <condition attribute=\"ovs_siteid\" operator=\"eq\"  value=\"@{outputs('Site_ID')}\" />\n      <condition attribute=\"ovs_operationtype\" operator=\"eq\" value=\"918640038\" />\n    </filter>\n  </entity>\n</fetch>"
                    },
                    "authentication": {
                      "type": "Raw",
                      "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                    }
                  }
                },
                "Opeartion_GUID": {
                  "runAfter": {
                    "check_if_operation_doesn't_exist": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "cfb0f127-1194-4040-91d8-1e9f0c91ba50"
                  },
                  "type": "Compose",
                  "inputs": "@if (equals( length(outputs('Get_operation_id')?['body']['value']),0) ,outputs('Create-New-Operatin')?['body/ovs_mocregistrationid'],outputs('Get_operation_id')?['body']?['value'][0]['ovs_mocregistrationid'])"
                },
                "Filter_UnNumber_Table_with_Site_to_update": {
                  "runAfter": {
                    "Check_if_there_is_a_change_in_HOTI_activities": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "0199dc9b-c60d-49dd-8d1c-9d2b9521333b"
                  },
                  "type": "Query",
                  "inputs": {
                    "from": "@outputs('Invoke_an_HTTP_request_-_unnumber')?['body']['value']",
                    "where": "@equals(item()['values'][0][int(outputs('ExtendedSite'))], outputs('Current_site_row_2')['values'][0][int(outputs('SiteFullAddress'))])"
                  }
                },
                "For_each_UN_number_2": {
                  "foreach": "@body('Filter_UnNumber_Table_with_Site_to_update')",
                  "actions": {
                    "UN-row-Site-Update": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "285f3692-c760-4400-8e86-c726bd09097a"
                      },
                      "type": "Compose",
                      "inputs": "@items('For_each_UN_number_2')"
                    },
                    "Check_if_UN_number_is_not_null_3": {
                      "actions": {
                        "Get_Type_of_measurement_option_set_index_3": {
                          "runAfter": {
                            "Check_if_more_than_un_found_2": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "7471031a-5efb-4103-a623-250e404dadb1"
                          },
                          "type": "Query",
                          "inputs": {
                            "from": "@outputs('StringMap_-_Type_of_measurement_list')?['body/value']",
                            "where": "@equals(item()?['value'], outputs('UN-row-Site-Update')['values'][0][3])"
                          }
                        },
                        "Add_Operation_UN_number_3": {
                          "runAfter": {
                            "Index_-_unit_of_measurement_type__3": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "05ae44b8-6a21-4f37-b285-0ef585f2987b"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps_1",
                              "operationId": "CreateRecord",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "ovs_operationunnumbers",
                              "item/ovs_supplychaindirection": "930840000",
                              "item/ovs_UNNumber@odata.bind": "@concat('/tdg_unnumbers/', variables('UN-GUID-SiteUpdate') )",
                              "item/cid_annualnumberofshipment": "@outputs('UN-row-Site-Update')['values'][0][int(outputs('ExtendedAnnulaConsignment'))]",
                              "item/cid_annualquantityvolume": "@outputs('UN-row-Site-Update')['values'][0][int(outputs('ExtendedQuantity'))]",
                              "item/ovs_OperationUNNumber@odata.bind": "@concat('/ovs_mocregistrations/', outputs('Opeartion_GUID') )",
                              "item/cid_Site@odata.bind": "@concat('/accounts/', outputs('Site_ID') )",
                              "item/cid_unitofmeasurement": "@outputs('Index_-_unit_of_measurement_type__3')"
                            },
                            "authentication": {
                              "type": "Raw",
                              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                            }
                          }
                        },
                        "Index_-_unit_of_measurement_type__3": {
                          "runAfter": {
                            "Get_Type_of_measurement_option_set_index_3": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "9238ee04-e629-4672-a1ad-e7684ae864e8"
                          },
                          "type": "Compose",
                          "inputs": "@body('Get_Type_of_measurement_option_set_index_3')?[0]?['attributevalue']"
                        },
                        "UNNumber-Split-site-update": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "3489cbf9-0940-44d8-9b9b-7030d00bfe59"
                          },
                          "type": "Compose",
                          "inputs": "@split(outputs('UN-row-Site-Update')['values'][0][int(outputs('ExtendedUNNumber'))], '-')"
                        },
                        "UNNumber-Value-updatedSite": {
                          "runAfter": {
                            "UNNumber-split-length": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "30b2551c-eaf1-48b2-aec9-16ef692b7829"
                          },
                          "type": "Compose",
                          "inputs": "@Trim(outputs('UNNumber-Split-site-update')[0])"
                        },
                        "UNNumber-split-length": {
                          "runAfter": {
                            "UNNumber-Split-site-update": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "f1c64c63-d24f-4306-95a2-bb6dc41f32b9"
                          },
                          "type": "Compose",
                          "inputs": "@length(outputs('UNNumber-Split-site-update'))"
                        },
                        "Check_if_more_than_un_found_2": {
                          "actions": {
                            "Apply_to_each_UN_filter_with_Display_Name_2": {
                              "foreach": "@body('Filter-UN-with-UNDisplayName-SiteUpdate')",
                              "actions": {
                                "currentRow-UN_2": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "1e2a20c0-b111-4fb8-8d99-cba07f67072a"
                                  },
                                  "type": "Compose",
                                  "inputs": "@items('Apply_to_each_UN_filter_with_Display_Name_2')"
                                },
                                "check_if_shipping_name_match_English_or_French_2": {
                                  "actions": {
                                    "Set_variable_5": {
                                      "runAfter": {},
                                      "metadata": {
                                        "operationMetadataId": "5a1c4c80-2319-4f16-8736-bc914e8f7c47"
                                      },
                                      "type": "SetVariable",
                                      "inputs": {
                                        "name": "UN-GUID-SiteUpdate",
                                        "value": "@{outputs('currentRow-UN_2')['tdg_unnumberid']}"
                                      }
                                    }
                                  },
                                  "runAfter": {
                                    "currentRow-UN_2": [
                                      "Succeeded"
                                    ]
                                  },
                                  "expression": {
                                    "or": [
                                      {
                                        "equals": [
                                          "@outputs('currentRow-UN_2')['tdg_shippingnamedescriptionetxt']",
                                          "@outputs('UN-ShippingName-Update')"
                                        ]
                                      },
                                      {
                                        "equals": [
                                          "@outputs('currentRow-UN_2')['tdg_shippingnamedescriptionftxt']",
                                          "@outputs('UN-ShippingName-Update')"
                                        ]
                                      }
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "4a376feb-1225-428b-8d9e-de5141067b2c"
                                  },
                                  "type": "If"
                                }
                              },
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "68c2e923-eb19-4339-9cc6-b3e440d39604"
                              },
                              "type": "Foreach"
                            }
                          },
                          "runAfter": {
                            "update_UN-GUID-SiteUpdate-withFirst-Row": [
                              "Succeeded"
                            ]
                          },
                          "expression": {
                            "greater": [
                              "@length(body('Filter-UN-with-UNDisplayName-SiteUpdate'))",
                              1
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "7e4d5a2f-a421-406d-8b6c-60b5e4345e37"
                          },
                          "type": "If"
                        },
                        "Filter-UN-with-UNDisplayName-SiteUpdate": {
                          "runAfter": {
                            "UN-ShippingName-Update": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "ccece463-ad60-44bb-be52-68dc4785f3fd"
                          },
                          "type": "Query",
                          "inputs": {
                            "from": "@outputs('List_UN_numbers')?['body/value']",
                            "where": "@equals(item()['tdg_undisplayname'], outputs('UNDisplayName-UpdatedSite'))"
                          }
                        },
                        "UNDisplayName-UpdatedSite": {
                          "runAfter": {
                            "UNNumber-Value-updatedSite": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "bb83b6d6-3b4b-49ef-9aa4-518cae33737c"
                          },
                          "type": "Compose",
                          "inputs": "@if ( equals(outputs('UNNumber-split-length'),3)  ,concat(trim(outputs('UNNumber-Value-updatedSite')) , ' - '  , Trim(outputs('UNNumber-Split-site-update')[1])), trim(outputs('UNNumber-Value-updatedSite')) )"
                        },
                        "UN-ShippingName-Update": {
                          "runAfter": {
                            "UNDisplayName-UpdatedSite": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "fd58106e-d175-44b0-a81a-9686767e9192"
                          },
                          "type": "Compose",
                          "inputs": "@if ( equals(outputs('UNNumber-split-length'),3)  ,Trim(outputs('UNNumber-Split-site-update')[2]), Trim(outputs('UNNumber-Split-site-update')[1]))"
                        },
                        "update_UN-GUID-SiteUpdate-withFirst-Row": {
                          "runAfter": {
                            "Filter-UN-with-UNDisplayName-SiteUpdate": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "138b2171-beb2-493c-9eb4-1341e8767e4e"
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "UN-GUID-SiteUpdate",
                            "value": "@{body('Filter-UN-with-UNDisplayName-SiteUpdate')?[0]['tdg_unnumberid']}"
                          }
                        }
                      },
                      "runAfter": {
                        "UN-row-Site-Update": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "greater": [
                          "@length(trim(outputs('UN-row-Site-Update')['values'][0][int(outputs('ExtendedUNNumber'))]))",
                          0
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "2ac58c16-5959-4c78-87fc-10684cfdbfb3"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {
                    "Filter_UnNumber_Table_with_Site_to_update": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "eed152cc-0c52-40af-b240-b00e466d8aed"
                  },
                  "type": "Foreach"
                },
                "check_if_operation_doesn't_exist": {
                  "actions": {
                    "Create-New-Operatin": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "6084ae35-89f9-4a1b-9fd9-7e78492a8ad4"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps",
                          "operationId": "CreateRecord",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "ovs_mocregistrations",
                          "item/ovs_registrationexpiry": "@utcNow()",
                          "item/ovs_operationtype": 918640038,
                          "item/ovs_SiteId@odata.bind": "@concat('/Accounts/' ,outputs('Site_ID'))"
                        },
                        "authentication": {
                          "type": "Raw",
                          "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                        }
                      }
                    },
                    "New-Operation-ID": {
                      "runAfter": {
                        "Create-New-Operatin": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "78322863-6827-4d37-816b-74f4e3aaa62e"
                      },
                      "type": "Compose",
                      "inputs": "@outputs('Create-New-Operatin')?['body/ovs_mocregistrationid']"
                    }
                  },
                  "runAfter": {
                    "Get-Operation-Odata": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "lessOrEquals": [
                      "@length(outputs('Get_operation_id')?['body']['value'])",
                      0
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "b8ba7ead-aaf2-451b-a2f9-b7439bbba726"
                  },
                  "type": "If"
                },
                "Get-Operation-Odata": {
                  "runAfter": {
                    "Get_operation_id": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "e3ff0236-511d-4244-af9b-60b5211d2456"
                  },
                  "type": "Compose",
                  "inputs": "@outputs('Get_operation_id')?['body']['value'][0]['@odata.id']"
                },
                "OperationOdataID": {
                  "runAfter": {
                    "Opeartion_GUID": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "7b3a9f38-2207-4172-bbed-a10332a02336"
                  },
                  "type": "Compose",
                  "inputs": "@if (equals( length(outputs('Get_operation_id')?['body']['value']),0) ,outputs('Create-New-Operatin')?['body/@odata']?['id'] ,outputs('Get-Operation-Odata'))"
                },
                "List-All-Operation-Class": {
                  "runAfter": {
                    "OperationOdataID": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "82602ebe-c94e-4e7d-8ee0-01a2db6f3905"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "ListRecords",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "ovs_operationclasses",
                      "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n<entity name=\"ovs_operationclass\">\n<attribute name=\"ovs_operationclassid\"/>\n<attribute name=\"ovs_name\"/>\n<attribute name=\"createdon\"/>\n<attribute name=\"ovs_primeclass\"/>\n\n<order attribute=\"ovs_name\" descending=\"false\"/>\n<filter type=\"and\">\n<condition attribute=\"ovs_operationclass\" operator=\"eq\" value=\"@{outputs('Opeartion_GUID')}\"/>\n</filter>\n</entity>\n</fetch>"
                    },
                    "authentication": {
                      "type": "Raw",
                      "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                    }
                  }
                },
                "Loop_in_the_class_List__to_update": {
                  "foreach": "@outputs('Class')",
                  "actions": {
                    "Class_option_set_value_2": {
                      "runAfter": {
                        "get_option_set_index_2": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "067c96d1-9269-4851-8df7-173ef3d741e2"
                      },
                      "type": "Compose",
                      "inputs": "@body('get_option_set_index_2')?[0]?['attributevalue']"
                    },
                    "If_update_class_index_in_string_map": {
                      "actions": {
                        "class_list_index": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "710c2984-a95a-45f4-8820-3f4eb9d36f59"
                          },
                          "type": "Compose",
                          "inputs": "@int(outputs('Class_option_set_value_2'))"
                        },
                        "List_matched_classes_with_operation_id": {
                          "runAfter": {
                            "class_list_index": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "68a15517-fc92-4c13-833f-38fbfc8a0e09"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps_1",
                              "operationId": "ListRecords",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "ovs_operationclasses",
                              "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n  <entity name=\"ovs_operationclass\">\n    <attribute name=\"ovs_operationclassid\" />\n    <attribute name=\"ovs_name\" />\n    <attribute name=\"createdon\" />\n    <order attribute=\"ovs_name\" descending=\"false\" />\n    <filter type=\"and\">\n      <condition attribute=\"ovs_primeclass\" operator=\"eq\" value=\"@{outputs('class_list_index')}\" />\n      <condition attribute=\"ovs_operationclass\" operator=\"eq\" uiname=\"OP-00001063\" uitype=\"ovs_mocregistration\" value=\"@{outputs('Opeartion_GUID')}\" />\n    </filter>\n  </entity>\n</fetch>"
                            },
                            "authentication": {
                              "type": "Raw",
                              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                            }
                          }
                        },
                        "check_if_class__exists_in_the_database": {
                          "actions": {
                            "Add_operation_class_in_the_update": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "920c2fd2-060f-469d-b24c-0f89d3779bc4"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps_1",
                                  "operationId": "CreateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "ovs_operationclasses",
                                  "item/ovs_primeclass": "@outputs('class_list_index')",
                                  "item/ovs_supplychaindirection": "930840000",
                                  "item/ovs_OperationClass@odata.bind": "@concat('/ovs_mocregistrations/', outputs('Opeartion_GUID'))"
                                },
                                "authentication": {
                                  "type": "Raw",
                                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                                }
                              }
                            }
                          },
                          "runAfter": {
                            "List_matched_classes_with_operation_id": [
                              "Succeeded"
                            ]
                          },
                          "expression": {
                            "equals": [
                              "@length(outputs('List_matched_classes_with_operation_id')?['body/value'])",
                              0
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "5234b6b7-f6de-4265-a21d-03244f780f07"
                          },
                          "type": "If"
                        }
                      },
                      "runAfter": {
                        "Class_option_set_value_2": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "greaterOrEquals": [
                          "@outputs('Class_option_set_value_2')",
                          0
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "83735453-fbb6-459a-8cbd-79fdad1f0392"
                      },
                      "type": "If"
                    },
                    "get_option_set_index_2": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "3874b476-84dc-4823-898f-1af674f9b7d3"
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@outputs('StringMap_-_List_Class')?['body/value']",
                        "where": "@equals(item()?['value'], items('Loop_in_the_class_List__to_update'))"
                      }
                    }
                  },
                  "runAfter": {
                    "Apply_in_system_classes": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "7ccc3b18-109a-4bdd-bc1a-c7e36794fd4b"
                  },
                  "type": "Foreach",
                  "runtimeConfiguration": {
                    "concurrency": {
                      "repetitions": 23
                    }
                  }
                },
                "Apply_in_system_classes": {
                  "foreach": "@outputs('List-All-Operation-Class')?['body/value']",
                  "actions": {
                    "get_the_index_of_the_class_in_the_system_from_Excel_template": {
                      "runAfter": {
                        "Class-in-system": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "163536de-4ae8-4a20-a373-f67d8b72a4bb"
                      },
                      "type": "Compose",
                      "inputs": "@indexOf(outputs('Current_site_row_2')?['values'][0][int(outputs('Class-column'))] ,outputs('Class-in-system') )"
                    },
                    "Check_if_class_in_excel_already_exists_in_the_system": {
                      "actions": {
                        "deactivate_operation_class": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "b2d4bf0b-7cb9-409e-b5cf-55d4f5c0077e"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps",
                              "operationId": "UpdateRecord",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "ovs_operationclasses",
                              "recordId": "@items('Apply_in_system_classes')?['ovs_operationclassid']",
                              "item/statecode": 1
                            },
                            "authentication": {
                              "type": "Raw",
                              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                            }
                          }
                        }
                      },
                      "runAfter": {
                        "get_the_index_of_the_class_in_the_system_from_Excel_template": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "less": [
                          "@outputs('get_the_index_of_the_class_in_the_system_from_Excel_template')",
                          0
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "d971d184-deac-443f-bc26-f0d0dd7f0a6c"
                      },
                      "type": "If"
                    },
                    "Compose_2": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "3fea758b-9e23-432a-8f93-b8cb9f1b6b1b"
                      },
                      "type": "Compose",
                      "inputs": "@items('Apply_in_system_classes')"
                    },
                    "Class-in-system": {
                      "runAfter": {
                        "Compose_2": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "520e61ff-78af-4a29-a644-82b6daf9c680"
                      },
                      "type": "Compose",
                      "inputs": "@items('Apply_in_system_classes')['ovs_primeclass@OData.Community.Display.V1.FormattedValue']"
                    }
                  },
                  "runAfter": {
                    "List-All-Operation-Class": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "b468bc67-de4a-4b97-a08d-c1bbd01d47a1"
                  },
                  "type": "Foreach"
                },
                "check_Import_flag_-_Update": {
                  "actions": {
                    "set_Import_flag_to_yes__2": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "56fcfed0-60f1-4b5e-a3b4-8fd8e84d2453"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "Import_Update",
                        "value": "@true"
                      }
                    }
                  },
                  "runAfter": {
                    "get_Site": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "set_Import_flag_to_yes__3": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "56fcfed0-60f1-4b5e-a3b4-8fd8e84d2453"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "Import_Update",
                          "value": "@false"
                        }
                      }
                    }
                  },
                  "expression": {
                    "or": [
                      {
                        "contains": [
                          "@outputs('Current_site_row_2')['values'][0][int(outputs('Import'))]",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('Current_site_row_2')['values'][0][int(outputs('Import'))]",
                          "Oui"
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "31ece6f0-0f94-4493-8047-602ac4ea9ce8"
                  },
                  "type": "If"
                },
                "check_Handle_flag_-_Update_": {
                  "actions": {
                    "set_Import_flag_to_yes__5": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "56fcfed0-60f1-4b5e-a3b4-8fd8e84d2453"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "Handle_upldate",
                        "value": "@true"
                      }
                    }
                  },
                  "runAfter": {
                    "check_Import_flag_-_Update": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "set_Import_flag_to_yes__4": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "56fcfed0-60f1-4b5e-a3b4-8fd8e84d2453"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "Handle_upldate",
                          "value": "@false"
                        }
                      }
                    }
                  },
                  "expression": {
                    "or": [
                      {
                        "contains": [
                          "@outputs('Current_site_row_2')['values'][0][int(outputs('Handle'))]",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('Current_site_row_2')['values'][0][int(outputs('Handle'))]",
                          "Oui"
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "31ece6f0-0f94-4493-8047-602ac4ea9ce8"
                  },
                  "type": "If"
                },
                "check_Offer_For_Transport_flag_-_Update_": {
                  "actions": {
                    "set_Import_flag_to_yes__7": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "56fcfed0-60f1-4b5e-a3b4-8fd8e84d2453"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "OfferForTransport_Update",
                        "value": "@true"
                      }
                    }
                  },
                  "runAfter": {
                    "check_Handle_flag_-_Update_": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "set_Import_flag_to_yes__6": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "56fcfed0-60f1-4b5e-a3b4-8fd8e84d2453"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "OfferForTransport_Update",
                          "value": "@false"
                        }
                      }
                    }
                  },
                  "expression": {
                    "or": [
                      {
                        "contains": [
                          "@outputs('Current_site_row_2')['values'][0][int(outputs('OfferForTransport'))]",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('Current_site_row_2')['values'][0][int(outputs('OfferForTransport'))]",
                          "Oui"
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "31ece6f0-0f94-4493-8047-602ac4ea9ce8"
                  },
                  "type": "If"
                },
                "check_Transport-_Update": {
                  "actions": {
                    "set_Import_flag_to_yes__9": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "56fcfed0-60f1-4b5e-a3b4-8fd8e84d2453"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "Transport_Update",
                        "value": "@true"
                      }
                    }
                  },
                  "runAfter": {
                    "check_Offer_For_Transport_flag_-_Update_": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "set_Import_flag_to_yes__8": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "56fcfed0-60f1-4b5e-a3b4-8fd8e84d2453"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "Transport_Update",
                          "value": "@false"
                        }
                      }
                    }
                  },
                  "expression": {
                    "or": [
                      {
                        "contains": [
                          "@outputs('Current_site_row_2')['values'][0][int(outputs('Transport'))]",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('Current_site_row_2')['values'][0][int(outputs('Transport'))]",
                          "Oui"
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "31ece6f0-0f94-4493-8047-602ac4ea9ce8"
                  },
                  "type": "If"
                },
                "Check_if_there_is_a_change_in_HOTI_activities": {
                  "actions": {
                    "Update_HOTI_activities": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "93d4db9c-a74b-4804-b600-a71a2fa88cfc"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps",
                          "operationId": "UpdateRecord",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "accounts",
                          "recordId": "@outputs('get_Site')?['body/accountid']",
                          "item/cid_handlingsitetype": "@variables('Handle_upldate')",
                          "item/cid_importingsitetype": "@variables('Import_Update')",
                          "item/cid_offeringfortransportsitetype": "@variables('OfferForTransport_Update')",
                          "item/cid_transportingsitetype": "@variables('Transport_Update')"
                        },
                        "authentication": {
                          "type": "Raw",
                          "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                        }
                      }
                    }
                  },
                  "runAfter": {
                    "check_Transport-_Update": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "or": [
                      {
                        "not": {
                          "equals": [
                            "@outputs('get_Site')?['body/cid_handlingsitetype']",
                            "@variables('Handle_upldate')"
                          ]
                        }
                      },
                      {
                        "not": {
                          "equals": [
                            "@outputs('get_Site')?['body/cid_offeringfortransportsitetype']",
                            "@variables('OfferForTransport_Update')"
                          ]
                        }
                      },
                      {
                        "not": {
                          "equals": [
                            "@outputs('get_Site')?['body/cid_transportingsitetype']",
                            "@variables('Transport_Update')"
                          ]
                        }
                      },
                      {
                        "not": {
                          "equals": [
                            "@outputs('get_Site')?['body/cid_importingsitetype']",
                            "@variables('Import_Update')"
                          ]
                        }
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "443ff714-92b0-4d5b-ba3b-b5c10bfd44b7"
                  },
                  "type": "If"
                }
              },
              "runAfter": {
                "Site_ID": [
                  "Succeeded"
                ]
              },
              "expression": {
                "greater": [
                  "@length(outputs('Site_ID'))",
                  0
                ]
              },
              "metadata": {
                "operationMetadataId": "b38e10cc-6491-4d0d-b5c7-84722bf43c2b"
              },
              "type": "If"
            }
          },
          "runAfter": {
            "List_All_updated_site": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "209f0290-423f-43ac-b727-8224bb5e6de5"
          },
          "type": "Foreach"
        },
        "Close_Activity": {
          "runAfter": {
            "Language_is_English": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "0a769b87-ea0e-44ac-b803-af10cff2b5b0"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "UpdateRecord",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "cid_bulkactivitylogsummaries",
              "recordId": "@triggerBody()['text_2']",
              "item/cid_activityendtime": "@utcNow()",
              "item/cid_activitystatus": 100000000,
              "item/statecode": 1
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "Air": {
          "runAfter": {
            "Initialize_variable-ShippingName": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f228a195-0411-4761-bf80-be026150e10f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Air",
                "type": "string"
              }
            ]
          }
        },
        "Rail": {
          "runAfter": {
            "Air": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f228a195-0411-4761-bf80-be026150e10f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Rail",
                "type": "string"
              }
            ]
          }
        },
        "Road": {
          "runAfter": {
            "Rail": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f228a195-0411-4761-bf80-be026150e10f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Road",
                "type": "string"
              }
            ]
          }
        },
        "Marine": {
          "runAfter": {
            "Road": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f228a195-0411-4761-bf80-be026150e10f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Marine",
                "type": "string"
              }
            ]
          }
        },
        "Initialize_UnNumber_Status_variable": {
          "runAfter": {
            "Marine": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "aeab0991-335d-46e0-af75-175ade344754"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "UnNumberStatus",
                "type": "integer"
              }
            ]
          }
        },
        "Send_an_HTTP_request_to_SharePoint-Delete-File": {
          "runAfter": {
            "Apply_to_each_site_to_update": [
              "Succeeded"
            ],
            "Loop_Excel_sheet_Sites_table": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "613190e4-0e54-402c-92ea-4d8c3d1e4a7a"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_sharepointonline",
              "operationId": "HttpRequest",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
            },
            "parameters": {
              "dataset": "https://034gc.sharepoint.com/sites/SamuraiTeam",
              "parameters/method": "DELETE",
              "parameters/uri": "_api/web/GetFileByServerRelativeUrl('/sites/SamuraiTeam/Shared Documents/CID_Bulk_Upload@{outputs('file_Ref_URL')}')/recycle",
              "parameters/headers": {
                "Prefer": "bypass-shared-lock"
              }
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "Get_folder_metadata": {
          "runAfter": {
            "Send_an_HTTP_request_to_SharePoint-Delete-File": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "7e496e60-b685-4451-bb18-62244159694c"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_sharepointonline",
              "operationId": "GetFolderMetadata",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_sharepointonline"
            },
            "parameters": {
              "dataset": "https://034gc.sharepoint.com/sites/SamuraiTeam",
              "id": "/Shared Documents/CID_Bulk_Upload/@{variables('Environment_folder')}/@{triggerBody()['text_2']}"
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "List_All_updated_site": {
          "runAfter": {
            "check_if_delete_UN_number_is_required": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "05c212d4-bdab-4ba9-a408-cc89507d9cdd"
          },
          "type": "Query",
          "inputs": {
            "from": "@outputs('Invoke_http_Get_Sites')?['body']['value']",
            "where": "@greater(length(item()['values'][0][int(outputs('SiteGUID'))]), 0)"
          }
        },
        "Initialize_variable-Handle": {
          "runAfter": {},
          "metadata": {
            "operationMetadataId": "2ffb5b07-34bd-4c5e-ae68-707de7f69919"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Handle",
                "type": "boolean",
                "value": "@false"
              }
            ]
          }
        },
        "Initialize_variable-Offer-for-transport": {
          "runAfter": {
            "Initialize_variable-Handle": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "15cad190-01a0-4c96-b464-abddf874f71c"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "OfferForTransport",
                "type": "boolean",
                "value": "@false"
              }
            ]
          }
        },
        "Initialize_variable-Transport": {
          "runAfter": {
            "Initialize_variable-Offer-for-transport": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "61f0bbfb-843b-40e3-b51b-585b16f755f2"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Transport",
                "type": "boolean",
                "value": "@false"
              }
            ]
          }
        },
        "Initialize_variable-import": {
          "runAfter": {
            "Initialize_variable-Transport": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "3f723f3e-646b-42e4-918e-dc9525285df2"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Import",
                "type": "boolean",
                "value": "@false"
              }
            ]
          }
        },
        "Initialize_variable-Latitude": {
          "runAfter": {
            "Initialize_UnNumber_Status_variable": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "c8fbcf1a-355c-43b5-8b3b-9546366e5633"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Latitude",
                "type": "float"
              }
            ]
          }
        },
        "Initialize_variable-Longtitud": {
          "runAfter": {
            "Initialize_variable-Latitude": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "80877e93-45c5-4eef-93e6-d0d8f34a4f10"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Longtitud",
                "type": "float"
              }
            ]
          }
        },
        "Initialize_variable-Province": {
          "runAfter": {
            "Initialize_variable-Longtitud": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "5bd7dc8f-284d-405f-8987-658f7bd56874"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Province",
                "type": "string"
              }
            ]
          }
        },
        "Site-Sheet-columns": {
          "runAfter": {
            "define_basic_info_sheet_columns": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "503db1c5-72ad-4244-ab40-2b84d83e687b"
          },
          "type": "Compose",
          "inputs": {
            "Site Name": "0",
            "Address 1": "1",
            "City": "2",
            "Province": "3",
            "Postal Code ": "4",
            "Address 2": "5",
            "Address 3": "6",
            "Province  ": "7",
            "Quarter ": "8",
            "Section": "9",
            "Township": "10",
            "Range": "11",
            "Meridian": "12",
            "Latitude": "13",
            "Longitude": "14",
            " Air": "15",
            "Marine": "16",
            "Rail": "17",
            "Road": "18",
            "Handle": "19",
            "Offer for Transport": "20",
            "Transport": "21",
            "Import": "22",
            "Class/Division ": "23",
            "Extended Information Site ": "24",
            "Row number": "25",
            "SiteFullAddress": "26",
            "site-GUID": "27"
          }
        },
        "Invoke_an_HTTP_request_-_unnumber": {
          "runAfter": {
            "CID_Site_Requirement_Level": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f11d9ebe-4fb1-412e-b313-ec10ab941bb7"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_webcontents",
              "operationId": "InvokeHttp",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
            },
            "parameters": {
              "request/method": "GET",
              "request/url": "https://graph.microsoft.com/v1.0/sites/034gc.sharepoint.com,140da73b-4423-4443-a812-e623d6d857c4,f2a2589e-2eec-4642-9280-443640f88211/lists/ddbec2ce-e3a5-4bf3-b065-23b0d1d0d395/drive/root:/CID_Bulk_Upload@{outputs('file_Ref_URL')}:/workbook/tables/TableAddExtended/rows"
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "List_All_UN_number_to_Insert": {
          "runAfter": {
            "Invoke_an_HTTP_request_-_unnumber": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "05c212d4-bdab-4ba9-a408-cc89507d9cdd"
          },
          "type": "Query",
          "inputs": {
            "from": "@outputs('Invoke_an_HTTP_request_-_unnumber')?['body']['value']",
            "where": "@equals(length(item()?['values'][0][int(outputs('ExtendedGUID'))]), 0)"
          }
        },
        "Invoke_http_Get_Sites": {
          "runAfter": {
            "List_All_UN_number_to_Insert": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "8d0cbf6f-1e9d-4224-bacd-e3ad8c39d85c"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_webcontents",
              "operationId": "InvokeHttp",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
            },
            "parameters": {
              "request/method": "GET",
              "request/url": "https://graph.microsoft.com/v1.0/sites/034gc.sharepoint.com,140da73b-4423-4443-a812-e623d6d857c4,f2a2589e-2eec-4642-9280-443640f88211/lists/ddbec2ce-e3a5-4bf3-b065-23b0d1d0d395/drive/root:/CID_Bulk_Upload@{outputs('file_Ref_URL')}:/workbook/tables/TableAddBasic/rows"
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "define_extended_columns_in_excel_sheet": {
          "actions": {
            "ExtendedSite": {
              "runAfter": {
                "ExtendedAction": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "0b319d79-94cf-4ca6-bb49-3374fdd972f0"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['Site']"
            },
            "ExtendedUNNumber": {
              "runAfter": {
                "ExtendedSite": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "1f93a4c9-5519-4834-b9a6-fb3d5764c2eb"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['unnumber']"
            },
            "ExtendedQuantity": {
              "runAfter": {
                "ExtendedUNNumber": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "dbe26cc1-4c9c-4ba8-b85d-cb64eef8faef"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['Quantity']"
            },
            "ExtendedUnitOfMeasure": {
              "runAfter": {
                "ExtendedQuantity": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "e975e0f1-f06a-4dca-9047-e47503e2782b"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['Unit of Measure']"
            },
            "ExtendedAnnulaConsignment": {
              "runAfter": {
                "ExtendedUnitOfMeasure": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "75282f2f-4b8b-4689-9ea9-3782d51058df"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['Consignments']"
            },
            "ExtendedGUID": {
              "runAfter": {
                "ExtendedAnnulaConsignment": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3f6a122f-c20c-4d83-b063-3be620089848"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['UN-GUID']\r\n"
            },
            "Filter_array-environmentsetting-getExcelUNColumns": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "41f6f1a2-74a5-40a3-8f7a-1c9d91283a64"
              },
              "type": "Query",
              "inputs": {
                "from": "@outputs('get-environment-settings')?['body/value']",
                "where": "@equals(item()['qm_name'], 'CID_BulkUpload_Extended_Columns_In_Excel')"
              }
            },
            "ExtendedAction": {
              "runAfter": {
                "Parse_JSON-ExtendedColumns": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a1598679-b359-4995-8082-c3ab58b5ce7b"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['UserAction']"
            },
            "ExclJsonUNStringColumns": {
              "runAfter": {
                "Filter_array-environmentsetting-getExcelUNColumns": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "6c280618-ef32-4af0-90e1-8d8d3ad762f4"
              },
              "type": "Compose",
              "inputs": "@body('Filter_array-environmentsetting-getExcelUNColumns')?[0]['qm_value']"
            },
            "Parse_JSON-ExtendedColumns": {
              "runAfter": {
                "ExclJsonUNStringColumns": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3f62b9eb-4bd6-419b-953f-ba6f2c27ef27"
              },
              "type": "ParseJson",
              "inputs": {
                "content": "@outputs('ExclJsonUNStringColumns')",
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserAction": {
                      "type": "string"
                    },
                    "Site": {
                      "type": "string"
                    },
                    "unnumber": {
                      "type": "string"
                    },
                    "Quantity": {
                      "type": "string"
                    },
                    "Unit of Measure": {
                      "type": "string"
                    },
                    "Consignments": {
                      "type": "string"
                    },
                    "UN-GUID": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "runAfter": {
            "get_bulk_upload_summary_record": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "d4375930-3c4d-472c-a8b9-7d72d1b358f5"
          },
          "type": "Scope"
        },
        "define_basic_info_sheet_columns": {
          "actions": {
            "SiteName": {
              "runAfter": {
                "userAction": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "0b319d79-94cf-4ca6-bb49-3374fdd972f0"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Site']"
            },
            "Address1": {
              "runAfter": {
                "SiteName": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "1f93a4c9-5519-4834-b9a6-fb3d5764c2eb"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Address 1']"
            },
            "City": {
              "runAfter": {
                "Address1": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "dbe26cc1-4c9c-4ba8-b85d-cb64eef8faef"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['City']"
            },
            "Province": {
              "runAfter": {
                "City": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "e975e0f1-f06a-4dca-9047-e47503e2782b"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Province']"
            },
            "PostalCode": {
              "runAfter": {
                "Province": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "75282f2f-4b8b-4689-9ea9-3782d51058df"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Postal Code']"
            },
            "Address2": {
              "runAfter": {
                "PostalCode": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3f6a122f-c20c-4d83-b063-3be620089848"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Address 2']"
            },
            "Address3": {
              "runAfter": {
                "Address2": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "4026d79c-ae18-4b94-8b1d-296b3690cda9"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Address 3']"
            },
            "LLDProvince": {
              "runAfter": {
                "Address3": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "6cdb4c23-56ba-41ce-a13f-03aebdcb78b7"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['ProvinceLLD']"
            },
            "Quarter": {
              "runAfter": {
                "LLDProvince": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a29b5c9a-fe60-4d35-be55-454356d40e4f"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Quarter']"
            },
            "Section": {
              "runAfter": {
                "Quarter": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "42869346-d816-4923-b26b-e3ac7c3bb620"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Section']"
            },
            "TownShip": {
              "runAfter": {
                "Section": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "cdc284ff-1f84-471b-95da-6eddcc7e3427"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Township']"
            },
            "Range": {
              "runAfter": {
                "TownShip": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "f5b44d03-0ea1-4322-ad2e-ea6a9fda2fd5"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Range']"
            },
            "Meridian": {
              "runAfter": {
                "Range": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "794f7754-6314-4932-bb63-f299ce9974c5"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Meridian']"
            },
            "Lat": {
              "runAfter": {
                "Meridian": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3abf2572-b339-4126-a607-688e09d752f9"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Latitude']"
            },
            "Long": {
              "runAfter": {
                "Lat": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "855c0461-a4e4-4454-8a28-ead74c94fb7a"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Longitude']"
            },
            "Air-column": {
              "runAfter": {
                "Long": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "129357ef-35ce-4762-8f3f-2f1339fcc145"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Air']"
            },
            "Marine-column": {
              "runAfter": {
                "Air-column": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "33fb1f99-04f8-4e73-b7c2-71a74178883b"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Marine']"
            },
            "Rail-column": {
              "runAfter": {
                "Marine-column": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "b70f0b0e-5265-4b61-8963-fc1b4b8f8b4e"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Rail']"
            },
            "Road-column": {
              "runAfter": {
                "Rail-column": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "67efa3fd-0019-4731-ab45-38562b1c3afe"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Road']"
            },
            "Handle": {
              "runAfter": {
                "Road-column": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "87ed0437-464f-4d68-8884-f0aaa8cc4909"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Handle']"
            },
            "OfferForTransport": {
              "runAfter": {
                "Handle": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a075538b-4938-451b-aa5c-b0b909e8bceb"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Offer for Transport']"
            },
            "Transport": {
              "runAfter": {
                "OfferForTransport": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "4be5c4d6-7fd5-425e-9fd7-93ec3d499774"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Transport']"
            },
            "Import": {
              "runAfter": {
                "Transport": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "b5d428ee-008d-48b7-af90-7003164339a4"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Import']"
            },
            "Class-column": {
              "runAfter": {
                "Import": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "b8301325-ecf8-44e1-addf-9c005e8daae5"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Class']"
            },
            "extendedYN": {
              "runAfter": {
                "Class-column": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a3f56429-de62-4db0-8ac3-2f7dba91b8e2"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Extended-Information-Site']"
            },
            "LineNumber": {
              "runAfter": {
                "extendedYN": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "87e59482-f129-418f-b5a6-66cf15fa34a4"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Row number']"
            },
            "SiteFullAddress": {
              "runAfter": {
                "LineNumber": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "097c3321-7f83-4634-9681-c902ac84dd3a"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['SiteFullAddress']"
            },
            "SiteGUID": {
              "runAfter": {
                "SiteFullAddress": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "5f6eb9ca-7a27-41e2-b0a5-851101b1f606"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['site-GUID']"
            },
            "userAction": {
              "runAfter": {
                "Parse_JSON": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a1598679-b359-4995-8082-c3ab58b5ce7b"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['UserAction']"
            },
            "Parse_JSON": {
              "runAfter": {
                "ExclJsonStringColumns": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3f62b9eb-4bd6-419b-953f-ba6f2c27ef27"
              },
              "type": "ParseJson",
              "inputs": {
                "content": "@outputs('ExclJsonStringColumns')",
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserAction": {
                      "type": "string"
                    },
                    "Site Name": {
                      "type": "string"
                    },
                    "Address 1": {
                      "type": "string"
                    },
                    "City": {
                      "type": "string"
                    },
                    "Province": {
                      "type": "string"
                    },
                    "Postal Code ": {
                      "type": "string"
                    },
                    "Address 2": {
                      "type": "string"
                    },
                    "Address 3": {
                      "type": "string"
                    },
                    "Province  ": {
                      "type": "string"
                    },
                    "Quarter ": {
                      "type": "string"
                    },
                    "Section": {
                      "type": "string"
                    },
                    "Township": {
                      "type": "string"
                    },
                    "Range": {
                      "type": "string"
                    },
                    "Meridian": {
                      "type": "string"
                    },
                    "Latitude": {
                      "type": "string"
                    },
                    "Longitude": {
                      "type": "string"
                    },
                    " Air": {
                      "type": "string"
                    },
                    "Marine": {
                      "type": "string"
                    },
                    "Rail": {
                      "type": "string"
                    },
                    "Road": {
                      "type": "string"
                    },
                    "Handle": {
                      "type": "string"
                    },
                    "Offer for Transport": {
                      "type": "string"
                    },
                    "Transport": {
                      "type": "string"
                    },
                    "Import": {
                      "type": "string"
                    },
                    "Class/Division ": {
                      "type": "string"
                    },
                    "Extended Information Site ": {
                      "type": "string"
                    },
                    "Row number": {
                      "type": "string"
                    },
                    "SiteFullAddress": {
                      "type": "string"
                    },
                    "site-GUID": {
                      "type": "string"
                    }
                  }
                }
              }
            },
            "ExclJsonStringColumns": {
              "runAfter": {
                "Filter_array-environmentsetting-getExcelSiteColumns": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "6c280618-ef32-4af0-90e1-8d8d3ad762f4"
              },
              "type": "Compose",
              "inputs": "@body('Filter_array-environmentsetting-getExcelSiteColumns')?[0]['qm_value']"
            },
            "Filter_array-environmentsetting-getExcelSiteColumns": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "41f6f1a2-74a5-40a3-8f7a-1c9d91283a64"
              },
              "type": "Query",
              "inputs": {
                "from": "@outputs('get-environment-settings')?['body/value']",
                "where": "@equals(item()['qm_name'], 'CID_BulkUpload_Sites_Columns_In_Excel')"
              }
            }
          },
          "runAfter": {
            "define_extended_columns_in_excel_sheet": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "d4375930-3c4d-472c-a8b9-7d72d1b358f5"
          },
          "type": "Scope"
        },
        "get-environment-settings": {
          "runAfter": {
            "Initialize_variable-Province": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "7ed63b1d-9cf8-403e-9d9c-56cdd03f198e"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps",
              "operationId": "ListRecords",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "qm_environmentsettingses",
              "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n<entity name=\"qm_environmentsettings\">\n<attribute name=\"qm_environmentsettingsid\"/>\n<attribute name=\"qm_name\"/>\n<attribute name=\"qm_value\"/>\n<order attribute=\"qm_name\" descending=\"false\"/>\n<filter type=\"and\">\n<condition attribute=\"qm_name\" operator=\"like\" value=\"%CID[_]%\"/>\n</filter>\n</entity>\n</fetch>"
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "Filter_array-GetEnvironmentVariable": {
          "runAfter": {
            "get-environment-settings": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "41f6f1a2-74a5-40a3-8f7a-1c9d91283a64"
          },
          "type": "Query",
          "inputs": {
            "from": "@outputs('get-environment-settings')?['body/value']",
            "where": "@equals(item()['qm_name'], 'CID_Flow_Environment_Folder')"
          }
        },
        "Initialize_Environment_folder_variable_": {
          "runAfter": {
            "Filter_array-GetEnvironmentVariable": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "5ca273ca-89de-414e-ae48-1db4c68c1cb2"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Environment_folder",
                "type": "string",
                "value": "@{body('Filter_array-GetEnvironmentVariable')?[0]['qm_value']}"
              }
            ]
          }
        },
        "Initialize_variable_-_UNGUID": {
          "runAfter": {
            "Initialize_variable_-_UNDisplayName": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "5453d7ba-86e7-47c3-a588-c3c088616570"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "UN_GUID",
                "type": "string"
              }
            ]
          }
        },
        "Initialize_variable-ShippingName": {
          "runAfter": {
            "Initialize_variable-_UN-GUID-RelatedtoSiteUpdate": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "8c904484-9816-4b7f-8de2-d39f68e35690"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "ShippingName",
                "type": "string"
              }
            ]
          }
        },
        "Initialize_variable_-_UNDisplayName": {
          "runAfter": {
            "Initialize_variable_Import": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "2bfce8d5-6693-43e0-8c5a-72ddcdcfba9e"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "UNDisplayName",
                "type": "string"
              }
            ]
          }
        },
        "Initialize_variable-_UN-GUID-RelatedtoSiteUpdate": {
          "runAfter": {
            "Initialize_variable_-_UNGUID": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "40397ada-1dad-446f-8c80-1386da6d3ae3"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "UN-GUID-SiteUpdate",
                "type": "string"
              }
            ]
          }
        },
        "Get_Contact": {
          "runAfter": {
            "Get_Account_Info": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "adff44a2-4879-4eca-9a47-fca84045bbe9"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "GetItem",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "contacts",
              "recordId": "@triggerBody()['text_3']"
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "List_All_Sites": {
          "runAfter": {
            "Get_folder_metadata": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "05c212d4-bdab-4ba9-a408-cc89507d9cdd"
          },
          "type": "Query",
          "inputs": {
            "from": "@outputs('Invoke_http_Get_Sites')?['body']['value']",
            "where": "@greater(length(item()['values'][0][int(outputs('SiteFullAddress'))]), 0)"
          }
        },
        "List_All_UNs": {
          "runAfter": {
            "List_All_Sites": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "05c212d4-bdab-4ba9-a408-cc89507d9cdd"
          },
          "type": "Query",
          "inputs": {
            "from": "@outputs('Invoke_an_HTTP_request_-_unnumber')?['body']['value']",
            "where": "@greater(length(item()?['values'][0][int(outputs('ExtendedUNNumber'))]), 0)"
          }
        },
        "Choice_String_Maps": {
          "actions": {
            "StringMap_-_List_Class": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "b492125b-acf1-4b7f-89ed-5390ac9fb4d2"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "stringmaps",
                  "fetchXml": "<fetch>\n  <entity name=\"stringmap\" >\n    <attribute name=\"attributevalue\" />\n    <attribute name=\"attributename\" />\n    <attribute name=\"value\" />\n    <filter>\n\n      <condition attribute=\"attributename\" operator=\"eq\" value=\"ovs_primeclass\" />\n     \n    </filter>\n  </entity>\n</fetch>"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            },
            "StringMap-Quarter-LLD": {
              "runAfter": {
                "StringMap_-_List_Class": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a788e1c3-895f-4e88-a3a0-143e2d6f72ac"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "stringmaps",
                  "fetchXml": "<fetch>\n  <entity name=\"stringmap\" >\n    <attribute name=\"attributevalue\" />\n    <attribute name=\"attributename\" />\n    <attribute name=\"value\" />\n    <filter>\n<condition attribute=\"attributename\" operator=\"eq\" value=\"ovs_lld_quarter\"/>\n     \n    </filter>\n  </entity>\n</fetch>"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            },
            "StringMap_-_Type_of_measurement_list": {
              "runAfter": {
                "StringMap-Section": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "d27310cf-dbc1-4fce-bd99-9f8768204475"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "stringmaps",
                  "fetchXml": "<fetch>\n  <entity name=\"stringmap\" >\n    <attribute name=\"attributevalue\" />\n    <attribute name=\"attributename\" />\n    <attribute name=\"value\" />\n    <filter>\n      <condition attribute=\"objecttypecode\" operator=\"eq\" value=\"10636\" />\n      <condition attribute=\"attributename\" operator=\"eq\" value=\"cid_Unitofmeasurement\" />\n    \n    </filter>\n  </entity>\n</fetch>"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            },
            "StringMap_-_CID_Requirement_level_option_set": {
              "runAfter": {
                "StringMap-Quarter-LLD": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "b492125b-acf1-4b7f-89ed-5390ac9fb4d2"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "stringmaps",
                  "fetchXml": "<fetch>\n  <entity name=\"stringmap\" >\n    <attribute name=\"attributevalue\" />\n    <attribute name=\"attributename\" />\n    <attribute name=\"value\" />\n    <filter>\n      <condition attribute=\"objecttypecode\" operator=\"eq\" value=\"1\" />\n      <condition attribute=\"attributename\" operator=\"eq\" value=\"cid_requirementlevel\"/>\n     \n    </filter>\n  </entity>\n</fetch>"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            },
            "StringMap-Section": {
              "runAfter": {
                "StringMap_-_CID_Requirement_level_option_set": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "2afaf075-6b1f-4337-9f7a-2e6cd71bb1b8"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "stringmaps",
                  "fetchXml": "<fetch>\n  <entity name=\"stringmap\" >\n    <attribute name=\"attributevalue\" />\n    <attribute name=\"attributename\" />\n    <attribute name=\"value\" />\n    <filter>\n<condition attribute=\"attributename\" operator=\"eq\" value=\"ovs_lld_section\"/>\n     \n    </filter>\n  </entity>\n</fetch>"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            },
            "StringMap-TownShip": {
              "runAfter": {
                "StringMap_-_Type_of_measurement_list": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a8ab798b-6681-41c8-9a0d-fbe7b8b1f0ea"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "stringmaps",
                  "fetchXml": "<fetch>\n  <entity name=\"stringmap\" >\n    <attribute name=\"attributevalue\" />\n    <attribute name=\"attributename\" />\n    <attribute name=\"value\" />\n    <filter>\n<condition attribute=\"attributename\" operator=\"eq\" value=\"ovs_lld_township\"/>\n     \n    </filter>\n  </entity>\n</fetch>"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            },
            "StringMap-Range": {
              "runAfter": {
                "StringMap-Quarter-Meridian": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a33d1d87-7281-4074-b092-a97691a373f0"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "stringmaps",
                  "fetchXml": "<fetch>\n  <entity name=\"stringmap\" >\n    <attribute name=\"attributevalue\" />\n    <attribute name=\"attributename\" />\n    <attribute name=\"value\" />\n    <filter>\n<condition attribute=\"attributename\" operator=\"eq\" value=\"ovs_lld_range\"/>\n     \n    </filter>\n  </entity>\n</fetch>"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            },
            "StringMap-Quarter-Meridian": {
              "runAfter": {
                "StringMap-TownShip": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "764625d0-223b-4093-81f3-285c54185a87"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "stringmaps",
                  "fetchXml": "<fetch>\n  <entity name=\"stringmap\" >\n    <attribute name=\"attributevalue\" />\n    <attribute name=\"attributename\" />\n    <attribute name=\"value\" />\n    <filter>\n<condition attribute=\"attributename\" operator=\"eq\" value=\"ovs_lld_meridian\"/>\n     \n    </filter>\n  </entity>\n</fetch>"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            }
          },
          "runAfter": {
            "accountlookup": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "e6e44a75-5241-421d-9c85-c6e75301dfc6"
          },
          "type": "Scope"
        },
        "Language_is_English": {
          "actions": {
            "Send_summary_email_to_portal_contact_in_English": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "03fa68c2-eaef-45a3-a78e-77053dd96194"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_sendmail",
                  "operationId": "SendEmailV3",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_sendmail"
                },
                "parameters": {
                  "request/to": "@{outputs('Get_Contact')?['body/emailaddress1']};",
                  "request/subject": "The uploaded workbook has been processed successfully",
                  "request/text": "<p>Hi @{outputs('Get_Contact')?['body/firstname']},<br>\nThe uploaded workbook for @{outputs('Get_Account_Info')?['body/ovs_legalname']} &nbsp;has been processed successfully:<br>\nThe following are summary of the upload:<br>\nDate of the upload: @{body('Convert_time_zone')}<br>\n# Sites in the workbook:@{length(body('List_All_Sites'))}<br>\n# UN in the workbook: @{length(body('List_All_UNs'))}<br>\nFile Name:@{outputs('get_bulk_upload_summary_record')?['body/cid_filename']}<br>\n</p>"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            }
          },
          "runAfter": {
            "Convert_time_zone": [
              "Succeeded"
            ]
          },
          "else": {
            "actions": {
              "Send_summary_email_to_portal_contact_in_French": {
                "runAfter": {},
                "metadata": {
                  "operationMetadataId": "87209241-078e-426d-9663-566b2623e814"
                },
                "type": "OpenApiConnection",
                "inputs": {
                  "host": {
                    "connectionName": "shared_sendmail",
                    "operationId": "SendEmailV3",
                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_sendmail"
                  },
                  "parameters": {
                    "request/to": "@{outputs('Get_Contact')?['body/emailaddress1']};",
                    "request/subject": "The uploaded workbook has been processed successfully",
                    "request/text": "<p><br>\nSalut @{outputs('Get_Contact')?['body/firstname']},<br>\nLe classeur importé pour @{outputs('Get_Account_Info')?['body/ovs_legalname']} a été traité avec succès :<br>\nVoici un résumé du téléchargement :<br>\nDate du téléchargement :@{body('Convert_time_zone')}<br>\n# Sites dans le classeur :@{length(body('List_All_Sites'))}<br>\n# ONU dans le classeur :@{length(body('List_All_UNs'))}<br>\nNom de fichier:@{outputs('get_bulk_upload_summary_record')?['body/cid_filename']}</p>"
                  },
                  "authentication": {
                    "type": "Raw",
                    "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                  }
                }
              }
            }
          },
          "expression": {
            "equals": [
              "@outputs('Get_Contact')?['body/cid_languageofcorrespondence']",
              918640001
            ]
          },
          "metadata": {
            "operationMetadataId": "37c9cb98-e82d-47d1-8288-e5279e81d2d6"
          },
          "type": "If"
        },
        "get_bulk_upload_summary_record": {
          "runAfter": {
            "Get_Contact": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "7d317092-6f16-4671-b2e5-0443308b8242"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "GetItem",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "cid_bulkactivitylogsummaries",
              "recordId": "@triggerBody()['text_2']"
            },
            "authentication": {
              "type": "Raw",
              "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
            }
          }
        },
        "Response": {
          "runAfter": {
            "Close_Activity": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "463d9823-fb50-4991-afb5-97c0f39c9119"
          },
          "type": "Response",
          "kind": "Http",
          "inputs": {
            "statusCode": 200
          }
        },
        "check_if_delete_UN_number_is_required": {
          "actions": {
            "List_All_UN_rows_under_parent_account": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "1f5d0802-0ff1-4931-8759-52ff00665346"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "ovs_operationunnumbers",
                  "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n<entity name=\"ovs_operationunnumber\">\n<attribute name=\"ovs_name\"/>\n<attribute name=\"ovs_operationunnumberid\"/>\n<order attribute=\"ovs_name\" descending=\"false\"/>\n<link-entity name=\"ovs_mocregistration\" from=\"ovs_mocregistrationid\" to=\"ovs_operationunnumber\" link-type=\"inner\" alias=\"ac\">\n<link-entity name=\"account\" from=\"accountid\" to=\"ovs_siteid\" link-type=\"inner\" alias=\"ad\">\n<filter type=\"and\">\n<condition attribute=\"parentaccountid\" operator=\"eq\"  value=\"@{triggerBody()['text']}\"/>\n</filter>\n</link-entity>\n</link-entity>\n</entity>\n</fetch>"
                },
                "authentication": {
                  "type": "Raw",
                  "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                }
              }
            },
            "Apply_to_each_UN_row_to_delete": {
              "foreach": "@outputs('List_All_UN_rows_under_parent_account')?['body/value']",
              "actions": {
                "Delete_UN_Row": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "8d369b03-04b2-41e0-b59e-6d9170217202"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps_1",
                      "operationId": "DeleteRecord",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "ovs_operationunnumbers",
                      "recordId": "@items('Apply_to_each_UN_row_to_delete')?['ovs_operationunnumberid']"
                    },
                    "authentication": {
                      "type": "Raw",
                      "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                    }
                  }
                }
              },
              "runAfter": {
                "List_All_UN_rows_under_parent_account": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "cec00236-1701-42f0-bba2-406e1d856876"
              },
              "type": "Foreach"
            }
          },
          "runAfter": {
            "Invoke_http_Get_Sites": [
              "Succeeded"
            ]
          },
          "else": {
            "actions": {
              "update_Un_number": {
                "actions": {
                  "Get_UNNumber_to_update": {
                    "runAfter": {},
                    "metadata": {
                      "operationMetadataId": "949208f9-3bfc-4aec-b0fa-e26b7d975c49"
                    },
                    "type": "OpenApiConnection",
                    "inputs": {
                      "host": {
                        "connectionName": "shared_webcontents",
                        "operationId": "InvokeHttp",
                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                      },
                      "parameters": {
                        "request/method": "GET",
                        "request/url": "https://graph.microsoft.com/v1.0/sites/034gc.sharepoint.com,140da73b-4423-4443-a812-e623d6d857c4,f2a2589e-2eec-4642-9280-443640f88211/lists/ddbec2ce-e3a5-4bf3-b065-23b0d1d0d395/drive/root:/CID_Bulk_Upload@{outputs('file_Ref_URL')}:/workbook/tables/TableAddExtended/rows"
                      },
                      "authentication": {
                        "type": "Raw",
                        "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                      }
                    }
                  },
                  "List_All_UN_number_to_update": {
                    "runAfter": {
                      "Get_UNNumber_to_update": [
                        "Succeeded"
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "05c212d4-bdab-4ba9-a408-cc89507d9cdd"
                    },
                    "type": "Query",
                    "inputs": {
                      "from": "@outputs('Get_UNNumber_to_update')?['body']['value']",
                      "where": "@greater(length(item()['values'][0][int(outputs('ExtendedGUID'))]), 0)"
                    }
                  },
                  "For_each_Update_UNs": {
                    "foreach": "@body('List_All_UN_number_to_update')",
                    "actions": {
                      "UN-row-UN-Update": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "285f3692-c760-4400-8e86-c726bd09097a"
                        },
                        "type": "Compose",
                        "inputs": "@items('For_each_Update_UNs')"
                      },
                      "Check_if_UN_number_is_not_null_2": {
                        "actions": {
                          "Get_Type_of_measurement_option_set_index_2": {
                            "runAfter": {
                              "Check_if_more_than_un_found_3": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "7471031a-5efb-4103-a623-250e404dadb1"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@outputs('StringMap_-_Type_of_measurement_list')?['body/value']",
                              "where": "@equals(item()?['value'], outputs('UN-row-UN-Update')['values'][0][int(outputs('ExtendedUnitOfMeasure'))])"
                            }
                          },
                          "Index-unit-of-measurement_type-UnUpdate": {
                            "runAfter": {
                              "Get_Type_of_measurement_option_set_index_2": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "9238ee04-e629-4672-a1ad-e7684ae864e8"
                            },
                            "type": "Compose",
                            "inputs": "@body('Get_Type_of_measurement_option_set_index_2')?[0]?['attributevalue']"
                          },
                          "UNNumber-Split-UN-update": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "3489cbf9-0940-44d8-9b9b-7030d00bfe59"
                            },
                            "type": "Compose",
                            "inputs": "@split(outputs('UN-row-UN-Update')['values'][0][int(outputs('ExtendedUNNumber'))], '-')"
                          },
                          "UNNumber-Value-updatedUN": {
                            "runAfter": {
                              "UNNumber-split-unUpdate-Length": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "30b2551c-eaf1-48b2-aec9-16ef692b7829"
                            },
                            "type": "Compose",
                            "inputs": "@Trim(outputs('UNNumber-Split-UN-update')[0])"
                          },
                          "UNNumber-split-unUpdate-Length": {
                            "runAfter": {
                              "UNNumber-Split-UN-update": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "f1c64c63-d24f-4306-95a2-bb6dc41f32b9"
                            },
                            "type": "Compose",
                            "inputs": "@length(outputs('UNNumber-Split-UN-update'))"
                          },
                          "Check_if_more_than_un_found_3": {
                            "actions": {
                              "Apply_to_each_UN_filter_with_Display_Name_3": {
                                "foreach": "@body('Filter-UN-with-UNDisplayName-UNUpdate')",
                                "actions": {
                                  "currentRow-UN_3": {
                                    "runAfter": {},
                                    "metadata": {
                                      "operationMetadataId": "1e2a20c0-b111-4fb8-8d99-cba07f67072a"
                                    },
                                    "type": "Compose",
                                    "inputs": "@items('Apply_to_each_UN_filter_with_Display_Name_3')"
                                  },
                                  "check_if_shipping_name_match_English_or_French_3": {
                                    "actions": {
                                      "Set_variable_6": {
                                        "runAfter": {},
                                        "metadata": {
                                          "operationMetadataId": "79610598-6cad-4e7c-96f5-7233a474c395"
                                        },
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "UN-GUID-SiteUpdate",
                                          "value": "@{outputs('currentRow-UN_3')['tdg_unnumberid']}"
                                        }
                                      }
                                    },
                                    "runAfter": {
                                      "currentRow-UN_3": [
                                        "Succeeded"
                                      ]
                                    },
                                    "expression": {
                                      "or": [
                                        {
                                          "equals": [
                                            "@outputs('currentRow-UN_3')['tdg_shippingnamedescriptionetxt']",
                                            ""
                                          ]
                                        },
                                        {
                                          "equals": [
                                            "@outputs('currentRow-UN_3')['tdg_shippingnamedescriptionftxt']",
                                            ""
                                          ]
                                        }
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "4a376feb-1225-428b-8d9e-de5141067b2c"
                                    },
                                    "type": "If"
                                  }
                                },
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "68c2e923-eb19-4339-9cc6-b3e440d39604"
                                },
                                "type": "Foreach"
                              }
                            },
                            "runAfter": {
                              "update_UN-GUID-SiteUpdate-withFirst-Row_2": [
                                "Succeeded"
                              ]
                            },
                            "expression": {
                              "greater": [
                                "@length(body('Filter-UN-with-UNDisplayName-UNUpdate'))",
                                1
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "7e4d5a2f-a421-406d-8b6c-60b5e4345e37"
                            },
                            "type": "If"
                          },
                          "Filter-UN-with-UNDisplayName-UNUpdate": {
                            "runAfter": {
                              "UN-ShippingName-UNUpdate": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "ccece463-ad60-44bb-be52-68dc4785f3fd"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@outputs('List_UN_numbers')?['body/value']",
                              "where": "@equals(item()['tdg_undisplayname'], outputs('UNDisplayName-UpdatedUN'))"
                            }
                          },
                          "UNDisplayName-UpdatedUN": {
                            "runAfter": {
                              "UNNumber-Value-updatedUN": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "bb83b6d6-3b4b-49ef-9aa4-518cae33737c"
                            },
                            "type": "Compose",
                            "inputs": "@if(equals(outputs('UNNumber-split-unUpdate-Length'), 3), concat(trim(outputs('UNNumber-Value-updatedUN')), '-', Trim(outputs('UNNumber-Split-UN-update')[1])), trim(outputs('UNNumber-Value-updatedUN')))"
                          },
                          "UN-ShippingName-UNUpdate": {
                            "runAfter": {
                              "UNDisplayName-UpdatedUN": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "fd58106e-d175-44b0-a81a-9686767e9192"
                            },
                            "type": "Compose",
                            "inputs": "@if(equals(outputs('UNNumber-split-unUpdate-Length'), 3), Trim(outputs('UNNumber-Split-UN-update')[2]), Trim(outputs('UNNumber-Split-UN-update')[1]))"
                          },
                          "update_UN-GUID-SiteUpdate-withFirst-Row_2": {
                            "runAfter": {
                              "Filter-UN-with-UNDisplayName-UNUpdate": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "5d3604a0-052e-4707-90a4-ee0dc8519a53"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "UN-GUID-SiteUpdate",
                              "value": "@{body('Filter-UN-with-UNDisplayName-UNUpdate')?[0]['tdg_unnumberid']}"
                            }
                          },
                          "check_if_un_number_action_is_for_delete_2": {
                            "actions": {
                              "deactivate_unnumber_operation_2": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "f8b24383-853c-4293-83f0-2e2dfa729b7f"
                                },
                                "type": "OpenApiConnection",
                                "inputs": {
                                  "host": {
                                    "connectionName": "shared_commondataserviceforapps_1",
                                    "operationId": "UpdateRecord",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                  },
                                  "parameters": {
                                    "entityName": "ovs_operationunnumbers",
                                    "recordId": "@outputs('UNUpdate-GUID')",
                                    "item/ovs_supplychaindirection": "930840001",
                                    "item/ovs_UNNumber@odata.bind": " ",
                                    "item/statuscode": 2
                                  },
                                  "authentication": {
                                    "type": "Raw",
                                    "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                                  }
                                }
                              }
                            },
                            "runAfter": {
                              "Index-unit-of-measurement_type-UnUpdate": [
                                "Succeeded"
                              ]
                            },
                            "else": {
                              "actions": {
                                "Update_operation_un_number_2": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "ab3fe0ac-daec-4275-b583-e60686c4279a"
                                  },
                                  "type": "OpenApiConnection",
                                  "inputs": {
                                    "host": {
                                      "connectionName": "shared_commondataserviceforapps_1",
                                      "operationId": "UpdateRecord",
                                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                    },
                                    "parameters": {
                                      "entityName": "ovs_operationunnumbers",
                                      "recordId": "@outputs('UNUpdate-GUID')",
                                      "item/ovs_supplychaindirection": "930840001",
                                      "item/cid_annualnumberofshipment": "@int(outputs('UN-row-UN-Update')?['values'][0][int(outputs('ExtendedAnnulaConsignment'))])",
                                      "item/cid_annualquantityvolume": "@int(outputs('UN-row-UN-Update')?['values'][0][int(outputs('ExtendedQuantity'))])",
                                      "item/cid_unitofmeasurement": "@outputs('Index-unit-of-measurement_type-UnUpdate')"
                                    },
                                    "authentication": {
                                      "type": "Raw",
                                      "value": "@json(decodeBase64(triggerOutputs().headers['X-MS-APIM-Tokens']))['$ConnectionKey']"
                                    }
                                  }
                                }
                              }
                            },
                            "expression": {
                              "equals": [
                                "@outputs('UN-row-UN-Update')?['values'][int(outputs('ExtendedAction'))]",
                                "Delete UN Details"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "16a92ba3-886a-487b-b7e2-3210932c1cbd"
                            },
                            "type": "If"
                          }
                        },
                        "runAfter": {
                          "UNUpdate-GUID": [
                            "Succeeded"
                          ]
                        },
                        "expression": {
                          "greater": [
                            "@length(trim(outputs('UN-row-UN-Update')['values'][0][int(outputs('ExtendedUNNumber'))]))",
                            0
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "2ac58c16-5959-4c78-87fc-10684cfdbfb3"
                        },
                        "type": "If"
                      },
                      "UNUpdate-GUID": {
                        "runAfter": {
                          "UN-row-UN-Update": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "693ddcf1-24f8-48f1-a460-d8c242d358d3"
                        },
                        "type": "Compose",
                        "inputs": "@outputs('UN-row-UN-Update')['values'][0][int(outputs('ExtendedGUID'))]"
                      }
                    },
                    "runAfter": {
                      "List_All_UN_number_to_update": [
                        "Succeeded"
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "eed152cc-0c52-40af-b240-b00e466d8aed"
                    },
                    "type": "Foreach"
                  }
                },
                "runAfter": {},
                "metadata": {
                  "operationMetadataId": "2d6060bb-796f-4d48-91cc-c0b5f98bd22b"
                },
                "type": "Scope"
              }
            }
          },
          "expression": {
            "equals": [
              1,
              1
            ]
          },
          "metadata": {
            "operationMetadataId": "03f7da4b-e6a8-4420-a708-a2e797cb5f7e"
          },
          "type": "If"
        },
        "Initialize_variable_-_Handle_Update": {
          "runAfter": {
            "Initialize_variable-import": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "ba86cf31-9fed-43d6-914a-ba45a27ef792"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Handle_upldate",
                "type": "boolean"
              }
            ]
          }
        },
        "Initialize_variable_OfferForTransport_update": {
          "runAfter": {
            "Initialize_variable_-_Handle_Update": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "94a413b3-8420-4e0c-9a8b-12faf2550c93"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "OfferForTransport_Update",
                "type": "boolean"
              }
            ]
          }
        },
        "Initialize_variable_Transport_Update": {
          "runAfter": {
            "Initialize_variable_OfferForTransport_update": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "a054426d-9e67-411b-9b66-2931ed36fadd"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Transport_Update",
                "type": "boolean"
              }
            ]
          }
        },
        "Initialize_variable_Import": {
          "runAfter": {
            "Initialize_variable_Transport_Update": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "77b8bf4b-79d6-4782-b10a-4be1eded350f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Import_Update",
                "type": "boolean"
              }
            ]
          }
        },
        "Convert_time_zone": {
          "runAfter": {
            "List_All_UNs": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f74cfa7b-9df9-43ef-a39a-8f7a83c4e844"
          },
          "type": "Expression",
          "kind": "ConvertTimeZone",
          "inputs": {
            "baseTime": "@outputs('get_bulk_upload_summary_record')?['body/createdon']",
            "formatString": "yyyy-MM-dd hh:mm",
            "sourceTimeZone": "Eastern Standard Time",
            "destinationTimeZone": "Eastern Standard Time"
          }
        }
      },
      "outputs": {}
    }
  },
  "schemaVersion": "1.0.0.0"
}