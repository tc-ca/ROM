{
  "properties": {
    "connectionReferences": {
      "shared_commondataserviceforapps_1": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "tdg_ConnectionReferenceDataverseServicePrinciple"
        },
        "api": {
          "name": "shared_commondataserviceforapps"
        }
      },
      "shared_webcontents": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "cid_sharedwebcontents_efbe7"
        },
        "api": {
          "name": "shared_webcontents"
        }
      },
      "shared_sendmail": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "cid_sharedsendmail_883c5"
        },
        "api": {
          "name": "shared_sendmail"
        }
      },
      "shared_commondataserviceforapps": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "tdg_ConnectionReferenceDataverseServicePrinciple"
        },
        "api": {
          "name": "shared_commondataserviceforapps"
        }
      }
    },
    "definition": {
      "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
      "contentVersion": "1.0.0.0",
      "parameters": {
        "$connections": {
          "defaultValue": {},
          "type": "Object"
        },
        "$authentication": {
          "defaultValue": {},
          "type": "SecureObject"
        }
      },
      "triggers": {
        "When_a_row_is_added,_modified_or_deleted": {
          "metadata": {
            "operationMetadataId": "fa1037c6-e762-4d2c-ae22-a3c3f9e8df54"
          },
          "type": "OpenApiConnectionWebhook",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps",
              "operationId": "SubscribeWebhookTrigger",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "subscriptionRequest/message": 3,
              "subscriptionRequest/entityname": "cid_bulkactivitylogsummary",
              "subscriptionRequest/scope": 4,
              "subscriptionRequest/filteringattributes": "cid_detailedvalidationstarttime",
              "subscriptionRequest/runas": 3
            },
            "authentication": "@parameters('$authentication')"
          }
        }
      },
      "actions": {
        "Check_if_Validation_should_start_on_the_Modified_event": {
          "actions": {
            "List_rows_UNNumber": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "49f988a5-a4a2-4243-af3f-56831c6264dc"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "tdg_unnumbers",
                  "$select": "tdg_name,tdg_unnumberid,tdg_packinggroupcd"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "List_Classes": {
              "runAfter": {
                "List_rows_UNNumber": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a286252a-94ac-4046-9988-64bbb54ee813"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "stringmaps",
                  "fetchXml": "<fetch>\n  <entity name=\"stringmap\" >\n    <attribute name=\"attributevalue\" />\n    <attribute name=\"attributename\" />\n    <attribute name=\"value\" />\n    <filter>\n\n      <condition attribute=\"attributename\" operator=\"eq\" value=\"ovs_primeclass\" />\n     \n    </filter>\n  </entity>\n</fetch>"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "List_All_Accounts": {
              "runAfter": {
                "List_Classes": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "0f914c7e-efed-4c8d-9146-29a295558772"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "accounts",
                  "$select": "address1_city,address1_stateorprovince,address1_line1,address1_postalcode,cid_unitnumber",
                  "$filter": "customertypecode eq 948010001 and _parentaccountid_value eq '@{outputs('CompanyId')}'",
                  "$expand": "parentaccountid($select=name,accountid)"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Invoke_an_HTTP_request_Get_Site_Table": {
              "runAfter": {
                "List_All_Accounts": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "59c6048d-c4f6-4e9a-8a0d-1df0e3d03d91"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_webcontents",
                  "operationId": "InvokeHttp",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                },
                "parameters": {
                  "request/method": "GET",
                  "request/url": "https://graph.microsoft.com/v1.0/sites/034gc.sharepoint.com,140da73b-4423-4443-a812-e623d6d857c4,f2a2589e-2eec-4642-9280-443640f88211/lists/ddbec2ce-e3a5-4bf3-b065-23b0d1d0d395/drive/root:/@{outputs('Get-File-Relative-Path')}:/workbook/tables/TableAddBasic/rows",
                  "request/headers": {
                    "accept": "application/json"
                  }
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Filter_table_-_get_none_empty_cells_sites_for_insert_": {
              "runAfter": {
                "Invoke_an_HTTP_request_Get_Site_Table": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "1f1c482b-be72-4cb9-8ef4-90104b2c6119"
              },
              "type": "Query",
              "inputs": {
                "from": "@outputs('Invoke_an_HTTP_request_Get_Site_Table')?['body']['value']",
                "where": "@greater(length(item()['values'][0][26]), 0)"
              }
            },
            "Invoke_an_HTTP_request_Get_Extended_info_table": {
              "runAfter": {
                "List_All_Accounts": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "59c6048d-c4f6-4e9a-8a0d-1df0e3d03d91"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_webcontents",
                  "operationId": "InvokeHttp",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                },
                "parameters": {
                  "request/method": "GET",
                  "request/url": "https://graph.microsoft.com/v1.0/sites/034gc.sharepoint.com,140da73b-4423-4443-a812-e623d6d857c4,f2a2589e-2eec-4642-9280-443640f88211/lists/ddbec2ce-e3a5-4bf3-b065-23b0d1d0d395/drive/root:/@{outputs('Get-File-Relative-Path')}:/workbook/tables/TableAddExtended/rows",
                  "request/headers": {
                    "accept": "application/json"
                  }
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "For_each_site_from_http_request": {
              "foreach": "@body('Filter_table_-_get_none_empty_cells_sites_for_insert_')",
              "actions": {
                "Current_row": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "692703f0-6bc6-4bc1-8199-14e43dfe7f6a"
                  },
                  "type": "Compose",
                  "inputs": "@items('For_each_site_from_http_request')"
                },
                "Check_if_all_required_address_information_is_entered": {
                  "actions": {
                    "Increment_RowNumber_2": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "ac6b817e-3c8a-4720-89f6-1e0f1734fab5"
                      },
                      "type": "IncrementVariable",
                      "inputs": {
                        "name": "RowNumber",
                        "value": 1
                      }
                    },
                    "Filter_array_-_Check_address_by_address_,_city_,_and_province": {
                      "runAfter": {
                        "Increment_RowNumber_2": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "cb6ac0c8-ddde-45cd-b7c0-2d89c9b0c0d2"
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@outputs('List_All_Accounts')?['body/value']",
                        "where": "@and( equals( length(string(outputs('current_row')['values'][0][26])),0)  , equals(item()?['address1_line1'], toUpper(outputs('current_row')['values'][0][1])), equals(item()?['address1_city'], toUpper(outputs('current_row')['values'][0][2])), equals(item()?['address1_stateorprovince'], toUpper(outputs('current_row')['values'][0][3])))"
                      }
                    },
                    "Check_if_address_exists_in_the_database": {
                      "actions": {
                        "Set_is_error_free_to_false_2": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "876cbe4c-cf79-41cb-9c82-008a32a55d8c"
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "IsErrorFree",
                            "value": "@false"
                          }
                        },
                        "Check_if_belong_to_account_2": {
                          "actions": {
                            "Site_Already_exist_2": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "a873dcdb-5ed2-41ec-8630-dd79461986d5"
                              },
                              "type": "AppendToArrayVariable",
                              "inputs": {
                                "name": "Error_List",
                                "value": {
                                  "SheetName": "Add Basic Info",
                                  "Row#": "@{outputs('Current_Row_number')}",
                                  "Site": "@{outputs('Current_Site_Address')}",
                                  "Error": "Site Already Exists, please use the update process to update site information"
                                }
                              }
                            }
                          },
                          "runAfter": {
                            "Set_is_error_free_to_false_2": [
                              "Succeeded"
                            ]
                          },
                          "else": {
                            "actions": {
                              "Append_to_array_-_site_belong_to_another_account_2": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "0721f40e-9313-4b23-ac3a-e7e03fce1613"
                                },
                                "type": "AppendToArrayVariable",
                                "inputs": {
                                  "name": "Error_List",
                                  "value": {
                                    "SheetName": "Add Basic Info",
                                    "Row#": "@{outputs('Current_Row_number')}",
                                    "Site": "@{outputs('Current_Site_Address')}",
                                    "Error": "Site belong to another Company please go thorugh the claim process"
                                  }
                                }
                              }
                            }
                          },
                          "expression": {
                            "equals": [
                              "@first(body('Filter_array_-_Check_address_by_address_,_city_,_and_province'))?['parentaccountid']?['accountid']",
                              "@triggerBody()?['accountid']"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "16b3e2fe-c1c8-41e0-84b0-5630c2ed22a9"
                          },
                          "type": "If"
                        }
                      },
                      "runAfter": {
                        "Filter_array_-_Check_address_by_address_,_city_,_and_province": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "check_if_city_exists": {
                            "actions": {
                              "Check_if_City_spelling_is_correct_and_province_match_is_correct_2": {
                                "actions": {
                                  "Province_2": {
                                    "runAfter": {},
                                    "metadata": {
                                      "operationMetadataId": "7eab0b76-4c57-41ae-b81a-9d1db24be760"
                                    },
                                    "type": "Compose",
                                    "inputs": "@outputs('current_row')['values'][0][3]"
                                  },
                                  "Get_call_Canada_Geo_Api_to_get_province_2": {
                                    "runAfter": {
                                      "Province_2": [
                                        "Succeeded"
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "775597cd-69c2-45a3-b4d4-87e01b072cda"
                                    },
                                    "type": "Http",
                                    "inputs": {
                                      "method": "GET",
                                      "uri": "https://geogratis.gc.ca/services/geoname/en/geonames.json?q=@{outputs('current_row')['values'][0][2]}",
                                      "headers": {
                                        "accept": "application/json"
                                      }
                                    }
                                  },
                                  "check_if_city_is_correct_2": {
                                    "actions": {
                                      "Get_Province_Code_from_Province_Array_2": {
                                        "runAfter": {},
                                        "metadata": {
                                          "operationMetadataId": "0b56a4be-ee78-4da6-b112-67912d00a444"
                                        },
                                        "type": "Compose",
                                        "inputs": "@variables('ProvinceCodes')[outputs('Province_2')]"
                                      },
                                      "Filter_Api_result_2": {
                                        "runAfter": {
                                          "Get_Province_Code_from_Province_Array_2": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "d05bd343-f426-4584-b99f-98ede8fd25a4"
                                        },
                                        "type": "Query",
                                        "inputs": {
                                          "from": "@body('Get_call_Canada_Geo_Api_to_get_province_2')['items']",
                                          "where": "@contains(item()['Province']['code'], outputs('Get_Province_Code_from_Province_Array_2'))"
                                        }
                                      },
                                      "Check_if_province_match_with_city_2": {
                                        "actions": {},
                                        "runAfter": {
                                          "Filter_Api_result_2": [
                                            "Succeeded"
                                          ]
                                        },
                                        "else": {
                                          "actions": {
                                            "Set_is_error_free_to_false_for_city_match_with_province_2": {
                                              "runAfter": {},
                                              "metadata": {
                                                "operationMetadataId": "876cbe4c-cf79-41cb-9c82-008a32a55d8c"
                                              },
                                              "type": "SetVariable",
                                              "inputs": {
                                                "name": "IsErrorFree",
                                                "value": "@false"
                                              }
                                            },
                                            "Append_to_array_-_City_doesn't_belong_to_province": {
                                              "runAfter": {
                                                "Set_variable_Error_Message_8": [
                                                  "Succeeded"
                                                ]
                                              },
                                              "metadata": {
                                                "operationMetadataId": "0721f40e-9313-4b23-ac3a-e7e03fce1613"
                                              },
                                              "type": "AppendToArrayVariable",
                                              "inputs": {
                                                "name": "Error_List",
                                                "value": {
                                                  "SheetName": "Add Basic Info",
                                                  "Row#": "@{outputs('Current_Row_number')}",
                                                  "Site": "@{outputs('Current_Site_Address')}",
                                                  "Error": "@{variables('Error_Message')}"
                                                }
                                              }
                                            },
                                            "Filter_array_Bulk008": {
                                              "runAfter": {
                                                "Set_is_error_free_to_false_for_city_match_with_province_2": [
                                                  "Succeeded"
                                                ]
                                              },
                                              "metadata": {
                                                "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                              },
                                              "type": "Query",
                                              "inputs": {
                                                "from": "@variables('Messages_Array')",
                                                "where": "@equals(item()['code'], 'Bulk008')"
                                              }
                                            },
                                            "Set_variable_Error_Message_8": {
                                              "runAfter": {
                                                "Filter_array_Bulk008": [
                                                  "Succeeded"
                                                ]
                                              },
                                              "metadata": {
                                                "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                              },
                                              "type": "SetVariable",
                                              "inputs": {
                                                "name": "Error_Message",
                                                "value": "@{body('Filter_array_Bulk008')[0]['Message']}"
                                              }
                                            },
                                            "Add_Bulk_Log_details_Bulk008": {
                                              "runAfter": {
                                                "Append_to_array_-_City_doesn't_belong_to_province": [
                                                  "Succeeded"
                                                ]
                                              },
                                              "metadata": {
                                                "operationMetadataId": "30269661-ce1c-4f70-abfe-8a81cf3f27d7"
                                              },
                                              "type": "OpenApiConnection",
                                              "inputs": {
                                                "host": {
                                                  "connectionName": "shared_commondataserviceforapps_1",
                                                  "operationId": "CreateRecord",
                                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                                },
                                                "parameters": {
                                                  "entityName": "cid_bulkactivitylogsdetailses",
                                                  "item/cid_BulkActivityLogSummary@odata.bind": "@outputs('Get_bulk_activities_log_summary_by_ID')?['body/cid_bulkactivitylogsummaryid']",
                                                  "item/cid_errordetails": "@variables('Error_Message')",
                                                  "item/cid_errorwarningcode": "Bulk008",
                                                  "item/cid_excelcolumnname": "City",
                                                  "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                                  "item/cid_excelsheetname": "Add Basic Info",
                                                  "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                                  "item/cid_type": 100000000
                                                },
                                                "authentication": "@parameters('$authentication')"
                                              }
                                            }
                                          }
                                        },
                                        "expression": {
                                          "greater": [
                                            "@length(body('Filter_Api_result_2'))",
                                            0
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "e95639cc-e26e-49c7-8d7b-b6bccf2987b5"
                                        },
                                        "type": "If"
                                      }
                                    },
                                    "runAfter": {
                                      "Get_call_Canada_Geo_Api_to_get_province_2": [
                                        "Succeeded"
                                      ]
                                    },
                                    "else": {
                                      "actions": {
                                        "Set_variable_error_free_to_false_for_city_not_correct_2": {
                                          "runAfter": {},
                                          "metadata": {
                                            "operationMetadataId": "3e23e089-210a-4907-8ba3-fb9fc8b12b3d"
                                          },
                                          "type": "SetVariable",
                                          "inputs": {
                                            "name": "IsErrorFree",
                                            "value": "@false"
                                          }
                                        },
                                        "Append_to_array_-_City_doesn't_belong_to_province_2": {
                                          "runAfter": {
                                            "Set_variable_Error_Message_Bulk007": [
                                              "Succeeded"
                                            ]
                                          },
                                          "metadata": {
                                            "operationMetadataId": "0721f40e-9313-4b23-ac3a-e7e03fce1613"
                                          },
                                          "type": "AppendToArrayVariable",
                                          "inputs": {
                                            "name": "Error_List",
                                            "value": {
                                              "SheetName": "Add Basic Info",
                                              "Row#": "@{outputs('Current_Row_number')}",
                                              "Site": "@{outputs('Current_Site_Address')}",
                                              "Error": "@{variables('Error_Message')}"
                                            }
                                          }
                                        },
                                        "Filter_array_Bulk007": {
                                          "runAfter": {
                                            "Set_variable_error_free_to_false_for_city_not_correct_2": [
                                              "Succeeded"
                                            ]
                                          },
                                          "metadata": {
                                            "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                          },
                                          "type": "Query",
                                          "inputs": {
                                            "from": "@variables('Messages_Array')",
                                            "where": "@equals(item()['code'], 'Bulk007')"
                                          }
                                        },
                                        "Set_variable_Error_Message_Bulk007": {
                                          "runAfter": {
                                            "Filter_array_Bulk007": [
                                              "Succeeded"
                                            ]
                                          },
                                          "metadata": {
                                            "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                          },
                                          "type": "SetVariable",
                                          "inputs": {
                                            "name": "Error_Message",
                                            "value": "@{Replace(body('Filter_array_Bulk007')[0]['Message'] , '{0}' , outputs('current_row')['values'][0][2])}"
                                          }
                                        },
                                        "Add_Bulk_Log_details_Bulk007": {
                                          "runAfter": {
                                            "Append_to_array_-_City_doesn't_belong_to_province_2": [
                                              "Succeeded"
                                            ]
                                          },
                                          "metadata": {
                                            "operationMetadataId": "7bd2c7c8-5212-4031-85a3-3de92b775314"
                                          },
                                          "type": "OpenApiConnection",
                                          "inputs": {
                                            "host": {
                                              "connectionName": "shared_commondataserviceforapps_1",
                                              "operationId": "CreateRecord",
                                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                            },
                                            "parameters": {
                                              "entityName": "cid_bulkactivitylogsdetailses",
                                              "item/cid_BulkActivityLogSummary@odata.bind": "@outputs('Get_bulk_activities_log_summary_by_ID')?['body/cid_bulkactivitylogsummaryid']",
                                              "item/cid_errordetails": "@variables('Error_Message')",
                                              "item/cid_errorwarningcode": "Bulk007",
                                              "item/cid_excelcolumnname": "City",
                                              "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                              "item/cid_excelsheetname": "Add Basic Info",
                                              "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                              "item/cid_type": 100000000
                                            },
                                            "authentication": "@parameters('$authentication')"
                                          }
                                        }
                                      }
                                    },
                                    "expression": {
                                      "greater": [
                                        "@length(body('Get_call_Canada_Geo_Api_to_get_province_2')['items'])",
                                        0
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "a9eea2f4-9c8d-4417-b0cc-5f707635bfcc"
                                    },
                                    "type": "If"
                                  }
                                },
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "288eb829-ba04-4fd3-87ca-4176b7fca5d4"
                                },
                                "type": "Scope"
                              }
                            },
                            "runAfter": {},
                            "expression": {
                              "greater": [
                                "@length(outputs('current_row')['values'][0][2])",
                                0
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "420196d7-f357-4689-9c90-ba57b9d93b79"
                            },
                            "type": "If"
                          }
                        }
                      },
                      "expression": {
                        "greater": [
                          "@length(body('Filter_array_-_Check_address_by_address_,_city_,_and_province'))",
                          0
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "c06dbc9d-12fe-441b-8c8d-4ca616d3d7bf"
                      },
                      "type": "If"
                    },
                    "Filter_array_-_Check_address_by_Legal_land_description": {
                      "runAfter": {
                        "Check_if_address_exists_in_the_database": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "cb6ac0c8-ddde-45cd-b7c0-2d89c9b0c0d2"
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@outputs('List_All_Accounts')?['body/value']",
                        "where": "@and(equals(length(string(outputs('current_row')['values'][0][26])), 0), equals(item()?['address1_line1'], toUpper(outputs('current_row')['values'][0][1])), equals(item()?['address1_city'], toUpper(outputs('current_row')['values'][0][2])), equals(item()?['address1_stateorprovince'], toUpper(outputs('current_row')['values'][0][3])))"
                      }
                    }
                  },
                  "runAfter": {
                    "Current_Site_Address": [
                      "Succeeded"
                    ]
                  },
                  "else": {
                    "actions": {
                      "Check_if_Missing_in_postal_address_A1": {
                        "actions": {
                          "Check_Address_1": {
                            "actions": {
                              "Filter_array_B1010": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                },
                                "type": "Query",
                                "inputs": {
                                  "from": "@variables('Messages_Array')",
                                  "where": "@equals(item()['code'], 'B1010')"
                                }
                              },
                              "Append_to_array_variable_4_Errorlist": {
                                "runAfter": {
                                  "Set_variable_Error_Message": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                },
                                "type": "AppendToArrayVariable",
                                "inputs": {
                                  "name": "Error_List",
                                  "value": {
                                    "SheetName": "Add Basic Info",
                                    "Row#": "@{outputs('Current_Row_number')}",
                                    "Site": "@{outputs('Current_Site_Address')}",
                                    "Error": "@{variables('Error_Message')}"
                                  }
                                }
                              },
                              "Set_variable_Error_Message": {
                                "runAfter": {
                                  "Filter_array_B1010": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                },
                                "type": "SetVariable",
                                "inputs": {
                                  "name": "Error_Message",
                                  "value": "@{body('Filter_array_B1010')[0]['Message']}"
                                }
                              },
                              "Add_Bulk_Log_details_B1010": {
                                "runAfter": {
                                  "Filter_Messages_to_log_in_bulk_log_details_B1010": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "7844857d-df1b-4017-be08-95e05a95ec4e"
                                },
                                "type": "OpenApiConnection",
                                "inputs": {
                                  "host": {
                                    "connectionName": "shared_commondataserviceforapps_1",
                                    "operationId": "CreateRecord",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                  },
                                  "parameters": {
                                    "entityName": "cid_bulkactivitylogsdetailses",
                                    "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                    "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1010')[0]['Eng-Message']",
                                    "item/cid_errorwarningcode": "B1010",
                                    "item/cid_excelcolumnname": "Address 1",
                                    "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                    "item/cid_excelsheetname": "Add Basic Info",
                                    "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                    "item/cid_type": 100000000
                                  },
                                  "authentication": "@parameters('$authentication')"
                                }
                              },
                              "Filter_Messages_to_log_in_bulk_log_details_B1010": {
                                "runAfter": {
                                  "Append_to_array_variable_4_Errorlist": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "e755b2d8-176c-430f-a770-26ce12d5e32a"
                                },
                                "type": "Query",
                                "inputs": {
                                  "from": "@body('Parse_Messages_to_JSON')",
                                  "where": "@equals(item()['code'], 'B1010')"
                                }
                              }
                            },
                            "runAfter": {},
                            "expression": {
                              "lessOrEquals": [
                                "@length(outputs('current_row')['values'][0][1])",
                                0
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                            },
                            "type": "If"
                          },
                          "Check_province": {
                            "actions": {
                              "Filter_array_B1008": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "2caa6a21-68b2-44eb-bf7f-0da00ee065e8"
                                },
                                "type": "Query",
                                "inputs": {
                                  "from": "@variables('Messages_Array')",
                                  "where": "@equals(item()['code'], 'B1008')"
                                }
                              },
                              "Append_to_array_variable_4_Errorlist_2": {
                                "runAfter": {
                                  "Set_variable_Error_Message_Province": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "09ced01c-ef78-46c4-8f5f-246682477e1c"
                                },
                                "type": "AppendToArrayVariable",
                                "inputs": {
                                  "name": "Error_List",
                                  "value": {
                                    "SheetName": "Add Basic Info",
                                    "Row#": "@{outputs('Current_Row_number')}",
                                    "Site": "@{outputs('Current_Site_Address')}",
                                    "Error": "@{variables('Error_Message')}"
                                  }
                                }
                              },
                              "Set_variable_Error_Message_Province": {
                                "runAfter": {
                                  "Filter_array_B1008": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "f793fce8-1f1d-445e-9c2a-34ae47a340d2"
                                },
                                "type": "SetVariable",
                                "inputs": {
                                  "name": "Error_Message",
                                  "value": "@{body('Filter_array_B1008')[0]['Message']}"
                                }
                              },
                              "Filter_Messages_to_log_in_bulk_log_details_B1008": {
                                "runAfter": {
                                  "Append_to_array_variable_4_Errorlist_2": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "1745f3d3-5a58-490f-89f1-50726059ca12"
                                },
                                "type": "Query",
                                "inputs": {
                                  "from": "@body('Parse_Messages_to_JSON')",
                                  "where": "@equals(item()['code'], 'B1008')"
                                }
                              },
                              "Add_Bulk_Log_details_B1008": {
                                "runAfter": {
                                  "Filter_Messages_to_log_in_bulk_log_details_B1008": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "c9eac902-da6f-42dc-839c-d11d5d9900b0"
                                },
                                "type": "OpenApiConnection",
                                "inputs": {
                                  "host": {
                                    "connectionName": "shared_commondataserviceforapps_1",
                                    "operationId": "CreateRecord",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                  },
                                  "parameters": {
                                    "entityName": "cid_bulkactivitylogsdetailses",
                                    "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                    "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1008')[0]['Eng-Message']",
                                    "item/cid_errorwarningcode": "B1008",
                                    "item/cid_excelcolumnname": "Province",
                                    "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                    "item/cid_excelsheetname": "Add Basic Info",
                                    "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                    "item/cid_type": 100000000
                                  },
                                  "authentication": "@parameters('$authentication')"
                                }
                              }
                            },
                            "runAfter": {
                              "Check_Address_1": [
                                "Succeeded"
                              ]
                            },
                            "expression": {
                              "lessOrEquals": [
                                "@length(outputs('current_row')['values'][0][3])",
                                0
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "72ffeacd-d72b-4874-b2b7-ef368375f998"
                            },
                            "type": "If"
                          },
                          "Check_PostalCode": {
                            "actions": {
                              "Filter_array_B1009": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "3f29ab51-bf71-47bb-a55a-6a2948100237"
                                },
                                "type": "Query",
                                "inputs": {
                                  "from": "@variables('Messages_Array')",
                                  "where": "@equals(item()['code'], 'B1009')"
                                }
                              },
                              "Append_to_array_variable_error_Postal_code_missing": {
                                "runAfter": {
                                  "Set_variable_Error_Message_Postalcode": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "35bde0e4-44ee-43ee-a978-b15ef18f851b"
                                },
                                "type": "AppendToArrayVariable",
                                "inputs": {
                                  "name": "Error_List",
                                  "value": {
                                    "SheetName": "Add Basic Info",
                                    "Row#": "@{outputs('Current_Row_number')}",
                                    "Site": "@{outputs('Current_Site_Address')}",
                                    "Error": "@{variables('Error_Message')}"
                                  }
                                }
                              },
                              "Set_variable_Error_Message_Postalcode": {
                                "runAfter": {
                                  "Filter_array_B1009": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "1c699dd5-f727-43e8-98d7-ee042d5c3ae6"
                                },
                                "type": "SetVariable",
                                "inputs": {
                                  "name": "Error_Message",
                                  "value": "@{body('Filter_array_B1009')[0]['Message']}"
                                }
                              },
                              "Filter_Messages_to_log_in_bulk_log_details_B1009": {
                                "runAfter": {
                                  "Append_to_array_variable_error_Postal_code_missing": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "bba06d84-3400-423d-aee0-c390c43b8cf7"
                                },
                                "type": "Query",
                                "inputs": {
                                  "from": "@body('Parse_Messages_to_JSON')",
                                  "where": "@equals(item()['code'], 'B1009')"
                                }
                              },
                              "Add_Bulk_Log_details_Bulk004": {
                                "runAfter": {
                                  "Filter_Messages_to_log_in_bulk_log_details_B1009": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "2975a8d4-8d76-4818-b78e-6d8a4d597e72"
                                },
                                "type": "OpenApiConnection",
                                "inputs": {
                                  "host": {
                                    "connectionName": "shared_commondataserviceforapps_1",
                                    "operationId": "CreateRecord",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                  },
                                  "parameters": {
                                    "entityName": "cid_bulkactivitylogsdetailses",
                                    "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                    "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1009')[0]['Eng-Message']",
                                    "item/cid_errorwarningcode": "B1009",
                                    "item/cid_excelcolumnname": "Postal Code",
                                    "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                    "item/cid_excelsheetname": "Add Basic Info",
                                    "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                    "item/cid_type": 100000000
                                  },
                                  "authentication": "@parameters('$authentication')"
                                }
                              }
                            },
                            "runAfter": {
                              "Check_province": [
                                "Succeeded"
                              ]
                            },
                            "expression": {
                              "lessOrEquals": [
                                "@length(outputs('current_row')['values'][0][4])",
                                0
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "781d35d3-8a91-434d-92f6-57180284f526"
                            },
                            "type": "If"
                          },
                          "Check_City": {
                            "actions": {
                              "Filter_array_B1029": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "3f29ab51-bf71-47bb-a55a-6a2948100237"
                                },
                                "type": "Query",
                                "inputs": {
                                  "from": "@variables('Messages_Array')",
                                  "where": "@equals(item()['code'], 'B1029')"
                                }
                              },
                              "Append_to_array_variable_error_Postal_code_missing_2": {
                                "runAfter": {
                                  "Set_variable_Error_Message_City": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "35bde0e4-44ee-43ee-a978-b15ef18f851b"
                                },
                                "type": "AppendToArrayVariable",
                                "inputs": {
                                  "name": "Error_List",
                                  "value": {
                                    "SheetName": "Add Basic Info",
                                    "Row#": "@{outputs('Current_Row_number')}",
                                    "Site": "@{outputs('Current_Site_Address')}",
                                    "Error": "@{variables('Error_Message')}"
                                  }
                                }
                              },
                              "Set_variable_Error_Message_City": {
                                "runAfter": {
                                  "Filter_array_B1029": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "1c699dd5-f727-43e8-98d7-ee042d5c3ae6"
                                },
                                "type": "SetVariable",
                                "inputs": {
                                  "name": "Error_Message",
                                  "value": "@{body('Filter_array_B1029')[0]['Message']}"
                                }
                              },
                              "Add_Bulk_Log_details_B1029": {
                                "runAfter": {
                                  "Append_to_array_variable_error_Postal_code_missing_2": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "2975a8d4-8d76-4818-b78e-6d8a4d597e72"
                                },
                                "type": "OpenApiConnection",
                                "inputs": {
                                  "host": {
                                    "connectionName": "shared_commondataserviceforapps_1",
                                    "operationId": "CreateRecord",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                  },
                                  "parameters": {
                                    "entityName": "cid_bulkactivitylogsdetailses",
                                    "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                    "item/cid_errordetails": "@variables('Error_Message')",
                                    "item/cid_errorwarningcode": "B1029",
                                    "item/cid_excelcolumnname": "Postal Code",
                                    "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                    "item/cid_excelsheetname": "Add Basic Info",
                                    "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                    "item/cid_type": 100000000
                                  },
                                  "authentication": "@parameters('$authentication')"
                                }
                              }
                            },
                            "runAfter": {
                              "Check_PostalCode": [
                                "Succeeded"
                              ]
                            },
                            "expression": {
                              "lessOrEquals": [
                                "@length(outputs('current_row')['values'][0][2])",
                                0
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "781d35d3-8a91-434d-92f6-57180284f526"
                            },
                            "type": "If"
                          }
                        },
                        "runAfter": {},
                        "else": {
                          "actions": {
                            "Check_if_Missing_Legal_Land_description": {
                              "actions": {
                                "Check_section": {
                                  "actions": {
                                    "Filter_array_B1015": {
                                      "runAfter": {},
                                      "metadata": {
                                        "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                      },
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@variables('Messages_Array')",
                                        "where": "@equals(item()['code'], 'B1015')"
                                      }
                                    },
                                    "Append_to_array_variable_4_Errorlist_3": {
                                      "runAfter": {
                                        "Set_variable_Error_Message_2": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                      },
                                      "type": "AppendToArrayVariable",
                                      "inputs": {
                                        "name": "Error_List",
                                        "value": {
                                          "SheetName": "Add Basic Info",
                                          "Row#": "@{outputs('Current_Row_number')}",
                                          "Site": "@{outputs('Current_Site_Address')}",
                                          "Error": "@{variables('Error_Message')}"
                                        }
                                      }
                                    },
                                    "Set_variable_Error_Message_2": {
                                      "runAfter": {
                                        "Filter_array_B1015": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                      },
                                      "type": "SetVariable",
                                      "inputs": {
                                        "name": "Error_Message",
                                        "value": "@{body('Filter_array_B1015')[0]['Message']}"
                                      }
                                    },
                                    "Filter_Messages_to_log_in_bulk_log_details_B1015": {
                                      "runAfter": {
                                        "Append_to_array_variable_4_Errorlist_3": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "fe2dd070-afaa-4b12-b4fe-f9c9f795184f"
                                      },
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@body('Parse_Messages_to_JSON')",
                                        "where": "@equals(item()['code'], 'B1015')"
                                      }
                                    },
                                    "Add_Bulk_Log_details_B1015": {
                                      "runAfter": {
                                        "Filter_Messages_to_log_in_bulk_log_details_B1015": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "b54fee31-33a5-45b9-bf79-2014ffad6776"
                                      },
                                      "type": "OpenApiConnection",
                                      "inputs": {
                                        "host": {
                                          "connectionName": "shared_commondataserviceforapps_1",
                                          "operationId": "CreateRecord",
                                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                          "entityName": "cid_bulkactivitylogsdetailses",
                                          "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                          "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1015')[0]['Eng-Message']",
                                          "item/cid_errorwarningcode": "B1015",
                                          "item/cid_excelcolumnname": "Section",
                                          "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                          "item/cid_excelsheetname": "Add Basic Info",
                                          "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                          "item/cid_type": 100000000
                                        },
                                        "authentication": "@parameters('$authentication')"
                                      }
                                    }
                                  },
                                  "runAfter": {},
                                  "expression": {
                                    "lessOrEquals": [
                                      "@length(outputs('current_row')['values'][0][9])",
                                      0
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                                  },
                                  "type": "If"
                                },
                                "Check_TownShip": {
                                  "actions": {
                                    "Filter_array_B1016": {
                                      "runAfter": {},
                                      "metadata": {
                                        "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                      },
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@variables('Messages_Array')",
                                        "where": "@equals(item()['code'], 'B1016')"
                                      }
                                    },
                                    "Append_to_array_variable_4_Errorlist_4": {
                                      "runAfter": {
                                        "Set_variable_Error_Message_3": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                      },
                                      "type": "AppendToArrayVariable",
                                      "inputs": {
                                        "name": "Error_List",
                                        "value": {
                                          "SheetName": "Add Basic Info",
                                          "Row#": "@{outputs('Current_Row_number')}",
                                          "Site": "@{outputs('Current_Site_Address')}",
                                          "Error": "@{variables('Error_Message')}"
                                        }
                                      }
                                    },
                                    "Set_variable_Error_Message_3": {
                                      "runAfter": {
                                        "Filter_array_B1016": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                      },
                                      "type": "SetVariable",
                                      "inputs": {
                                        "name": "Error_Message",
                                        "value": "@{body('Filter_array_B1016')[0]['Message']}"
                                      }
                                    },
                                    "Filter_Messages_to_log_in_bulk_log_details_B1016": {
                                      "runAfter": {
                                        "Append_to_array_variable_4_Errorlist_4": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "7b170bd0-0ff4-4d36-ad8f-3b0a1dab84af"
                                      },
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@body('Parse_Messages_to_JSON')",
                                        "where": "@equals(item()['code'], 'Bulk012')"
                                      }
                                    },
                                    "Add_Bulk_Log_details_B1016": {
                                      "runAfter": {
                                        "Filter_Messages_to_log_in_bulk_log_details_B1016": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "e5be8d2d-7ebb-4d4a-81a0-a845b30523f1"
                                      },
                                      "type": "OpenApiConnection",
                                      "inputs": {
                                        "host": {
                                          "connectionName": "shared_commondataserviceforapps_1",
                                          "operationId": "CreateRecord",
                                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                          "entityName": "cid_bulkactivitylogsdetailses",
                                          "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                          "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1016')[0]['Eng-Message']",
                                          "item/cid_errorwarningcode": "B1016",
                                          "item/cid_excelcolumnname": "Township",
                                          "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                          "item/cid_excelsheetname": "Add Basic Info",
                                          "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                          "item/cid_type": 100000000
                                        },
                                        "authentication": "@parameters('$authentication')"
                                      }
                                    }
                                  },
                                  "runAfter": {
                                    "Check_section": [
                                      "Succeeded"
                                    ]
                                  },
                                  "expression": {
                                    "lessOrEquals": [
                                      "@length(outputs('current_row')['values'][0][10])",
                                      0
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                                  },
                                  "type": "If"
                                },
                                "Check_Range": {
                                  "actions": {
                                    "Filter_array_B1017": {
                                      "runAfter": {},
                                      "metadata": {
                                        "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                      },
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@variables('Messages_Array')",
                                        "where": "@equals(item()['code'], 'B1017')"
                                      }
                                    },
                                    "Append_to_array_variable_4_Errorlist_5": {
                                      "runAfter": {
                                        "Set_variable_Error_Message_4": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                      },
                                      "type": "AppendToArrayVariable",
                                      "inputs": {
                                        "name": "Error_List",
                                        "value": {
                                          "SheetName": "Add Basic Info",
                                          "Row#": "@{outputs('Current_Row_number')}",
                                          "Site": "@{outputs('Current_Site_Address')}",
                                          "Error": "@{variables('Error_Message')}"
                                        }
                                      }
                                    },
                                    "Set_variable_Error_Message_4": {
                                      "runAfter": {
                                        "Filter_array_B1017": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                      },
                                      "type": "SetVariable",
                                      "inputs": {
                                        "name": "Error_Message",
                                        "value": "@{body('Filter_array_B1017')[0]['Message']}"
                                      }
                                    },
                                    "Filter_Messages_to_log_in_bulk_log_details_B1017": {
                                      "runAfter": {
                                        "Append_to_array_variable_4_Errorlist_5": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "d99d7787-edfb-4878-aff6-3c52ff11aa06"
                                      },
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@body('Parse_Messages_to_JSON')",
                                        "where": "@equals(item()['code'], 'B1017')"
                                      }
                                    },
                                    "Add_Bulk_Log_details_B1017": {
                                      "runAfter": {
                                        "Filter_Messages_to_log_in_bulk_log_details_B1017": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "e2b2b8a7-82cc-4b92-a48f-c1692a32610b"
                                      },
                                      "type": "OpenApiConnection",
                                      "inputs": {
                                        "host": {
                                          "connectionName": "shared_commondataserviceforapps_1",
                                          "operationId": "CreateRecord",
                                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                          "entityName": "cid_bulkactivitylogsdetailses",
                                          "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                          "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1017')[0]['Eng-Message']",
                                          "item/cid_errorwarningcode": "B1017",
                                          "item/cid_excelcolumnname": "Range",
                                          "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                          "item/cid_excelsheetname": "Add Basic Info",
                                          "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                          "item/cid_type": 100000000
                                        },
                                        "authentication": "@parameters('$authentication')"
                                      }
                                    }
                                  },
                                  "runAfter": {
                                    "Check_TownShip": [
                                      "Succeeded"
                                    ]
                                  },
                                  "expression": {
                                    "lessOrEquals": [
                                      "@length(outputs('current_row')['values'][0][11])",
                                      0
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                                  },
                                  "type": "If"
                                },
                                "Check_Meridian": {
                                  "actions": {
                                    "Filter_array_B1018": {
                                      "runAfter": {},
                                      "metadata": {
                                        "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                      },
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@variables('Messages_Array')",
                                        "where": "@equals(item()['code'], 'B1018')"
                                      }
                                    },
                                    "Append_to_array_variable_4_Errorlist_6": {
                                      "runAfter": {
                                        "Set_variable_Error_Message_5": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                      },
                                      "type": "AppendToArrayVariable",
                                      "inputs": {
                                        "name": "Error_List",
                                        "value": {
                                          "SheetName": "Add Basic Info",
                                          "Row#": "@{outputs('Current_Row_number')}",
                                          "Site": "@{outputs('Current_Site_Address')}",
                                          "Error": "@{variables('Error_Message')}"
                                        }
                                      }
                                    },
                                    "Set_variable_Error_Message_5": {
                                      "runAfter": {
                                        "Filter_array_B1018": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                      },
                                      "type": "SetVariable",
                                      "inputs": {
                                        "name": "Error_Message",
                                        "value": "@{body('Filter_array_B1018')[0]['Message']}"
                                      }
                                    },
                                    "Filter_Messages_to_log_in_bulk_log_details_B1018": {
                                      "runAfter": {
                                        "Append_to_array_variable_4_Errorlist_6": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "304a49df-cd00-4266-bcd1-0ade7b0728ff"
                                      },
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@body('Parse_Messages_to_JSON')",
                                        "where": "@equals(item()['code'], 'B1018')"
                                      }
                                    },
                                    "Add_Bulk_Log_details_B1018": {
                                      "runAfter": {
                                        "Filter_Messages_to_log_in_bulk_log_details_B1018": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "0e77b235-1a2c-406e-929a-e9749c90e44c"
                                      },
                                      "type": "OpenApiConnection",
                                      "inputs": {
                                        "host": {
                                          "connectionName": "shared_commondataserviceforapps_1",
                                          "operationId": "CreateRecord",
                                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                          "entityName": "cid_bulkactivitylogsdetailses",
                                          "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                          "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1018')[0]['Eng-Message']",
                                          "item/cid_errorwarningcode": "B1018",
                                          "item/cid_excelcolumnname": "Meridian",
                                          "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                          "item/cid_excelsheetname": "Add Basic Info",
                                          "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                          "item/cid_type": 100000000
                                        },
                                        "authentication": "@parameters('$authentication')"
                                      }
                                    }
                                  },
                                  "runAfter": {
                                    "Check_Range": [
                                      "Succeeded"
                                    ]
                                  },
                                  "expression": {
                                    "lessOrEquals": [
                                      "@length(outputs('current_row')['values'][0][12])",
                                      0
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                                  },
                                  "type": "If"
                                }
                              },
                              "runAfter": {},
                              "else": {
                                "actions": {
                                  "Check_if_Missing_Lat_and_Long_1C_address": {
                                    "actions": {
                                      "Check_Latitude": {
                                        "actions": {
                                          "Filter_array_B1020": {
                                            "runAfter": {},
                                            "metadata": {
                                              "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                            },
                                            "type": "Query",
                                            "inputs": {
                                              "from": "@variables('Messages_Array')",
                                              "where": "@equals(item()['code'], 'Bulk016')"
                                            }
                                          },
                                          "Append_to_array_variable_4_Errorlist_7": {
                                            "runAfter": {
                                              "Set_variable_Error_Message_6": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                              "name": "Error_List",
                                              "value": {
                                                "SheetName": "Add Basic Info",
                                                "Row#": "@{outputs('Current_Row_number')}",
                                                "Site": "@{outputs('Current_Site_Address')}",
                                                "Error": "@{variables('Error_Message')}"
                                              }
                                            }
                                          },
                                          "Set_variable_Error_Message_6": {
                                            "runAfter": {
                                              "Filter_array_B1020": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                              "name": "Error_Message",
                                              "value": "@{body('Filter_array_B1020')[0]['Message']}"
                                            }
                                          },
                                          "Filter_Messages_to_log_in_bulk_log_details_B1020": {
                                            "runAfter": {
                                              "Append_to_array_variable_4_Errorlist_7": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "322f87e9-71bf-4108-aeb9-e87f3dfd7dd8"
                                            },
                                            "type": "Query",
                                            "inputs": {
                                              "from": "@body('Parse_Messages_to_JSON')",
                                              "where": "@equals(item()['code'], 'B1020')"
                                            }
                                          },
                                          "Add_Bulk_Log_details_B1020": {
                                            "runAfter": {
                                              "Filter_Messages_to_log_in_bulk_log_details_B1020": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "8d221767-ff8f-4d7a-90c7-8b3284c6d76a"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                              "host": {
                                                "connectionName": "shared_commondataserviceforapps_1",
                                                "operationId": "CreateRecord",
                                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                              },
                                              "parameters": {
                                                "entityName": "cid_bulkactivitylogsdetailses",
                                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                                "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1020')[0]['Eng-Message']",
                                                "item/cid_errorwarningcode": "B1020",
                                                "item/cid_excelcolumnname": "Latitude",
                                                "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                                "item/cid_excelsheetname": "Add Basic Info",
                                                "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                                "item/cid_type": 100000000
                                              },
                                              "authentication": "@parameters('$authentication')"
                                            }
                                          }
                                        },
                                        "runAfter": {},
                                        "expression": {
                                          "lessOrEquals": [
                                            "@length(outputs('current_row')['values'][0][13])",
                                            0
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                                        },
                                        "type": "If"
                                      },
                                      "Check_Longitude": {
                                        "actions": {
                                          "Filter_array_B1021": {
                                            "runAfter": {},
                                            "metadata": {
                                              "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                            },
                                            "type": "Query",
                                            "inputs": {
                                              "from": "@variables('Messages_Array')",
                                              "where": "@equals(item()['code'], 'B1021')"
                                            }
                                          },
                                          "Append_to_array_variable_4_Errorlist_8": {
                                            "runAfter": {
                                              "Set_variable_Error_Message_7": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                              "name": "Error_List",
                                              "value": {
                                                "SheetName": "Add Basic Info",
                                                "Row#": "@{outputs('Current_Row_number')}",
                                                "Site": "@{outputs('Current_Site_Address')}",
                                                "Error": "@{variables('Error_Message')}"
                                              }
                                            }
                                          },
                                          "Set_variable_Error_Message_7": {
                                            "runAfter": {
                                              "Filter_array_B1021": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                              "name": "Error_Message",
                                              "value": "@{body('Filter_array_B1021')[0]['Message']}"
                                            }
                                          },
                                          "Filter_Messages_to_log_in_bulk_log_details_B1021": {
                                            "runAfter": {
                                              "Append_to_array_variable_4_Errorlist_8": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "63457463-77bd-4d80-b3f2-d8e61ee01398"
                                            },
                                            "type": "Query",
                                            "inputs": {
                                              "from": "@body('Parse_Messages_to_JSON')",
                                              "where": "@equals(item()['code'], 'B1021')"
                                            }
                                          },
                                          "Add_Bulk_Log_details_Longitude": {
                                            "runAfter": {
                                              "Filter_Messages_to_log_in_bulk_log_details_B1021": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "26a6204e-8cb3-417f-ab0e-14dad7a3067a"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                              "host": {
                                                "connectionName": "shared_commondataserviceforapps_1",
                                                "operationId": "CreateRecord",
                                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                              },
                                              "parameters": {
                                                "entityName": "cid_bulkactivitylogsdetailses",
                                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                                "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1021')[0]['Eng-Message']",
                                                "item/cid_errorwarningcode": "B1021",
                                                "item/cid_excelcolumnname": "Longtitude",
                                                "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                                "item/cid_excelsheetname": "Add Basic Info",
                                                "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                                "item/cid_type": 100000000
                                              },
                                              "authentication": "@parameters('$authentication')"
                                            }
                                          }
                                        },
                                        "runAfter": {
                                          "Check_Latitude": [
                                            "Succeeded"
                                          ]
                                        },
                                        "expression": {
                                          "lessOrEquals": [
                                            "@length(outputs('current_row')['values'][0][14])",
                                            0
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                                        },
                                        "type": "If"
                                      }
                                    },
                                    "runAfter": {},
                                    "expression": {
                                      "or": [
                                        {
                                          "greater": [
                                            "@length(string(outputs('current_row')['values'][0][13]))",
                                            0
                                          ]
                                        },
                                        {
                                          "greater": [
                                            "@length(string(outputs('current_row')['values'][0][14]))",
                                            0
                                          ]
                                        }
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "74bae040-97ca-4985-9ad3-540d32283954"
                                    },
                                    "type": "If"
                                  }
                                }
                              },
                              "expression": {
                                "or": [
                                  {
                                    "greater": [
                                      "@length(string(outputs('current_row')['values'][0][9]))",
                                      0
                                    ]
                                  },
                                  {
                                    "greater": [
                                      "@length(string(outputs('current_row')['values'][0][10]))",
                                      0
                                    ]
                                  },
                                  {
                                    "greater": [
                                      "@length(string(outputs('current_row')['values'][0][11]))",
                                      0
                                    ]
                                  },
                                  {
                                    "greater": [
                                      "@length(string(outputs('current_row')['values'][0][12]))",
                                      0
                                    ]
                                  }
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "74bae040-97ca-4985-9ad3-540d32283954"
                              },
                              "type": "If"
                            }
                          }
                        },
                        "expression": {
                          "or": [
                            {
                              "or": [
                                {
                                  "greater": [
                                    "@length(outputs('current_row')['values'][0][1])",
                                    0
                                  ]
                                },
                                {
                                  "greater": [
                                    "@length(outputs('current_row')['values'][0][2])",
                                    0
                                  ]
                                },
                                {
                                  "greater": [
                                    "@length(outputs('current_row')['values'][0][3])",
                                    0
                                  ]
                                },
                                {
                                  "greater": [
                                    "@length(outputs('current_row')['values'][0][4])",
                                    0
                                  ]
                                },
                                {
                                  "not": {
                                    "equals": [
                                      "@outputs('current_row')['values'][0][23]",
                                      "@null"
                                    ]
                                  }
                                }
                              ]
                            }
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "74bae040-97ca-4985-9ad3-540d32283954"
                        },
                        "type": "If"
                      }
                    }
                  },
                  "expression": {
                    "or": [
                      {
                        "and": [
                          {
                            "greater": [
                              "@length(outputs('current_row')['values'][0][1])",
                              0
                            ]
                          },
                          {
                            "greater": [
                              "@length(outputs('current_row')['values'][0][2])",
                              0
                            ]
                          },
                          {
                            "greater": [
                              "@length(outputs('current_row')['values'][0][3])",
                              0
                            ]
                          },
                          {
                            "greater": [
                              "@length(outputs('current_row')['values'][0][4])",
                              0
                            ]
                          },
                          {
                            "not": {
                              "equals": [
                                "@outputs('current_row')['values'][0][23]",
                                "@null"
                              ]
                            }
                          }
                        ]
                      },
                      {
                        "and": [
                          {
                            "greater": [
                              "@length(string(outputs('current_row')['values'][0][9]))",
                              0
                            ]
                          },
                          {
                            "greater": [
                              "@length(string(outputs('current_row')['values'][0][10]))",
                              0
                            ]
                          },
                          {
                            "greater": [
                              "@length(string(outputs('current_row')['values'][0][11]))",
                              0
                            ]
                          },
                          {
                            "greater": [
                              "@length(string(outputs('current_row')['values'][0][12]))",
                              0
                            ]
                          }
                        ]
                      },
                      {
                        "and": [
                          {
                            "greater": [
                              "@length(string(outputs('current_row')['values'][0][13]))",
                              0
                            ]
                          },
                          {
                            "greater": [
                              "@length( string(outputs('current_row')['values'][0][14]))",
                              0
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "74bae040-97ca-4985-9ad3-540d32283954"
                  },
                  "type": "If"
                },
                "Class_Check_Logic": {
                  "actions": {
                    "Class_Field_Length": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "83a95fc0-dcc2-41e7-a5e1-312025c479b4"
                      },
                      "type": "Compose",
                      "inputs": "@length(Trim(outputs('current_row')['values'][0][23]))"
                    },
                    "Check_Class_Length": {
                      "actions": {
                        "Split_classes": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "e0dca524-c854-4512-87a5-c52c0631f446"
                          },
                          "type": "Compose",
                          "inputs": "@split(outputs('current_row')['values'][0][23], ',')"
                        },
                        "Loop_in_Classes": {
                          "foreach": "@outputs('Split_classes')",
                          "actions": {
                            "Current_Class_-_Add_site_sheet": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "cd482863-072d-464f-9106-d280ae25998e"
                              },
                              "type": "Compose",
                              "inputs": "@items('Loop_in_Classes')"
                            },
                            "Filter_array-Class-insert-sheet": {
                              "runAfter": {
                                "Current_Class_-_Add_site_sheet": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "22054bd7-c034-4375-845f-d7750e34a672"
                              },
                              "type": "Query",
                              "inputs": {
                                "from": "@outputs('List_Classes')?['body/value']",
                                "where": "@equals(item()?['value'], trim(outputs('Current_Class_-_Add_site_sheet')))"
                              }
                            },
                            "Check_if_class_doesn't_exists_in_database": {
                              "actions": {
                                "Set_variable_Error_free_to_false_for_Class_check": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "6854c04f-327e-4ed5-b17e-f8a85946dc59"
                                  },
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "IsErrorFree",
                                    "value": "@false"
                                  }
                                },
                                "Append_to_array_variable_2": {
                                  "runAfter": {
                                    "Set_variable_Error_Message_10": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "e32a0cd3-5a79-4e05-a40b-2b6a328f57fa"
                                  },
                                  "type": "AppendToArrayVariable",
                                  "inputs": {
                                    "name": "Error_List",
                                    "value": {
                                      "SheetName": "Add Basic Info",
                                      "Row#": "@{outputs('Current_Row_number')}",
                                      "Site": "@{outputs('Current_Site_Address')}",
                                      "Error": "@{variables('Error_Message')}"
                                    }
                                  }
                                },
                                "Filter_array_B1025": {
                                  "runAfter": {
                                    "Set_variable_Error_free_to_false_for_Class_check": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                  },
                                  "type": "Query",
                                  "inputs": {
                                    "from": "@variables('Messages_Array')",
                                    "where": "@equals(item()['code'], 'B1025')"
                                  }
                                },
                                "Set_variable_Error_Message_10": {
                                  "runAfter": {
                                    "Filter_array_B1025": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                  },
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Error_Message",
                                    "value": "@{Replace(body('Filter_array_B1025')[0]['Message'],'{0}' , outputs('Current_Class_-_Add_site_sheet'))}"
                                  }
                                },
                                "Add_Bulk_Log_details_B1025": {
                                  "runAfter": {
                                    "Append_to_array_variable_2": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "31afab0a-9b91-40ca-ae1a-3cd7c9aeccb2"
                                  },
                                  "type": "OpenApiConnection",
                                  "inputs": {
                                    "host": {
                                      "connectionName": "shared_commondataserviceforapps_1",
                                      "operationId": "CreateRecord",
                                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                    },
                                    "parameters": {
                                      "entityName": "cid_bulkactivitylogsdetailses",
                                      "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                      "item/cid_errordetails": "@variables('Error_Message')",
                                      "item/cid_errorwarningcode": "B1025",
                                      "item/cid_excelcolumnname": "Class",
                                      "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                      "item/cid_excelsheetname": "Add Basic Info",
                                      "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                      "item/cid_type": 100000000
                                    },
                                    "authentication": "@parameters('$authentication')"
                                  }
                                }
                              },
                              "runAfter": {
                                "Filter_array-Class-insert-sheet": [
                                  "Succeeded"
                                ]
                              },
                              "expression": {
                                "equals": [
                                  "@length(body('Filter_array-Class-insert-sheet'))",
                                  0
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "9ed023a3-88d2-4445-9ac0-28b90c20853c"
                              },
                              "type": "If"
                            }
                          },
                          "runAfter": {
                            "Split_classes": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "20f34ebd-ca6a-4dab-83f7-fe482fd75ed5"
                          },
                          "type": "Foreach"
                        }
                      },
                      "runAfter": {
                        "Class_Field_Length": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Set_variable_isErrorFree_false": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "b7b2bd46-8af9-49a7-9d4d-94935a8a52cb"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "IsErrorFree",
                              "value": "@false"
                            }
                          },
                          "Filter_array_B1024": {
                            "runAfter": {
                              "Set_variable_isErrorFree_false": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@variables('Messages_Array')",
                              "where": "@equals(item()['code'], 'B1024')"
                            }
                          },
                          "Set_variable_Error_Message_9": {
                            "runAfter": {
                              "Filter_array_B1024": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "Error_Message",
                              "value": "@{body('Filter_array_B1024')[0]['Message']}"
                            }
                          },
                          "Append_to_array_variable": {
                            "runAfter": {
                              "Set_variable_Error_Message_9": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "3c6a8e4a-648b-4317-b99e-f2cb63f87df5"
                            },
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "Error_List",
                              "value": {
                                "SheetName": "Add Basic Info",
                                "Row#": "@{outputs('Current_Row_number')}",
                                "Site": "@{outputs('Current_Site_Address')}",
                                "Error": "@{variables('Error_Message')}"
                              }
                            }
                          },
                          "Add_Bulk_Log_details_Bulk005_2": {
                            "runAfter": {
                              "Append_to_array_variable": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "6400dadc-a966-4c90-a510-2232709a5494"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps_1",
                                "operationId": "CreateRecord",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "cid_bulkactivitylogsdetailses",
                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                "item/cid_errordetails": "@variables('Error_Message')",
                                "item/cid_errorwarningcode": "B1024",
                                "item/cid_excelcolumnname": "Class",
                                "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                "item/cid_excelsheetname": "Add Basic Info",
                                "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                "item/cid_type": 100000000
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          }
                        }
                      },
                      "expression": {
                        "greater": [
                          "@outputs('Class_Field_Length')",
                          0
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "bbe454f7-3873-41a1-82a7-595eb52d9ba4"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {
                    "Check_if_all_required_address_information_is_entered": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "535fc6fd-165b-4dcb-b9c3-e2af382e3a6f"
                  },
                  "type": "Scope"
                },
                "Mode_of_Transportation_Logic": {
                  "actions": {
                    "Check_if_at_least_one_mode_exists": {
                      "actions": {},
                      "runAfter": {},
                      "else": {
                        "actions": {
                          "Set_variable_IsErrorFree_to_false_for_mode_errors": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "e9edbab6-4b56-410c-842e-a982a3055db1"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "IsErrorFree",
                              "value": "@false"
                            }
                          },
                          "Append_to_array_variable_-_modes_error": {
                            "runAfter": {
                              "Set_variable_Error_Message_B1023": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "d1d67445-b348-4caa-83df-ac7c8e361e9a"
                            },
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "Error_List",
                              "value": {
                                "SheetName": "Add Basic Info",
                                "Row#": "@{outputs('Current_Row_number')}",
                                "Site": "@{outputs('Current_Site_Address')}",
                                "Error": "@{variables('Error_Message')}"
                              }
                            }
                          },
                          "Filter_array_B1023": {
                            "runAfter": {
                              "Set_variable_IsErrorFree_to_false_for_mode_errors": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@variables('Messages_Array')",
                              "where": "@equals(item()['code'], 'B1023')"
                            }
                          },
                          "Set_variable_Error_Message_B1023": {
                            "runAfter": {
                              "Filter_array_B1023": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "Error_Message",
                              "value": "@{body('Filter_array_B1023')[0]['Message']}"
                            }
                          },
                          "Add_Bulk_Log_details_Bulk019": {
                            "runAfter": {
                              "Append_to_array_variable_-_modes_error": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "0c1b58a4-09cf-4bca-b3a2-1f3988851215"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps_1",
                                "operationId": "CreateRecord",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "cid_bulkactivitylogsdetailses",
                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                "item/cid_errordetails": "@variables('Error_Message')",
                                "item/cid_errorwarningcode": "B1023",
                                "item/cid_excelcolumnname": "Mode of Transportation",
                                "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                "item/cid_excelsheetname": "Add Basic Info",
                                "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                "item/cid_type": 100000000
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          }
                        }
                      },
                      "expression": {
                        "or": [
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][15]",
                              "Yes"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][16]",
                              "Yes"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][17]",
                              "Yes"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][18]",
                              "Yes"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][15]",
                              "oui"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][16]",
                              "oui"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][17]",
                              "oui"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][18]",
                              "oui"
                            ]
                          }
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "d7a96b62-a00a-407a-b778-10a161f45109"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {
                    "Class_Check_Logic": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "0a977c2b-2929-4abe-88a5-96f8d33788c9"
                  },
                  "type": "Scope"
                },
                "Check_HOTI_activities": {
                  "actions": {
                    "Check_if_at_least_one_HOT_IT_activity_is_selected": {
                      "actions": {},
                      "runAfter": {},
                      "else": {
                        "actions": {
                          "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_2": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "eeda5e90-d330-4124-9c56-2029e3095b38"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "IsErrorFree",
                              "value": "@false"
                            }
                          },
                          "Append_to_array_HOTI_activity_error_": {
                            "runAfter": {
                              "Set_variable_Error_Message_B1027": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "5156ed84-5eb7-4e4c-877b-da09e286f3f8"
                            },
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "Error_List",
                              "value": {
                                "SheetName": "Add Basic Info",
                                "Row#": "@{outputs('Current_Row_number')}",
                                "Site": "@{outputs('Current_Site_Address')}",
                                "Error": "@{variables('Error_Message')}"
                              }
                            }
                          },
                          "Filter_array_B1027": {
                            "runAfter": {
                              "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_2": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@variables('Messages_Array')",
                              "where": "@equals(item()['code'], 'B1027')"
                            }
                          },
                          "Set_variable_Error_Message_B1027": {
                            "runAfter": {
                              "Filter_array_B1027": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "Error_Message",
                              "value": "@{body('Filter_array_B1027')[0]['Message']}"
                            }
                          },
                          "Add_Bulk_Log_details_B1027": {
                            "runAfter": {
                              "Append_to_array_HOTI_activity_error_": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "6e1bfa11-2ebb-42d9-8b27-288724513534"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps_1",
                                "operationId": "CreateRecord",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "cid_bulkactivitylogsdetailses",
                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                "item/cid_errordetails": "@variables('Error_Message')",
                                "item/cid_errorwarningcode": "B1027",
                                "item/cid_excelcolumnname": "HOT IT Activities",
                                "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                "item/cid_excelsheetname": "Add Basic Info",
                                "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                "item/cid_type": 100000000
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          }
                        }
                      },
                      "expression": {
                        "or": [
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][19]",
                              "Yes"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][20]",
                              "Yes"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][21]",
                              "Yes"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][22]",
                              "Yes"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][19]",
                              "oui"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][20]",
                              "oui"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][21]",
                              "oui"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['values'][0][22]",
                              "oui"
                            ]
                          }
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "2ab90895-e7b6-4898-85c4-992378e704ac"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {
                    "Mode_of_Transportation_Logic": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "1a6fe45b-fc97-4bcd-a416-c44ce3a96775"
                  },
                  "type": "Scope"
                },
                "check_if_Extended_information_is_specified": {
                  "actions": {
                    "Check_if_Extended_information_specified": {
                      "actions": {
                        "check_if_at_least_one_UN_number_added_to_extended_info": {
                          "actions": {
                            "Check_if_site_exists_in_extended_table": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "3c730080-51de-459b-8861-551d06758084"
                              },
                              "type": "Query",
                              "inputs": {
                                "from": "@body('Filter_table_-_Get_None_empty_cells_Extended_Table')",
                                "where": "@and (equals(item()['values'][0][0], outputs('current_row')['values'][0][26]) ,  greater(length(item()['values'][0][1]), 0) )"
                              }
                            },
                            "Check_if_at_least_one_Unnumber_exists_for_extended_site": {
                              "actions": {
                                "Apply_to_each_-_extended_rows_for_current_site": {
                                  "foreach": "@body('Check_if_site_exists_in_extended_table')",
                                  "actions": {
                                    "Current_extended_row": {
                                      "runAfter": {},
                                      "metadata": {
                                        "operationMetadataId": "f25b0fe8-d1fd-40d0-b1bd-c5d88646f631"
                                      },
                                      "type": "Compose",
                                      "inputs": "@items('Apply_to_each_-_extended_rows_for_current_site')"
                                    },
                                    "Annual__Volume-Quantity": {
                                      "runAfter": {
                                        "Site": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "0d5a29eb-dfea-4fd2-8580-ff502eb17755"
                                      },
                                      "type": "Compose",
                                      "inputs": "@outputs('Current_extended_row')['values'][0][2]"
                                    },
                                    "Unit_of_Measure": {
                                      "runAfter": {
                                        "RowNumber": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "63ea7799-fd21-4413-a3c4-87b64d5c3658"
                                      },
                                      "type": "Compose",
                                      "inputs": "@outputs('Current_extended_row')['values'][0][3]"
                                    },
                                    "Annual_number_of__Consignments": {
                                      "runAfter": {
                                        "Unit_of_Measure": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "ef42a387-8f12-40a2-945b-39841bc0a9a7"
                                      },
                                      "type": "Compose",
                                      "inputs": "@outputs('Current_extended_row')['values'][0][4]"
                                    },
                                    "Check_quantity": {
                                      "actions": {},
                                      "runAfter": {
                                        "Annual_number_of__Consignments": [
                                          "Succeeded"
                                        ]
                                      },
                                      "else": {
                                        "actions": {
                                          "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors": {
                                            "runAfter": {},
                                            "metadata": {
                                              "operationMetadataId": "eeda5e90-d330-4124-9c56-2029e3095b38"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                              "name": "IsErrorFree",
                                              "value": "@false"
                                            }
                                          },
                                          "Append_to_array_HOTI_activity_error__2": {
                                            "runAfter": {
                                              "Set_variable_Error_Message_13": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "d1467057-f7f9-4f6e-83a1-2860398aefee"
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                              "name": "Error_List",
                                              "value": {
                                                "SheetName": "Add Extended Info",
                                                "Row#": "@{outputs('RowNumber')}",
                                                "Site": "@{outputs('Site')}",
                                                "Error": "@{variables('Error_Message')}"
                                              }
                                            }
                                          },
                                          "Filter_array_B1030": {
                                            "runAfter": {
                                              "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                            },
                                            "type": "Query",
                                            "inputs": {
                                              "from": "@variables('Messages_Array')",
                                              "where": "@equals(item()['code'], 'B1030')"
                                            }
                                          },
                                          "Add_Bulk_Log_details_B1030": {
                                            "runAfter": {
                                              "Append_to_array_HOTI_activity_error__2": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "31afab0a-9b91-40ca-ae1a-3cd7c9aeccb2"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                              "host": {
                                                "connectionName": "shared_commondataserviceforapps_1",
                                                "operationId": "CreateRecord",
                                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                              },
                                              "parameters": {
                                                "entityName": "cid_bulkactivitylogsdetailses",
                                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                                "item/cid_errordetails": "@variables('Error_Message')",
                                                "item/cid_errorwarningcode": "B1030",
                                                "item/cid_excelcolumnname": "Quantity/Volume",
                                                "item/cid_excelrownumber": "@outputs('RowNumber')",
                                                "item/cid_excelsheetname": "Add Extended Info",
                                                "item/cid_sitelocation": "@outputs('Site')",
                                                "item/cid_type": 100000000
                                              },
                                              "authentication": "@parameters('$authentication')"
                                            }
                                          },
                                          "Set_variable_Error_Message_13": {
                                            "runAfter": {
                                              "Filter_array_B1030": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                              "name": "Error_Message",
                                              "value": "@{body('Filter_array_B1030')[0]['Message']}"
                                            }
                                          }
                                        }
                                      },
                                      "expression": {
                                        "greater": [
                                          "@length(string(outputs('Annual__Volume-Quantity')))",
                                          0
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "2ab90895-e7b6-4898-85c4-992378e704ac"
                                      },
                                      "type": "If"
                                    },
                                    "Check_Unit_of_measure": {
                                      "actions": {},
                                      "runAfter": {
                                        "Check_quantity": [
                                          "Succeeded"
                                        ]
                                      },
                                      "else": {
                                        "actions": {
                                          "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_3": {
                                            "runAfter": {},
                                            "metadata": {
                                              "operationMetadataId": "eeda5e90-d330-4124-9c56-2029e3095b38"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                              "name": "IsErrorFree",
                                              "value": "@false"
                                            }
                                          },
                                          "Append_to_array_HOTI_activity_error__5": {
                                            "runAfter": {
                                              "Set_variable_Error_Message_14": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "d1467057-f7f9-4f6e-83a1-2860398aefee"
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                              "name": "Error_List",
                                              "value": {
                                                "SheetName": "Add Extended Info",
                                                "Row#": "@{outputs('RowNumber')}",
                                                "Site": "@{outputs('Site')}",
                                                "Error": "@{variables('Error_Message')}"
                                              }
                                            }
                                          },
                                          "Filter_array_B1031": {
                                            "runAfter": {
                                              "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_3": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                            },
                                            "type": "Query",
                                            "inputs": {
                                              "from": "@variables('Messages_Array')",
                                              "where": "@equals(item()['code'], 'B1031')"
                                            }
                                          },
                                          "Add_Bulk_Log_details_B1031": {
                                            "runAfter": {
                                              "Append_to_array_HOTI_activity_error__5": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "31afab0a-9b91-40ca-ae1a-3cd7c9aeccb2"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                              "host": {
                                                "connectionName": "shared_commondataserviceforapps_1",
                                                "operationId": "CreateRecord",
                                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                              },
                                              "parameters": {
                                                "entityName": "cid_bulkactivitylogsdetailses",
                                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                                "item/cid_errordetails": "@variables('Error_Message')",
                                                "item/cid_errorwarningcode": "B1031",
                                                "item/cid_excelcolumnname": "Unit of Measure Per UN #",
                                                "item/cid_excelrownumber": "@outputs('RowNumber')",
                                                "item/cid_excelsheetname": "Add Extended Info",
                                                "item/cid_sitelocation": "@outputs('Site')",
                                                "item/cid_type": 100000000
                                              },
                                              "authentication": "@parameters('$authentication')"
                                            }
                                          },
                                          "Set_variable_Error_Message_14": {
                                            "runAfter": {
                                              "Filter_array_B1031": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                              "name": "Error_Message",
                                              "value": "@{body('Filter_array_B1031')[0]['Message']}"
                                            }
                                          }
                                        }
                                      },
                                      "expression": {
                                        "greater": [
                                          "@length(string(outputs('Unit_of_Measure')))",
                                          0
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "2ab90895-e7b6-4898-85c4-992378e704ac"
                                      },
                                      "type": "If"
                                    },
                                    "Check_Annual_number_of__Consignments": {
                                      "actions": {},
                                      "runAfter": {
                                        "Check_Unit_of_measure": [
                                          "Succeeded"
                                        ]
                                      },
                                      "else": {
                                        "actions": {
                                          "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_4": {
                                            "runAfter": {},
                                            "metadata": {
                                              "operationMetadataId": "eeda5e90-d330-4124-9c56-2029e3095b38"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                              "name": "IsErrorFree",
                                              "value": "@false"
                                            }
                                          },
                                          "Append_to_array_HOTI_activity_error__3": {
                                            "runAfter": {
                                              "Set_variable_Error_Message_15": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "d1467057-f7f9-4f6e-83a1-2860398aefee"
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                              "name": "Error_List",
                                              "value": {
                                                "SheetName": "Add Extended Info",
                                                "Row#": "@{outputs('RowNumber')}",
                                                "Site": "@{outputs('Site')}",
                                                "Error": "@{variables('Error_Message')}"
                                              }
                                            }
                                          },
                                          "Filter_array_B1032": {
                                            "runAfter": {
                                              "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_4": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                            },
                                            "type": "Query",
                                            "inputs": {
                                              "from": "@variables('Messages_Array')",
                                              "where": "@equals(item()['code'], 'B1032')"
                                            }
                                          },
                                          "Set_variable_Error_Message_15": {
                                            "runAfter": {
                                              "Filter_array_B1032": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                              "name": "Error_Message",
                                              "value": "@{body('Filter_array_B1032')[0]['Message']}"
                                            }
                                          },
                                          "Add_Bulk_Log_details_B1032": {
                                            "runAfter": {
                                              "Append_to_array_HOTI_activity_error__3": [
                                                "Succeeded"
                                              ]
                                            },
                                            "metadata": {
                                              "operationMetadataId": "31afab0a-9b91-40ca-ae1a-3cd7c9aeccb2"
                                            },
                                            "type": "OpenApiConnection",
                                            "inputs": {
                                              "host": {
                                                "connectionName": "shared_commondataserviceforapps_1",
                                                "operationId": "CreateRecord",
                                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                              },
                                              "parameters": {
                                                "entityName": "cid_bulkactivitylogsdetailses",
                                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                                "item/cid_errordetails": "@variables('Error_Message')",
                                                "item/cid_errorwarningcode": "B1032",
                                                "item/cid_excelcolumnname": "Annual # of Consignments ",
                                                "item/cid_excelrownumber": "@outputs('RowNumber')",
                                                "item/cid_excelsheetname": "Add Extended Info",
                                                "item/cid_sitelocation": "@outputs('Site')",
                                                "item/cid_type": 100000000
                                              },
                                              "authentication": "@parameters('$authentication')"
                                            }
                                          }
                                        }
                                      },
                                      "expression": {
                                        "greater": [
                                          "@length(string(outputs('Annual_number_of__Consignments')))",
                                          0
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "2ab90895-e7b6-4898-85c4-992378e704ac"
                                      },
                                      "type": "If"
                                    },
                                    "RowNumber": {
                                      "runAfter": {
                                        "Annual__Volume-Quantity": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "1d7f7640-ce2c-4ad9-9b47-270993d7b4f6"
                                      },
                                      "type": "Compose",
                                      "inputs": "@add( int(outputs('Current_extended_row')['Index']), 5)"
                                    },
                                    "Site": {
                                      "runAfter": {
                                        "Current_extended_row": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "61796b69-662d-48b5-9067-a5cee179fe74"
                                      },
                                      "type": "Compose",
                                      "inputs": "@outputs('Current_extended_row')['values'][0][0]"
                                    }
                                  },
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "b585958a-b648-4adc-83e3-6e8e27fc16d6"
                                  },
                                  "type": "Foreach"
                                }
                              },
                              "runAfter": {
                                "Check_if_site_exists_in_extended_table": [
                                  "Succeeded"
                                ]
                              },
                              "else": {
                                "actions": {
                                  "Set_variable_IsErrorFree_to_false_for_Missing_at_least_one_extended_UN_number": {
                                    "runAfter": {},
                                    "metadata": {
                                      "operationMetadataId": "eeda5e90-d330-4124-9c56-2029e3095b38"
                                    },
                                    "type": "SetVariable",
                                    "inputs": {
                                      "name": "IsErrorFree",
                                      "value": "@false"
                                    }
                                  },
                                  "Append_to_array_-_At_least_one_UN_number_for_extended_site": {
                                    "runAfter": {
                                      "Set_variable_Error_Message_12": [
                                        "Succeeded"
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "9b195654-ca8f-4757-886a-d4617627de53"
                                    },
                                    "type": "AppendToArrayVariable",
                                    "inputs": {
                                      "name": "Error_List",
                                      "value": {
                                        "SheetName": "Add Basic Info",
                                        "Row#": "@{outputs('Current_Row_number')}",
                                        "Site": "@{outputs('Current_Site_Address')}",
                                        "Error": "@{variables('Error_Message')}"
                                      }
                                    }
                                  },
                                  "Filter_array_B1028": {
                                    "runAfter": {
                                      "Set_variable_IsErrorFree_to_false_for_Missing_at_least_one_extended_UN_number": [
                                        "Succeeded"
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                    },
                                    "type": "Query",
                                    "inputs": {
                                      "from": "@variables('Messages_Array')",
                                      "where": "@equals(item()['code'], 'B1028')"
                                    }
                                  },
                                  "Set_variable_Error_Message_12": {
                                    "runAfter": {
                                      "Filter_array_B1028": [
                                        "Succeeded"
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                    },
                                    "type": "SetVariable",
                                    "inputs": {
                                      "name": "Error_Message",
                                      "value": "@{body('Filter_array_B1028')[0]['Message']}"
                                    }
                                  },
                                  "Add_Bulk_Log_details_B1028": {
                                    "runAfter": {
                                      "Append_to_array_-_At_least_one_UN_number_for_extended_site": [
                                        "Succeeded"
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "3a815e5b-d3d6-46a0-b695-e2fea7723193"
                                    },
                                    "type": "OpenApiConnection",
                                    "inputs": {
                                      "host": {
                                        "connectionName": "shared_commondataserviceforapps_1",
                                        "operationId": "CreateRecord",
                                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                      },
                                      "parameters": {
                                        "entityName": "cid_bulkactivitylogsdetailses",
                                        "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                        "item/cid_errordetails": "@variables('Error_Message')",
                                        "item/cid_errorwarningcode": "B1028",
                                        "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                        "item/cid_excelsheetname": "Add Basic Info",
                                        "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                        "item/cid_type": 100000000
                                      },
                                      "authentication": "@parameters('$authentication')"
                                    }
                                  }
                                }
                              },
                              "expression": {
                                "greater": [
                                  "@length(body('Check_if_site_exists_in_extended_table'))",
                                  0
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "2ab90895-e7b6-4898-85c4-992378e704ac"
                              },
                              "type": "If"
                            }
                          },
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "532bec31-07e5-4e56-88ba-48f3c1a8f96f"
                          },
                          "type": "Scope"
                        }
                      },
                      "runAfter": {},
                      "else": {
                        "actions": {
                          "Set_variable_IsErrorFree_to_false_for_extended_info_column": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "aae50206-625b-41ca-9a89-423723eb8ce8"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "IsErrorFree",
                              "value": "@false"
                            }
                          },
                          "Append_to_array_variable_-_Extended_column_empty": {
                            "runAfter": {
                              "Set_variable_Error_Message_11": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "4f55e617-31bd-44ed-bb0a-b526c97f332f"
                            },
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "Error_List",
                              "value": {
                                "SheetName": "Add Basic Info",
                                "Row#": "@{outputs('Current_Row_number')}",
                                "Site": "@{outputs('Current_Site_Address')}",
                                "Error": "@{variables('Error_Message')}"
                              }
                            }
                          },
                          "Filter_array_B1026": {
                            "runAfter": {
                              "Set_variable_IsErrorFree_to_false_for_extended_info_column": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@variables('Messages_Array')",
                              "where": "@equals(item()['code'], 'B1026')"
                            }
                          },
                          "Set_variable_Error_Message_11": {
                            "runAfter": {
                              "Filter_array_B1026": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "Error_Message",
                              "value": "@{body('Filter_array_B1026')[0]['Message']}"
                            }
                          },
                          "Add_Bulk_Log_details_Bulk024": {
                            "runAfter": {
                              "Append_to_array_variable_-_Extended_column_empty": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "8af86261-ffd1-4944-9f70-3fca7af3b639"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps_1",
                                "operationId": "CreateRecord",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "cid_bulkactivitylogsdetailses",
                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                "item/cid_errordetails": "@variables('Error_Message')",
                                "item/cid_errorwarningcode": "B1026",
                                "item/cid_excelcolumnname": "Extended Site?",
                                "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                "item/cid_excelsheetname": "Add Basic Info",
                                "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                "item/cid_type": 100000000
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          }
                        }
                      },
                      "expression": {
                        "greater": [
                          "@length(outputs('current_row')['values'][0][24])",
                          0
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "d57040f2-d836-43ba-82ee-4dabea0b72c7"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {
                    "Check_HOTI_activities": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "d6e81ca0-f205-43e3-a52f-8b3fa2b64ca8"
                  },
                  "type": "Scope"
                },
                "Current_Row_number": {
                  "runAfter": {
                    "Current_row": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "c8231cfb-e9e8-482c-bdc3-da88465785e4"
                  },
                  "type": "Compose",
                  "inputs": "@add( int(outputs('current_row')['values'][0][25]) ,5) "
                },
                "Current_Site_Address": {
                  "runAfter": {
                    "Current_Row_number": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "d07cd0a9-7e62-4379-be92-c323f2fba582"
                  },
                  "type": "Compose",
                  "inputs": "@outputs('current_row')['values'][0][26]"
                }
              },
              "runAfter": {
                "Filter_table_-_get_none_empty_cells_sites_for_insert_": [
                  "Succeeded"
                ],
                "Filter_table_-_Get_None_empty_cells_Extended_Table": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a13dfb1a-1128-4977-9f3a-295db5d71229"
              },
              "type": "Foreach"
            },
            "Filter_table_-_Get_None_empty_cells_Extended_Table": {
              "runAfter": {
                "Invoke_an_HTTP_request_Get_Extended_info_table": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "1f1c482b-be72-4cb9-8ef4-90104b2c6119"
              },
              "type": "Query",
              "inputs": {
                "from": "@outputs('Invoke_an_HTTP_request_Get_Extended_info_table')?['body']['value']",
                "where": "@and(greater(length(item()['values'][0][0]), 0) , greater(length(item()['values'][0][1]), 0))"
              }
            }
          },
          "runAfter": {
            "Get-File-Relative-Path": [
              "Succeeded"
            ]
          },
          "expression": {
            "and": [
              {
                "greater": [
                  "@length(outputs('SharePoint-file-path'))",
                  0
                ]
              },
              {
                "greater": [
                  "@outputs('activity-Type')",
                  0
                ]
              }
            ]
          },
          "metadata": {
            "operationMetadataId": "de2e31fb-b088-4d31-b562-a086b54ce650"
          },
          "type": "If"
        },
        "SharePoint-file-path": {
          "runAfter": {
            "Error_flag": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "813f258f-a88e-4327-a661-56a540b24c1e"
          },
          "type": "Compose",
          "inputs": "@triggerOutputs()?['body/cid_tempsharepointfilelocation']"
        },
        "activity-Type": {
          "runAfter": {
            "SharePoint-file-path": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "a2836a02-5322-4e7d-9199-a011455095fb"
          },
          "type": "Compose",
          "inputs": "@triggerOutputs()?['body/cid_activitytype']"
        },
        "Activity_End_time": {
          "runAfter": {
            "activity-Type": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "12e7d949-e095-404c-8616-7984518928ea"
          },
          "type": "Compose",
          "inputs": "@triggerOutputs()?['body/cid_activityendtime']"
        },
        "CompanyId": {
          "runAfter": {
            "Activity_End_time": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "489ef8ab-ca6a-4f9a-b46e-76621eeb2231"
          },
          "type": "Compose",
          "inputs": "@triggerOutputs()?['body/_cid_company_value']"
        },
        "Initialize_Environment_folder_variable": {
          "runAfter": {
            "Filter_environment-CID_Flow_Environment_Folder": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "fc5c3dd6-8d62-49cb-befd-838a6faaacca"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Environment_Folder",
                "type": "string",
                "value": "@{body('Filter_environment-CID_Flow_Environment_Folder')[0]['qm_value']}"
              }
            ]
          }
        },
        "Row_Number_vailable": {
          "runAfter": {
            "Initialize_Environment_folder_variable": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "396871f6-9db7-4572-ac20-9b39cc12d51a"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "RowNumber",
                "type": "integer",
                "value": 3
              }
            ]
          }
        },
        "Error_List_Variable": {
          "runAfter": {
            "Row_Number_vailable": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "a10a3b39-9550-46b6-b00c-75dd826be0a2"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Error_List",
                "type": "array",
                "value": [
                  {
                    "SheetName": "",
                    "Row#": "",
                    "Site": "",
                    "Error": ""
                  }
                ]
              }
            ]
          }
        },
        "Initialize_ProvinceCodes_variable": {
          "runAfter": {
            "Error_List_Variable": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "74815300-3912-4a4c-ad7f-1cfdca4d3ce9"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "ProvinceCodes",
                "type": "object",
                "value": {
                  "NL": "10",
                  "PE": "11",
                  "NS": "12",
                  "NB": "13",
                  "QC": "24",
                  "ON": "35",
                  "MB": "46",
                  "SK": "47",
                  "AB": "48",
                  "BC": "59",
                  "YU": "60",
                  "NT": "61",
                  "NU": "62",
                  "UF": "72",
                  "IW": "73"
                }
              }
            ]
          }
        },
        "Error_flag": {
          "runAfter": {
            "Initialize_ProvinceCodes_variable": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "af9c01db-59f3-46fa-826e-e24fc2c82cca"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "IsErrorFree",
                "type": "boolean",
                "value": "@true"
              }
            ]
          }
        },
        "Get-File-Relative-Path": {
          "runAfter": {
            "CompanyId": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "62a55140-16b9-46c5-8165-dbd9d75253d9"
          },
          "type": "Compose",
          "inputs": "@substring(outputs('SharePoint-file-path'), indexOf(outputs('SharePoint-file-path'),'CID_Bulk_Upload'))"
        },
        "check_error_flag": {
          "actions": {
            "Run_Bulk_Insert_Flow": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "1646db8d-85fe-43d1-b9b3-e0c2ec13f78f"
              },
              "type": "Workflow",
              "inputs": {
                "host": {
                  "workflowReferenceName": "9ac0f16f-415d-ec11-8f8e-000d3a845870"
                },
                "body": {
                  "text": "@triggerOutputs()?['body/_cid_company_value']",
                  "text_1": "@triggerOutputs()?['body/cid_tempsharepointfilelocation']",
                  "text_2": "@triggerOutputs()?['body/cid_bulkactivitylogsummaryid']"
                }
              }
            }
          },
          "runAfter": {
            "Check_if_Validation_should_start_on_the_Modified_event": [
              "Succeeded"
            ]
          },
          "else": {
            "actions": {
              "Create_HTML_table": {
                "runAfter": {},
                "metadata": {
                  "operationMetadataId": "3d5b95c3-0259-4f2b-a767-b20b99174ec1"
                },
                "type": "Table",
                "inputs": {
                  "from": "@variables('Error_List')",
                  "format": "HTML"
                }
              },
              "html_table_with_style": {
                "runAfter": {
                  "Create_HTML_table": [
                    "Succeeded"
                  ]
                },
                "metadata": {
                  "operationMetadataId": "920beb59-130c-4895-ab0c-490a0d32e827"
                },
                "type": "Compose",
                "inputs": "<style>\ntable {\n  border: 1px solid #1C6EA4;\n  background-color: #EEEEEE;\n  width: 100%;\n  text-align: left;\n  border-collapse: collapse;\n}\ntable td, table th {\n  border: 1px solid #AAAAAA;\n  padding: 3px 2px;\n}\ntable tbody td {\n  font-size: 13px;\n}\ntable thead {\n  background: #1C6EA4;\n  border-bottom: 2px solid #444444;\n}\ntable thead th {\n  font-size: 15px;\n  font-weight: bold;\n  color: #FFFFFF;\n  border-left: 2px solid #D0E4F5;\n}\ntable thead th:first-child {\n  border-left: none;\n}\n</style>\n@{body('Create_HTML_table')}"
              },
              "Send_an_email_notification_(V3)": {
                "runAfter": {
                  "Update_Bulk_activity_log_summary": [
                    "Succeeded"
                  ]
                },
                "metadata": {
                  "operationMetadataId": "94e1b98e-5051-4132-b512-028ad4bd7d96"
                },
                "type": "OpenApiConnection",
                "inputs": {
                  "host": {
                    "connectionName": "shared_sendmail",
                    "operationId": "SendEmailV3",
                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_sendmail"
                  },
                  "parameters": {
                    "request/to": "@{outputs('get_contact_email')?['body/emailaddress1']};",
                    "request/subject": "workbook was not successfully uploaded",
                    "request/text": "<p>Hello @{outputs('get_contact_email')?['body/firstname']},<br>\n<br>\nworkbook for @{outputs('get_contact_email')?['body/_parentcustomerid_value']} was not successfully uploaded, Please address the following errors first and try the upload again.<br>\n<br>\n@{outputs('html_table_with_style')}<br>\n</p>"
                  },
                  "authentication": "@parameters('$authentication')"
                }
              },
              "Update_Bulk_activity_log_summary": {
                "runAfter": {
                  "html_table_with_style": [
                    "Succeeded"
                  ]
                },
                "metadata": {
                  "operationMetadataId": "b9fd40b4-ad5c-476a-a72c-c9247d363b8a"
                },
                "type": "OpenApiConnection",
                "inputs": {
                  "host": {
                    "connectionName": "shared_commondataserviceforapps_1",
                    "operationId": "UpdateRecord",
                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                  },
                  "parameters": {
                    "entityName": "cid_bulkactivitylogsummaries",
                    "recordId": "@triggerOutputs()?['body/cid_bulkactivitylogsummaryid']",
                    "item/cid_activityendtime": "@utcNow()",
                    "item/cid_activitystatus": 100000001
                  },
                  "authentication": "@parameters('$authentication')"
                }
              }
            }
          },
          "expression": {
            "equals": [
              "@variables('IsErrorFree')",
              "@true"
            ]
          },
          "metadata": {
            "operationMetadataId": "65069879-0150-4e08-9d1e-e04210460358"
          },
          "type": "If"
        },
        "get_contact_email": {
          "runAfter": {
            "Get_bulk_activities_log_summary_by_ID": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "3aa29ee7-04a6-41ba-ab07-924c6b990d05"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "GetItem",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "contacts",
              "recordId": "@triggerOutputs()?['body/_cid_actionedby_value']"
            },
            "authentication": "@parameters('$authentication')"
          }
        },
        "get-environment-settings": {
          "runAfter": {
            "get_contact_email": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "7ed63b1d-9cf8-403e-9d9c-56cdd03f198e"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps",
              "operationId": "ListRecords",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "qm_environmentsettingses",
              "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n<entity name=\"qm_environmentsettings\">\n<attribute name=\"qm_environmentsettingsid\"/>\n<attribute name=\"qm_name\"/>\n<attribute name=\"qm_value\"/>\n<order attribute=\"qm_name\" descending=\"false\"/>\n<filter type=\"and\">\n<condition attribute=\"qm_name\" operator=\"like\" value=\"%CID[_]%\"/>\n</filter>\n</entity>\n</fetch>"
            },
            "authentication": "@parameters('$authentication')"
          }
        },
        "Filter_environment-CID_Flow_Environment_Folder": {
          "runAfter": {
            "Scope_-_Language_logic_for_Messages": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "0e744065-88c2-4338-956b-7400a9256a6e"
          },
          "type": "Query",
          "inputs": {
            "from": "@outputs('get-environment-settings')?['body/value']",
            "where": "@equals(item()?['qm_name'], 'CID_Flow_Environment_Folder')"
          }
        },
        "Scope_-_Language_logic_for_Messages": {
          "actions": {
            "Messaages": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "04d08f07-7aa1-43e4-8da5-adb1e21d7258"
              },
              "type": "Compose",
              "inputs": "[\n{\"code\" : \"B1001\" , \"Eng-Message\" : \"A scan of the file has found a potential virus. Please download and update a new version of the Site Bulk Upload Excel Template, then upload that file instead. [B1001]\", \"Fr-Message\" :  \"Une analyse du fichier a trouvé un virus potentiel. Veuillez télécharger et mettre à jour une nouvelle version du modèle Excel de téléchargement groupé du site, puis téléchargez ce fichier à la place.[B1001]\" } ,\n{\"code\" : \"B1002\" , \"Eng-Message\" : \"The uploaded file is not the custom Site Bulk Upload Excel workbook. Please download and update a new version of the Site Bulk Upload Excel Template, then upload that file instead. [B1002] \", \"Fr-Message\" :  \"Le fichier téléchargé n'est pas le classeur Excel personnalisé de téléchargement en masse du site. Veuillez télécharger et mettre à jour une nouvelle version du modèle Excel de téléchargement groupé du site, puis téléchargez ce fichier à la place.[B1002] \" } ,\n{\"code\" : \"B1003\" , \"Eng-Message\" : \"The uploaded file is assigned to the ‘{0}’ Company, versus your own Company. Please download and update a new version of the Site Bulk Upload Excel Template, then upload that file instead. [B1003] \n\n{0} is the name of Company Name stored in a hidden field in the workbook \", \"Fr-Message\" :  \"Le fichier téléchargé est attribué à la société {0}, par opposition à votre propre société. Veuillez télécharger et mettre à jour une nouvelle version du modèle Excel de téléchargement groupé du site, puis téléchargez ce fichier à la place. [B1003]\n\n{0} est le nom du nom de la société stocké dans un champ masqué du classeur\" } ,\n{\"code\" : \"B1004\" , \"Eng-Message\" : \"The uploaded file is based on a template that is no longer current. Please download and update a new version of the Site Bulk Upload Excel Template, then upload that file instead. [B1004] \", \"Fr-Message\" :  \"Le fichier téléchargé est basé sur un modèle qui n'est plus actuel. Veuillez télécharger et mettre à jour une nouvelle version du modèle Excel de téléchargement groupé du site, puis téléchargez ce fichier à la place. [B1004]\" } ,\n{\"code\" : \"B1005\" , \"Eng-Message\" : \"The uploaded file is empty. Please update the file with the Basic, and if required Extended, Site information, Guidance for the data entry can be found in the [Instructions] sheet of the workbook.  \n\nWhen that process is complete, then upload that version of the file. [B1005]\", \"Fr-Message\" :  \"Le fichier téléchargé est vide. Veuillez mettre à jour le fichier avec les informations de base et, si nécessaire, les informations étendues sur le site. Des conseils pour la saisie des données peuvent être trouvés dans la feuille [Instructions] du classeur.\n\nUne fois ce processus terminé, téléchargez cette version du fichier. [B1005]\" } ,\n{\"code\" : \"B1006\" , \"Eng-Message\" : \"This workbook contains {0} rows of Site data and {1} rows of UN data for those sites. This exceeds the acceptable limits for the bulk upload of {2} rows for Site data and {3} rows for UN data.  \n\nThe [Instructions] tab within the workbook provides guidance as to what data needs to be provided. If need be, you may consider splitting the file into two Bulk files, each under the limits, and two Bulk submissions. [B1006] \", \"Fr-Message\" :  \"Ce classeur contient {0} lignes de données de site et {1} lignes de données UN pour ces sites. Cela dépasse les limites acceptables pour le téléchargement groupé de {2} lignes pour les données de site et de {3} lignes pour les données de l'ONU.[B1006]\" } ,\n{\"code\" : \"B1007\" , \"Eng-Message\" : \"There are already {0} rows of Site data and {1} rows of UN data for those sites on file for this Company, so no further uploads can continue. [B1007]\", \"Fr-Message\" :  \"\nIl existe déjà {0} lignes de données de site et {1} lignes de données de l'ONU pour ces sites dans le dossier de cette entreprise. Aucun autre téléchargement ne peut donc continuer. [B1007]\" } ,\n{\"code\" : \"B1008\" , \"Eng-Message\" : \"Missing required field: Province. [B1008]\", \"Fr-Message\" :  \"Champ obligatoire manquant : Province. [B1008]\" } ,\n{\"code\" : \"B1009\" , \"Eng-Message\" : \"Missing required field: Postal Code. [B1009]\", \"Fr-Message\" :  \"Champ obligatoire manquant : Code postal. [B1009]\" } ,\n{\"code\" : \"B1010\" , \"Eng-Message\" : \"Missing required field:Address 1. [B1010]\", \"Fr-Message\" :  \"Champ obligatoire manquant :Adresse 1. [B1010]\" } ,\n{\"code\" : \"B1011\" , \"Eng-Message\" : \"Address already exist. [B1011]\", \"Fr-Message\" :  \"\nL'adresse existe déjà pour l'entreprise par. [B1011]\" } ,\n{\"code\" : \"B1012\" , \"Eng-Message\" : \"City name is not correct. [B1012]\", \"Fr-Message\" :  \"Le nom de la ville n'est pas correct. [B1012]\" } ,\n{\"code\" : \"B1013\" , \"Eng-Message\" : \"City doesn't belong to Province. [B1013]\", \"Fr-Message\" :  \"\nLa ville n'appartient pas à la province. [B1013]\" } ,\n{\"code\" : \"B1014\" , \"Eng-Message\" : \"Missing required field:1B. Quarter / LSD. [B1014]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1B. Trimestre / LSD. [B1014]\" } ,\n{\"code\" : \"B1015\" , \"Eng-Message\" : \"Missing required field:1B. Section. [B1015]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1B. Section. [B1015]\" } ,\n{\"code\" : \"B1016\" , \"Eng-Message\" : \"Missing required field:1B. Township. [B1016]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1B. Canton. [B1016]\" } ,\n{\"code\" : \"B1017\" , \"Eng-Message\" : \"Missing required field:1B. Range. [B1017]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1B. Varier. [B1017]\" } ,\n{\"code\" : \"B1018\" , \"Eng-Message\" : \"Missing required field:1B. Meridian. [B1018]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1B. Méridien. [B1018]\" } ,\n{\"code\" : \"B1019\" , \"Eng-Message\" : \"Legal Land description already exists. [B1019]\", \"Fr-Message\" :  \"\nLa description légale du terrain existe déjà. [B1019]\" } ,\n{\"code\" : \"B1020\" , \"Eng-Message\" : \"Missing required field: 1C. Latitude. [B1020]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1C. Latitude. [B1020]\" } ,\n{\"code\" : \"B1021\" , \"Eng-Message\" : \"Missing required field: 1C. Longtitude. [B1021]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1C. Longitude. [B1021]\" } ,\n{\"code\" : \"B1022\" , \"Eng-Message\" : \"Latitude and Longtitude alerady exists for the company. [B1022]\", \"Fr-Message\" :  \"\nLa latitude et la longitude existent déjà pour l'entreprise. [B1022]\" } ,\n{\"code\" : \"B1023\" , \"Eng-Message\" : \"At least one mode of transportation Need to be selected. [B1023]\", \"Fr-Message\" :  \"Au moins un mode de transport Doit être sélectionné. [B1023]\" } ,\n{\"code\" : \"B1024\" , \"Eng-Message\" : \"At least one Class need to be added. [B1024]\", \"Fr-Message\" :  \"Au moins une classe doit être ajoutée. [B1024]\" } ,\n{\"code\" : \"B1025\" , \"Eng-Message\" : \"Incorrect class. [B1025]\", \"Fr-Message\" :  \"Classe incorrecte. [B1025]\" } ,\n{\"code\" : \"B1026\" , \"Eng-Message\" : \"Extended Site information in not specified. [B1026]\", \"Fr-Message\" :  \"\nLes informations étendues sur le site ne sont pas spécifiées. [B1026]\" } ,\n{\"code\" : \"B1027\" , \"Eng-Message\" : \"Site must have at least one HOTI activities. [B1027]\", \"Fr-Message\" :  \"Le site doit avoir au moins une activité HOTI. [B1027]\" } ,\n{\"code\" : \"B1028\" , \"Eng-Message\" : \"Extednded site must have at Least  on UNNumber Need to be specified. [B1028]\", \"Fr-Message\" :  \"Le site étendu doit avoir au moins un numéro UN Doit être spécifié. [B1028]\" } ,\n{\"code\" : \"B1029\" , \"Eng-Message\" : \"Missing required field: City. [B1029]\", \"Fr-Message\" :  \"Champ obligatoire manquant : Ville. [B1029]\" } ,\n{\"code\" : \"B1030\" , \"Eng-Message\" : \"Missing Annual Quantity/Volume. [B1030]\", \"Fr-Message\" :  \"Quantité/Volume annuel manquant. [B1030]\" } ,\n{\"code\" : \"B1031\" , \"Eng-Message\" : \"Missing Unit of measurement. [B1031]\", \"Fr-Message\" :  \"Unité de mesure manquante. [B1031]\" } ,\n{\"code\" : \"B1032\" , \"Eng-Message\" : \"Missing Annual # of  Consignments. [B1032]\", \"Fr-Message\" :  \"Nombre annuel manquant d'envois. [B1032]\" } ,\n{\"code\" : \"B1033\" , \"Eng-Message\" : \"Site belong to another company. Please go through cliaming process. [B1033]\", \"Fr-Message\" :  \"Le site appartient à une autre société. Veuillez passer par le processus de réclamation. [B1033]\" } ,\n{\"code\" : \"B1034\" , \"Eng-Message\" : \"Once site address is established it cannot be changed.[B1034]\", \"Fr-Message\" :  \"Une fois l'adresse du site établie, elle ne peut plus être modifiée.[B1034]\" } \n\n]"
            },
            "Parse_Messages_to_JSON": {
              "runAfter": {
                "Messaages": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "c7167db6-5d1d-4c49-8959-e8ed51425a00"
              },
              "type": "ParseJson",
              "inputs": {
                "content": "@outputs('Messaages')",
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "code": {
                        "type": "string"
                      },
                      "Eng-Message": {
                        "type": "string"
                      },
                      "Fr-Message": {
                        "type": "string"
                      }
                    },
                    "required": [
                      "code",
                      "Eng-Message",
                      "Fr-Message"
                    ]
                  }
                }
              }
            },
            "Check_Language": {
              "actions": {
                "Select_-_English_Language": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "2f87aa54-460c-45c4-a069-00ea3dbd7bf2"
                  },
                  "type": "Select",
                  "inputs": {
                    "from": "@body('Parse_Messages_to_JSON')",
                    "select": {
                      "code": "@item()['code']",
                      "Message": "@item()['Eng-Message']"
                    }
                  }
                },
                "Apply_to_each_English_Message": {
                  "foreach": "@body('Select_-_English_Language')",
                  "actions": {
                    "Append_to_array_variable_3": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "e34d2bba-d320-4f5a-9b95-0e2454bf437e"
                      },
                      "type": "AppendToArrayVariable",
                      "inputs": {
                        "name": "Messages_Array",
                        "value": "@items('Apply_to_each_English_Message')"
                      }
                    }
                  },
                  "runAfter": {
                    "Select_-_English_Language": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "21b64a4a-96fd-4540-b578-86cee5235ab6"
                  },
                  "type": "Foreach"
                }
              },
              "runAfter": {
                "Parse_Messages_to_JSON": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "Select_-_French_Language": {
                    "runAfter": {},
                    "metadata": {
                      "operationMetadataId": "7e1b1002-0ea0-4737-81cd-7a7ddee851b1"
                    },
                    "type": "Select",
                    "inputs": {
                      "from": "@body('Parse_Messages_to_JSON')",
                      "select": {
                        "code": "@item()['code']",
                        "Message": "@item()['Fr-Message']"
                      }
                    }
                  },
                  "for_each_French_message": {
                    "foreach": "@body('Select_-_French_Language')",
                    "actions": {
                      "Append_to_array_variable_French_Message": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "6ca892ec-2f00-4e9c-9c07-db6a700f96df"
                        },
                        "type": "AppendToArrayVariable",
                        "inputs": {
                          "name": "Messages_Array",
                          "value": "@items('for_each_French_message')"
                        }
                      }
                    },
                    "runAfter": {
                      "Select_-_French_Language": [
                        "Succeeded"
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "1b147b98-4f69-4ed0-a0b3-3d01bf011e07"
                    },
                    "type": "Foreach"
                  }
                }
              },
              "expression": {
                "equals": [
                  "@outputs('Get_bulk_activities_log_summary_by_ID')?['body/cid_language@OData.Community.Display.V1.FormattedValue']",
                  "English"
                ]
              },
              "metadata": {
                "operationMetadataId": "95a1b3cb-7717-4242-95b3-e1d926135492"
              },
              "type": "If"
            }
          },
          "runAfter": {
            "Initialize_Message_Array": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "579a4345-0777-4a5f-8e95-463e308bb3c1"
          },
          "type": "Scope"
        },
        "Initialize_Message_Array": {
          "runAfter": {
            "Initialize_variable_-_Error_Message": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "9c2fcec6-947b-4396-aa5d-63b3262a276f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Messages_Array",
                "type": "array"
              }
            ]
          }
        },
        "Get_bulk_activities_log_summary_by_ID": {
          "runAfter": {},
          "metadata": {
            "operationMetadataId": "ac95dd8f-6edc-4bfd-975a-6c9c22d7f655"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "GetItem",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "cid_bulkactivitylogsummaries",
              "recordId": "@triggerOutputs()?['body/cid_bulkactivitylogsummaryid']"
            },
            "authentication": "@parameters('$authentication')"
          }
        },
        "Initialize_variable_-_Error_Message": {
          "runAfter": {
            "get-environment-settings": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "eb9a8ba4-4adb-48fa-9736-b2febfa6d858"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Error_Message",
                "type": "string"
              }
            ]
          }
        }
      }
    }
  },
  "schemaVersion": "1.0.0.0"
}