{
  "properties": {
    "connectionReferences": {
      "shared_commondataserviceforapps_1": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "tdg_ConnectionReferenceDataverseServicePrinciple"
        },
        "api": {
          "name": "shared_commondataserviceforapps"
        }
      },
      "shared_webcontents": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "cid_sharedwebcontents_efbe7"
        },
        "api": {
          "name": "shared_webcontents"
        }
      },
      "shared_commondataserviceforapps": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "tdg_ConnectionReferenceDataverseServicePrinciple"
        },
        "api": {
          "name": "shared_commondataserviceforapps"
        }
      },
      "shared_sendmail": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "cid_sharedsendmail_883c5"
        },
        "api": {
          "name": "shared_sendmail"
        }
      },
      "shared_sendmail_1": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "cid_sharedsendmail_2ba8f"
        },
        "api": {
          "name": "shared_sendmail"
        }
      }
    },
    "definition": {
      "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
      "contentVersion": "1.0.0.0",
      "parameters": {
        "$connections": {
          "defaultValue": {},
          "type": "Object"
        },
        "$authentication": {
          "defaultValue": {},
          "type": "SecureObject"
        }
      },
      "triggers": {
        "When_a_row_is_added,_modified_or_deleted": {
          "metadata": {
            "operationMetadataId": "fa1037c6-e762-4d2c-ae22-a3c3f9e8df54"
          },
          "type": "OpenApiConnectionWebhook",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "SubscribeWebhookTrigger",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "subscriptionRequest/message": 3,
              "subscriptionRequest/entityname": "cid_bulkactivitylogsummary",
              "subscriptionRequest/scope": 4,
              "subscriptionRequest/filteringattributes": "cid_detailedvalidationstarttime",
              "subscriptionRequest/runas": 3
            },
            "authentication": "@parameters('$authentication')"
          }
        }
      },
      "actions": {
        "Check_if_Validation_should_start_on_the_Modified_event": {
          "actions": {
            "List_rows_UNNumber": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "49f988a5-a4a2-4243-af3f-56831c6264dc"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "tdg_unnumbers",
                  "$select": "tdg_name,tdg_unnumberid,tdg_packinggroupcd"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "List_All_Accounts": {
              "runAfter": {
                "List-rows-division-classes": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "0f914c7e-efed-4c8d-9146-29a295558772"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "accounts",
                  "$select": "address1_city,address1_stateorprovince,address1_line1,address1_postalcode,cid_unitnumber,ovs_lld_quarter,\novs_lld_section,\novs_lld_township,\novs_lld_range,\novs_lld_meridian,\naddress1_latitude,\naddress1_longitude\n",
                  "$filter": "customertypecode eq 948010001 and _parentaccountid_value eq '@{outputs('CompanyId')}'",
                  "$expand": "parentaccountid($select=name,accountid)"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Invoke_an_HTTP_request_Get_Site_Table": {
              "runAfter": {
                "List_All_Accounts": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "59c6048d-c4f6-4e9a-8a0d-1df0e3d03d91"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_webcontents",
                  "operationId": "InvokeHttp",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                },
                "parameters": {
                  "request/method": "GET",
                  "request/url": "https://graph.microsoft.com/v1.0/sites/034gc.sharepoint.com,140da73b-4423-4443-a812-e623d6d857c4,f2a2589e-2eec-4642-9280-443640f88211/lists/ddbec2ce-e3a5-4bf3-b065-23b0d1d0d395/drive/root:/@{outputs('Get-File-Relative-Path')}:/workbook/tables/TableAddBasic/rows",
                  "request/headers": {
                    "accept": "application/json"
                  }
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Filter_table_-_get_none_empty_cells_sites_for_insert_": {
              "runAfter": {
                "Invoke_an_HTTP_request_Get_Site_Table": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "1f1c482b-be72-4cb9-8ef4-90104b2c6119"
              },
              "type": "Query",
              "inputs": {
                "from": "@outputs('Invoke_an_HTTP_request_Get_Site_Table')?['body']['value']",
                "where": "@greater(length(item()['values'][0][int(outputs('SiteFullAddress'))]), 0)"
              }
            },
            "Invoke_an_HTTP_request_Get_Extended_info_table": {
              "runAfter": {
                "List_All_Accounts": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "59c6048d-c4f6-4e9a-8a0d-1df0e3d03d91"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_webcontents",
                  "operationId": "InvokeHttp",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_webcontents"
                },
                "parameters": {
                  "request/method": "GET",
                  "request/url": "https://graph.microsoft.com/v1.0/sites/034gc.sharepoint.com,140da73b-4423-4443-a812-e623d6d857c4,f2a2589e-2eec-4642-9280-443640f88211/lists/ddbec2ce-e3a5-4bf3-b065-23b0d1d0d395/drive/root:/@{outputs('Get-File-Relative-Path')}:/workbook/tables/TableAddExtended/rows",
                  "request/headers": {
                    "accept": "application/json"
                  }
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Filter_table_-_Get_None_empty_cells_Extended_Table": {
              "runAfter": {
                "Invoke_an_HTTP_request_Get_Extended_info_table": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "1f1c482b-be72-4cb9-8ef4-90104b2c6119"
              },
              "type": "Query",
              "inputs": {
                "from": "@outputs('Invoke_an_HTTP_request_Get_Extended_info_table')?['body']['value']",
                "where": "@and(greater(length(item()['values'][0][ int(outputs('ExtendedSite')) ]), 0) , greater(length(item()['values'][0][int(outputs('ExtendedUNNumber'))]), 0))"
              }
            },
            "Select_Site_List": {
              "runAfter": {
                "Filter_table_-_get_none_empty_cells_sites_for_insert_": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "77d59626-6f22-4a0b-8be5-f1f0cb206b3d"
              },
              "type": "Select",
              "inputs": {
                "from": "@body('Filter_table_-_get_none_empty_cells_sites_for_insert_')",
                "select": {
                  "SiteName": "@item()['values'][0][int(outputs('SiteName'))]",
                  "Address1": "@item()['values'][0][int(outputs('Address1'))]",
                  "City": "@item()['values'][0][int(outputs('City'))]",
                  "Province": "@item()['values'][0][int(outputs('Province'))]",
                  "Postalcode": "@item()['values'][0][int(outputs('PostalCode'))]",
                  "Address2": "@item()['values'][0][int(outputs('Address2'))]",
                  "Address3": "@item()['values'][0][int(outputs('Address3'))]",
                  "LLDProvince": "@item()['values'][0][int(outputs('LLDProvince'))]",
                  "Quarter": "@item()['values'][0][int(outputs('Quarter'))]",
                  "Section": "@item()['values'][0][int(outputs('Section'))]",
                  "TownShip": "@item()['values'][0][int(outputs('TownShip'))]",
                  "Range": "@item()['values'][0][int(outputs('Range'))]",
                  "Meridian": "@item()['values'][0][int(outputs('Meridian'))]",
                  "Lat": "@item()['values'][0][int(outputs('Lat'))]",
                  "Long": "@item()['values'][0][int(outputs('Long'))]",
                  "Air": "@item()['values'][0][int(outputs('Air'))]",
                  "Marine": "@item()['values'][0][int(outputs('Marine'))]",
                  "Rail": "@item()['values'][0][int(outputs('Rail'))]",
                  "Road": "@item()['values'][0][int(outputs('Road'))]",
                  "Handle": "@item()['values'][0][int(outputs('Handle'))]",
                  "OfferForTransport": "@item()['values'][0][int(outputs('OfferForTransport'))]",
                  "Transport": "@item()['values'][0][int(outputs('Transport'))]",
                  "Import": "@item()['values'][0][int(outputs('Import'))]",
                  "Class": "@item()['values'][0][int(outputs('Class'))]",
                  "ExtendedYN": "@item()['values'][0][int(outputs('extendedYN'))]",
                  "LineNumber": "@item()['index']",
                  "SiteFullAddress": "@item()['values'][0][int(outputs('SiteFullAddress'))]",
                  "SiteGUID": "@item()['values'][0][int(outputs('SiteGUID'))]"
                }
              }
            },
            "Select_extended_info": {
              "runAfter": {
                "Filter_table_-_Get_None_empty_cells_Extended_Table": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "1dcf797c-658a-41e7-bf42-afd1e950fbfd"
              },
              "type": "Select",
              "inputs": {
                "from": "@body('Filter_table_-_Get_None_empty_cells_Extended_Table')",
                "select": {
                  "ExtendedAction": "@item()['values'][0][int(outputs('ExtendedAction'))]",
                  "ExtendedSite": "@item()['values'][0][int(outputs('ExtendedSite'))]",
                  "ExtendedUNnumber": "@item()['values'][0][int(outputs('ExtendedUNNumber'))]",
                  "Quantity": "@item()['values'][0][int(outputs('ExtendedQuantity'))]",
                  "UnitOfMeasure": "@item()['values'][0][int(outputs('ExtendedUnitOfMeasure'))]",
                  "AnnualNumberOfConsignment": "@item()['values'][0][int(outputs('ExtendedAnnulaConsignment'))]",
                  "ExtendedGUID": "@item()['values'][0][int(outputs('ExtendedGUID'))]",
                  "LinNumber": "@item()['index']"
                }
              }
            },
            "List-rows-division-classes": {
              "runAfter": {
                "List_rows_UNNumber": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a7d3ec09-bede-4093-9912-32bc0c48b914"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "ovs_primaryclasses",
                  "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n<entity name=\"ovs_primaryclass\">\n<attribute name=\"ovs_primaryclassid\"/>\n<attribute name=\"ovs_class\"/>\n<order attribute=\"ovs_class\" descending=\"false\"/>\n<filter type=\"and\">\n<condition attribute=\"statecode\" operator=\"eq\" value=\"0\"/>\n</filter>\n</entity>\n</fetch>"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Perform_an_unbound_action_-_Site_Validation": {
              "runAfter": {
                "Select_extended_info": [
                  "Succeeded"
                ],
                "Select_Site_List": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "e136eead-50e8-4d66-aab4-6eb6647796dc"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "PerformUnboundAction",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "actionName": "cid_BulkSitUploadValidation",
                  "item/ClassList": "@outputs('List-rows-division-classes')?['body']['value']",
                  "item/SiteInfo": "@body('Select_Site_List')",
                  "item/UNList": "@body('Select_extended_info')",
                  "item/ActivityID": "@outputs('Get_bulk_activities_log_summary_by_ID')?['body/cid_bulkactivitylogsummaryid']",
                  "item/ValidationMessages": "@body('Parse_JSON_Messages_From_Web')",
                  "item/Language": "@variables('Language')"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "check_if_error_found_in_validation": {
              "actions": {
                "Set_variable_is_Error_free_to_false": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "7dae3734-a6e0-4f37-878a-87f514904360"
                  },
                  "type": "SetVariable",
                  "inputs": {
                    "name": "IsErrorFree",
                    "value": "@false"
                  }
                },
                "Parse_JSON_Error_List_from_Actions": {
                  "runAfter": {
                    "Set_variable_is_Error_free_to_false": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "0b7ff81b-619c-40fb-ac02-2a5f13d468ff"
                  },
                  "type": "ParseJson",
                  "inputs": {
                    "content": "@outputs('Perform_an_unbound_action_-_Site_Validation')?['body/ErrorList']",
                    "schema": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "SheetName": {
                            "type": "string"
                          },
                          "Row#": {
                            "type": "string"
                          },
                          "ColumnName": {
                            "type": "string"
                          },
                          "Site": {
                            "type": "string"
                          },
                          "Error": {
                            "type": "string"
                          },
                          "ErrorLog": {
                            "type": "string"
                          },
                          "displayOrder": {
                            "type": "string"
                          },
                          "SheetOrder": {
                            "type": "string"
                          },
                          "code": {
                            "type": "string"
                          },
                          "SheetNameInEnglish": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "SheetName",
                          "Row#",
                          "ColumnName",
                          "Site",
                          "Error",
                          "ErrorLog",
                          "displayOrder",
                          "SheetOrder",
                          "code",
                          "SheetNameInEnglish"
                        ]
                      }
                    }
                  }
                },
                "Apply_to_each_Error": {
                  "foreach": "@body('Parse_JSON_Error_List_from_Actions')",
                  "actions": {
                    "Append_to_array_ErrorList_with_Error_from_actions": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "2472c65d-b92c-492e-8bc7-cc889bd53abe"
                      },
                      "type": "AppendToArrayVariable",
                      "inputs": {
                        "name": "Error_List",
                        "value": "@items('Apply_to_each_Error')"
                      }
                    },
                    "Add_a_new_row": {
                      "runAfter": {
                        "Compose": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "d3829c08-4f1d-4303-b5ce-d82600d1d1ff"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps_1",
                          "operationId": "CreateRecord",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "cid_bulkactivitylogsdetailses",
                          "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                          "item/cid_errordetails": "@items('Apply_to_each_Error')['ErrorLog']",
                          "item/cid_errorwarningcode": "@items('Apply_to_each_Error')['code']",
                          "item/cid_excelcolumnname": "@items('Apply_to_each_Error')['ColumnName']",
                          "item/cid_excelrownumber": "@int(items('Apply_to_each_Error')['Row#'])",
                          "item/cid_excelsheetname": "@items('Apply_to_each_Error')['SheetNameInEnglish']",
                          "item/cid_sitelocation": "@items('Apply_to_each_Error')['Site']",
                          "item/statuscode": 1
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    },
                    "Compose": {
                      "runAfter": {
                        "Append_to_array_ErrorList_with_Error_from_actions": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "39ca73b8-1baf-47b3-96ed-830e4347e8e6"
                      },
                      "type": "Compose",
                      "inputs": "@items('Apply_to_each_Error')['SheetNameInEnglish']"
                    }
                  },
                  "runAfter": {
                    "Parse_JSON_Error_List_from_Actions": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "1823d548-fa07-4c5a-b5f8-ab2204de089a"
                  },
                  "type": "Foreach"
                }
              },
              "runAfter": {
                "Perform_an_unbound_action_-_Site_Validation": [
                  "Succeeded"
                ]
              },
              "expression": {
                "equals": [
                  "@outputs('Perform_an_unbound_action_-_Site_Validation')?['body/ErrorFound']",
                  "True"
                ]
              },
              "metadata": {
                "operationMetadataId": "8b61dc6c-c924-4c77-9728-632936580450"
              },
              "type": "If"
            }
          },
          "runAfter": {
            "Get-File-Relative-Path": [
              "Succeeded"
            ]
          },
          "expression": {
            "and": [
              {
                "greater": [
                  "@length(outputs('SharePoint-file-path'))",
                  0
                ]
              },
              {
                "greater": [
                  "@outputs('activity-Type')",
                  0
                ]
              }
            ]
          },
          "metadata": {
            "operationMetadataId": "de2e31fb-b088-4d31-b562-a086b54ce650"
          },
          "type": "If"
        },
        "SharePoint-file-path": {
          "runAfter": {
            "Initialize_ProvinceCodes_variable": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "813f258f-a88e-4327-a661-56a540b24c1e"
          },
          "type": "Compose",
          "inputs": "@triggerOutputs()?['body/cid_tempsharepointfilelocation']"
        },
        "activity-Type": {
          "runAfter": {
            "SharePoint-file-path": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "a2836a02-5322-4e7d-9199-a011455095fb"
          },
          "type": "Compose",
          "inputs": "@triggerOutputs()?['body/cid_activitytype']"
        },
        "Activity_End_time": {
          "runAfter": {
            "activity-Type": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "12e7d949-e095-404c-8616-7984518928ea"
          },
          "type": "Compose",
          "inputs": "@triggerOutputs()?['body/cid_activityendtime']"
        },
        "CompanyId": {
          "runAfter": {
            "Activity_End_time": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "489ef8ab-ca6a-4f9a-b46e-76621eeb2231"
          },
          "type": "Compose",
          "inputs": "@triggerOutputs()?['body/_cid_company_value']"
        },
        "Initialize_ProvinceCodes_variable": {
          "runAfter": {
            "Scope_-_Language_logic_for_Messages": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "74815300-3912-4a4c-ad7f-1cfdca4d3ce9"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "ProvinceCodes",
                "type": "object",
                "value": {
                  "NL": "10",
                  "PE": "11",
                  "NS": "12",
                  "NB": "13",
                  "QC": "24",
                  "ON": "35",
                  "MB": "46",
                  "SK": "47",
                  "AB": "48",
                  "BC": "59",
                  "YU": "60",
                  "NT": "61",
                  "NU": "62",
                  "UF": "72",
                  "IW": "73"
                }
              }
            ]
          }
        },
        "Get-File-Relative-Path": {
          "runAfter": {
            "CompanyId": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "62a55140-16b9-46c5-8165-dbd9d75253d9"
          },
          "type": "Compose",
          "inputs": "@substring(outputs('SharePoint-file-path'), indexOf(outputs('SharePoint-file-path'),'CID_Bulk_Upload'))"
        },
        "check_error_flag": {
          "actions": {
            "Update_Bulk_activity_log_summary_2": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "b9fd40b4-ad5c-476a-a72c-c9247d363b8a"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "UpdateRecord",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "cid_bulkactivitylogsummaries",
                  "recordId": "@triggerOutputs()?['body/cid_bulkactivitylogsummaryid']",
                  "item/cid_numberofsites": "@outputs('totalNumberOfSites')",
                  "item/cid_numberofunnumbers": "@outputs('NumberOfUnNumbers')",
                  "item/cid_validationcompletedstage": 100000001
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Loop_in_each_site_to_insert_or_Update": {
              "foreach": "@body('Select_Site_List')",
              "actions": {
                "Current_row_Site": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "692703f0-6bc6-4bc1-8199-14e43dfe7f6a"
                  },
                  "type": "Compose",
                  "inputs": "@items('Loop_in_each_site_to_insert_or_Update')"
                },
                "UNList": {
                  "runAfter": {
                    "Current_row_Site": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "3c730080-51de-459b-8861-551d06758084"
                  },
                  "type": "Query",
                  "inputs": {
                    "from": "@body('Select_extended_info')",
                    "where": "@and(equals(item()['ExtendedSite'], outputs('Current_row_Site')['SiteFullAddress']), greater(length(item()['ExtendedUNnumber']), 0))"
                  }
                },
                "Insert-Update_Sites_and_related_data": {
                  "runAfter": {
                    "UNList": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "9019f374-1b71-47df-adc5-7089dc352e8e"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps",
                      "operationId": "PerformBoundAction",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "accounts",
                      "actionName": "Microsoft.Dynamics.CRM.cid_Insert_and_Update_Site_and_Related_UNs",
                      "recordId": "@outputs('Get_bulk_activities_log_summary_by_ID')?['body/_cid_company_value']",
                      "item/ActionedBy": "@outputs('Get_bulk_activities_log_summary_by_ID')?['body/_cid_actionedby_value']",
                      "item/LegalName": "@outputs('Get_a_account_by_ID')?['body/ovs_legalname']",
                      "item/OperatingName": "@outputs('Get_a_account_by_ID')?['body/name']",
                      "item/SiteInfo": "@outputs('Current_row_Site')",
                      "item/UNList": "@body('UNList')",
                      "item/ActivityID": "@outputs('Get_bulk_activities_log_summary_by_ID')?['body/cid_bulkactivitylogsummaryid']"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                }
              },
              "runAfter": {
                "check_if_delete_UN_number_is_required": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a13dfb1a-1128-4977-9f3a-295db5d71229"
              },
              "type": "Foreach"
            },
            "check_if_delete_UN_number_is_required": {
              "actions": {
                "List_All_UN_rows_under_parent_account": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "1f5d0802-0ff1-4931-8759-52ff00665346"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps_1",
                      "operationId": "ListRecords",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "entityName": "ovs_operationunnumbers",
                      "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n<entity name=\"ovs_operationunnumber\">\n<attribute name=\"ovs_name\"/>\n<attribute name=\"ovs_operationunnumberid\"/>\n<order attribute=\"ovs_name\" descending=\"false\"/>\n<link-entity name=\"ovs_mocregistration\" from=\"ovs_mocregistrationid\" to=\"ovs_operationunnumber\" link-type=\"inner\" alias=\"ac\">\n<link-entity name=\"account\" from=\"accountid\" to=\"ovs_siteid\" link-type=\"inner\" alias=\"ad\">\n<filter type=\"and\">\n<condition attribute=\"parentaccountid\" operator=\"eq\"  value=\"@{outputs('Get_a_account_by_ID')?['body/accountid']}\"/>\n</filter>\n</link-entity>\n</link-entity>\n</entity>\n</fetch>"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "Apply_to_each_UN_row_to_delete": {
                  "foreach": "@outputs('List_All_UN_rows_under_parent_account')?['body/value']",
                  "actions": {
                    "Delete_UN_Row": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "8d369b03-04b2-41e0-b59e-6d9170217202"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps_1",
                          "operationId": "DeleteRecord",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "ovs_operationunnumbers",
                          "recordId": "@items('Apply_to_each_UN_row_to_delete')?['ovs_operationunnumberid']"
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    }
                  },
                  "runAfter": {
                    "List_All_UN_rows_under_parent_account": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "cec00236-1701-42f0-bba2-406e1d856876"
                  },
                  "type": "Foreach"
                }
              },
              "runAfter": {
                "Update_Bulk_activity_log_summary_2": [
                  "Succeeded"
                ]
              },
              "expression": {
                "equals": [
                  1,
                  1
                ]
              },
              "metadata": {
                "operationMetadataId": "03f7da4b-e6a8-4420-a708-a2e797cb5f7e"
              },
              "type": "If"
            },
            "Update_Bulk_activity_log_summary_end_activity_time": {
              "runAfter": {
                "Loop_in_each_site_to_insert_or_Update": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "b9fd40b4-ad5c-476a-a72c-c9247d363b8a"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps_1",
                  "operationId": "UpdateRecord",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "cid_bulkactivitylogsummaries",
                  "recordId": "@triggerOutputs()?['body/cid_bulkactivitylogsummaryid']",
                  "item/cid_activityendtime": "@utcNow()",
                  "item/cid_activitystatus": 100000000,
                  "item/cid_totalruntime": "@div(sub(ticks(utcNow()),ticks(outputs('Get_bulk_activities_log_summary_by_ID')?['body/cid_activitystarttime'])),600000000)"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Language_is_English": {
              "actions": {
                "Send_summary_email_to_portal_contact_in_English": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "03fa68c2-eaef-45a3-a78e-77053dd96194"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_sendmail",
                      "operationId": "SendEmailV3",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_sendmail"
                    },
                    "parameters": {
                      "request/to": "@{outputs('get_contact_email')?['body/emailaddress1']};",
                      "request/subject": "The uploaded workbook has been processed successfully",
                      "request/text": "<p>Hi @{outputs('get_contact_email')?['body/firstname']},<br>\nThe uploaded workbook for @{outputs('Get_a_account_by_ID')?['body/ovs_legalname']} &nbsp;has been processed successfully:<br>\nThe following are summary of the upload:<br>\nDate of the upload: @{body('Convert_time_zone')}<br>\n# Sites in the workbook:@{outputs('totalNumberOfSites')}<br>\n# UN in the workbook: @{outputs('NumberOfUnNumbers')}<br>\nFile Name:@{outputs('Update_Bulk_activity_log_summary_end_activity_time')?['body/cid_filename']}<br>\n</p>"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                }
              },
              "runAfter": {
                "Update_Bulk_activity_log_summary_end_activity_time": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "Send_summary_email_to_portal_contact_in_French": {
                    "runAfter": {},
                    "metadata": {
                      "operationMetadataId": "87209241-078e-426d-9663-566b2623e814"
                    },
                    "type": "OpenApiConnection",
                    "inputs": {
                      "host": {
                        "connectionName": "shared_sendmail",
                        "operationId": "SendEmailV3",
                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_sendmail"
                      },
                      "parameters": {
                        "request/to": "@{outputs('get_contact_email')?['body/emailaddress1']};",
                        "request/subject": "The uploaded workbook has been processed successfully",
                        "request/text": "<p><br>\nSalut @{outputs('get_contact_email')?['body/firstname']},<br>\nLe classeur importé pour @{outputs('Get_a_account_by_ID')?['body/ovs_legalname']} a été traité avec succès :<br>\nVoici un résumé du téléchargement :<br>\nDate du téléchargement :@{body('Convert_time_zone')}<br>\n# Sites dans le classeur :@{outputs('totalNumberOfSites')}<br>\n# ONU dans le classeur :@{outputs('NumberOfUnNumbers')}<br>\nNom de fichier:@{outputs('Update_Bulk_activity_log_summary_end_activity_time')?['body/cid_filename']}</p>"
                      },
                      "authentication": "@parameters('$authentication')"
                    }
                  }
                }
              },
              "expression": {
                "equals": [
                  "@variables('Language')",
                  "@'918640001'"
                ]
              },
              "metadata": {
                "operationMetadataId": "37c9cb98-e82d-47d1-8288-e5279e81d2d6"
              },
              "type": "If"
            }
          },
          "runAfter": {
            "Convert_time_zone": [
              "Succeeded"
            ]
          },
          "else": {
            "actions": {
              "if_language_is_english": {
                "actions": {
                  "Select_Error_List_Variable_columns_English": {
                    "runAfter": {},
                    "metadata": {
                      "operationMetadataId": "091d13e2-41c8-49ec-afa7-5073e00c8921"
                    },
                    "type": "Select",
                    "inputs": {
                      "from": "@variables('Error_List')",
                      "select": {
                        "Worksheet": "@item()['SheetName']",
                        "Row #": "@item()['Row#']",
                        "Error": "@item()['Error']",
                        "Site": "@item()['Site']"
                      }
                    }
                  },
                  "Send_an_email_notification_to_portal_users_with_errors": {
                    "runAfter": {
                      "html_table_with_style": [
                        "Succeeded"
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "94e1b98e-5051-4132-b512-028ad4bd7d96"
                    },
                    "type": "OpenApiConnection",
                    "inputs": {
                      "host": {
                        "connectionName": "shared_sendmail",
                        "operationId": "SendEmailV3",
                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_sendmail"
                      },
                      "parameters": {
                        "request/to": "@{outputs('get_contact_email')?['body/emailaddress1']};",
                        "request/subject": "workbook was not successfully uploaded",
                        "request/text": "<p>Hello @{outputs('get_contact_email')?['body/firstname']},<br>\n<br>\nworkbook for @{outputs('get_contact_email')?['body']['_parentcustomerid_value@OData.Community.Display.V1.FormattedValue']} was not successfully uploaded, Please address the following errors first and try the upload again.<br>\n- Upload Date: @{body('Convert_time_zone')}<br>\n- Total # of Sites in the workbook : @{outputs('totalNumberOfSites')}<br>\n- Total # of UNs in the workbook : @{outputs('totalNumberOferrors')}<br>\n- Total # of Errors: @{outputs('totalNumberOferrors')}<br>\n- File Name: @{outputs('Update_Bulk_activity_log_summary')?['body/cid_filename']}<br>\n<br>\nThe following are the Number of Errors found in the uploaded workbook:<br>\n<br>\n@{replace( outputs('html_table_with_style') ,'<table>' , '  <table><col style=\"width:15%\">\r\n\t<col style=\"width:10%\">\r\n\t<col style=\"width:50%\">\r\n        <col style=\"width:25%\">')}<br>\n</p>"
                      },
                      "authentication": "@parameters('$authentication')"
                    }
                  },
                  "html_table_with_style": {
                    "runAfter": {
                      "Create_HTML_table": [
                        "Succeeded"
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "920beb59-130c-4895-ab0c-490a0d32e827"
                    },
                    "type": "Compose",
                    "inputs": "  <style>\n        table {\n            border: 1px solid #1C6EA4;\n            background-color: #EEEEEE;\n            width: 100%;\n    \n            border-collapse: collapse;\n        }\n\n            table td, table th {\n                border: 1px solid #AAAAAA;\n                padding: 3px 2px;\n         \n            }\n\n           \n            table tbody tr :nth-child(2) {\n                text-align: center;\n                font-size: 13px;\n            }\n\n           \n           \n            table thead {\n                background: #1C6EA4;\n                border-bottom: 2px solid #444444;\n            }\n\n                table thead th {\n                    font-size: 15px;\n                    font-weight: bold;\n                    color: #FFFFFF;\n                    border-left: 2px solid #D0E4F5;\n                    text-align: center;\n                }\n\n                    table thead th:first-child {\n                        border-left: none;\n                    }\n    </style>\n\n@{body('Create_HTML_table')}"
                  },
                  "Create_HTML_table": {
                    "runAfter": {
                      "Select_Error_List_Variable_columns_English": [
                        "Succeeded"
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "3d5b95c3-0259-4f2b-a767-b20b99174ec1"
                    },
                    "type": "Table",
                    "inputs": {
                      "from": "@body('Select_Error_List_Variable_columns_English')",
                      "format": "HTML"
                    }
                  }
                },
                "runAfter": {
                  "Update_Bulk_activity_log_summary": [
                    "Succeeded"
                  ]
                },
                "else": {
                  "actions": {
                    "Create_HTML_table-French": {
                      "runAfter": {
                        "Select_Error_List_Variable_columns": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "16f727a6-fe5f-4fe3-b56d-ae277f2a3eec"
                      },
                      "type": "Table",
                      "inputs": {
                        "from": "@body('Select_Error_List_Variable_columns')",
                        "format": "HTML"
                      }
                    },
                    "Select_Error_List_Variable_columns": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "091d13e2-41c8-49ec-afa7-5073e00c8921"
                      },
                      "type": "Select",
                      "inputs": {
                        "from": "@variables('Error_List')",
                        "select": {
                          "Feuille de travail": "@item()['SheetName']",
                          "Rangée #": "@item()['Row#']",
                          "Erreur": "@item()['Error']",
                          "Site": "@item()['Site']"
                        }
                      }
                    },
                    "Send_an_email_notification_with_errors_to_portal_user_in_English": {
                      "runAfter": {
                        "html_table_with_style-French": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "661155db-9f65-4f0b-af70-fa25633e3684"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_sendmail_1",
                          "operationId": "SendEmailV3",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_sendmail"
                        },
                        "parameters": {
                          "request/to": "@{outputs('get_contact_email')?['body/emailaddress1']};",
                          "request/subject": "le classeur n'a pas été téléchargé avec succès",
                          "request/text": "<p>Bonjour @{outputs('get_contact_email')?['body/firstname']},<br>\n<br>\ncahier d'exercices pour &nbsp;@{outputs('get_contact_email')?['body']['_parentcustomerid_value@OData.Community.Display.V1.FormattedValue']} n'a pas été téléchargé avec succès, veuillez d'abord résoudre les erreurs suivantes et réessayez le téléchargement.<br>\n<br>\n- Date de dépôt: @{body('Convert_time_zone')}<br>\n- Nombre total de sites dans le classeur : @{outputs('totalNumberOfSites')}<br>\n- Nombre total d'ONU dans le classeur : @{outputs('totalNumberOferrors')}<br>\n- Nombre total d'erreurs: @{outputs('totalNumberOferrors')}<br>\n- Nom de fichier: @{outputs('Update_Bulk_activity_log_summary')?['body/cid_filename']}<br>\n<br>\nVoici le nombre d'erreurs trouvées dans le classeur téléchargé:<br>\n<br>\n@{replace( outputs('html_table_with_style-French') ,'<table>' , '  <table><col style=\"width:20%\">\r\n\t<col style=\"width:10%\">\r\n\t<col style=\"width:45%\">\r\n        <col style=\"width:25%\">')}<br>\n<br>\n<br>\n</p>"
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    },
                    "html_table_with_style-French": {
                      "runAfter": {
                        "Create_HTML_table-French": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "920beb59-130c-4895-ab0c-490a0d32e827"
                      },
                      "type": "Compose",
                      "inputs": " <style>\n        table {\n            border: 1px solid #1C6EA4;\n            background-color: #EEEEEE;\n            width: 100%;\n    \n            border-collapse: collapse;\n        }\n\n            table td, table th {\n                border: 1px solid #AAAAAA;\n                padding: 3px 2px;\n                text-align: center;\n            }\n\n            table tbody tr td:nth-child(1) {\n                text-align: left;\n                font-size: 13px;\n            }\n            table tbody tr td:nth-child(2) {\n                text-align: center;\n                font-size: 13px;\n            }\n           \n            table tbody tr td:nth-child(3) {\n                text-align: left;\n                font-size: 13px;\n            }\n            table tbody tr td:nth-child(4) {\n                text-align: left;\n                font-size: 13px;\n            }\n            table thead {\n                background: #1C6EA4;\n                border-bottom: 2px solid #444444;\n            }\n\n                table thead th {\n                    font-size: 15px;\n                    font-weight: bold;\n                    color: #FFFFFF;\n                    border-left: 2px solid #D0E4F5;\n                }\n\n                    table thead th:first-child {\n                        border-left: none;\n                    }\n    </style>\n\n\n@{replace(replace(body('Create_HTML_table-French'),'Add Extended Info','Ajouter des informations étendues'),'Add Basic Info' ,'Ajouter des informations de base')}\n"
                    }
                  }
                },
                "expression": {
                  "equals": [
                    "@variables('Language')",
                    "@'918640001'"
                  ]
                },
                "metadata": {
                  "operationMetadataId": "2ab86d82-d594-432b-a24a-8da1b7311ea6"
                },
                "type": "If"
              },
              "Update_Bulk_activity_log_summary": {
                "runAfter": {},
                "metadata": {
                  "operationMetadataId": "b9fd40b4-ad5c-476a-a72c-c9247d363b8a"
                },
                "type": "OpenApiConnection",
                "inputs": {
                  "host": {
                    "connectionName": "shared_commondataserviceforapps_1",
                    "operationId": "UpdateRecord",
                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                  },
                  "parameters": {
                    "entityName": "cid_bulkactivitylogsummaries",
                    "recordId": "@triggerOutputs()?['body/cid_bulkactivitylogsummaryid']",
                    "item/cid_activityendtime": "@utcNow()",
                    "item/cid_activitystatus": 100000001,
                    "item/cid_numberofsites": "@outputs('totalNumberOfSites')",
                    "item/cid_numberofunnumbers": "@outputs('NumberOfUnNumbers')",
                    "item/cid_totalruntime": "@div(sub(ticks(utcNow()),ticks(outputs('Get_bulk_activities_log_summary_by_ID')?['body/cid_activitystarttime'])),600000000)"
                  },
                  "authentication": "@parameters('$authentication')"
                }
              }
            }
          },
          "expression": {
            "equals": [
              "@variables('IsErrorFree')",
              "@true"
            ]
          },
          "metadata": {
            "operationMetadataId": "65069879-0150-4e08-9d1e-e04210460358"
          },
          "type": "If"
        },
        "get_contact_email": {
          "runAfter": {
            "Get_bulk_activities_log_summary_by_ID": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "3aa29ee7-04a6-41ba-ab07-924c6b990d05"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "GetItem",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "contacts",
              "recordId": "@triggerOutputs()?['body/_cid_actionedby_value']"
            },
            "authentication": "@parameters('$authentication')"
          }
        },
        "get-environment-settings": {
          "runAfter": {
            "get_contact_email": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "7ed63b1d-9cf8-403e-9d9c-56cdd03f198e"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps",
              "operationId": "ListRecords",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "qm_environmentsettingses",
              "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n<entity name=\"qm_environmentsettings\">\n<attribute name=\"qm_environmentsettingsid\"/>\n<attribute name=\"qm_name\"/>\n<attribute name=\"qm_value\"/>\n<order attribute=\"qm_name\" descending=\"false\"/>\n<filter type=\"and\">\n<condition attribute=\"qm_name\" operator=\"like\" value=\"%CID[_]%\"/>\n</filter>\n</entity>\n</fetch>"
            },
            "authentication": "@parameters('$authentication')"
          }
        },
        "Scope_-_Language_logic_for_Messages": {
          "actions": {
            "Messaages": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "04d08f07-7aa1-43e4-8da5-adb1e21d7258"
              },
              "type": "Compose",
              "inputs": "[\n{\"code\" : \"B1001\" , \"Eng-Message\" : \"A scan of the file has found a potential virus. Please download and update a new version of the Site Bulk Upload Excel Template, then upload that file instead. [B1001]\", \"Fr-Message\" :  \"Une analyse du fichier a trouvé un virus potentiel. Veuillez télécharger et mettre à jour une nouvelle version du modèle Excel de téléchargement groupé du site, puis téléchargez ce fichier à la place.[B1001]\" } ,\n{\"code\" : \"B1002\" , \"Eng-Message\" : \"The uploaded file is not the custom Site Bulk Upload Excel workbook. Please download and update a new version of the Site Bulk Upload Excel Template, then upload that file instead. [B1002] \", \"Fr-Message\" :  \"Le fichier téléchargé n'est pas le classeur Excel personnalisé de téléchargement en masse du site. Veuillez télécharger et mettre à jour une nouvelle version du modèle Excel de téléchargement groupé du site, puis téléchargez ce fichier à la place.[B1002] \" } ,\n{\"code\" : \"B1003\" , \"Eng-Message\" : \"The uploaded file is assigned to the ‘{0}’ Company, versus your own Company. Please download and update a new version of the Site Bulk Upload Excel Template, then upload that file instead. [B1003] \n\n{0} is the name of Company Name stored in a hidden field in the workbook \", \"Fr-Message\" :  \"Le fichier téléchargé est attribué à la société {0}, par opposition à votre propre société. Veuillez télécharger et mettre à jour une nouvelle version du modèle Excel de téléchargement groupé du site, puis téléchargez ce fichier à la place. [B1003]\n\n{0} est le nom du nom de la société stocké dans un champ masqué du classeur\" } ,\n{\"code\" : \"B1004\" , \"Eng-Message\" : \"The uploaded file is based on a template that is no longer current. Please download and update a new version of the Site Bulk Upload Excel Template, then upload that file instead. [B1004] \", \"Fr-Message\" :  \"Le fichier téléchargé est basé sur un modèle qui n'est plus actuel. Veuillez télécharger et mettre à jour une nouvelle version du modèle Excel de téléchargement groupé du site, puis téléchargez ce fichier à la place. [B1004]\" } ,\n{\"code\" : \"B1005\" , \"Eng-Message\" : \"The uploaded file is empty. Please update the file with the Basic, and if required Extended, Site information, Guidance for the data entry can be found in the [Instructions] sheet of the workbook.  \n\nWhen that process is complete, then upload that version of the file. [B1005]\", \"Fr-Message\" :  \"Le fichier téléchargé est vide. Veuillez mettre à jour le fichier avec les informations de base et, si nécessaire, les informations étendues sur le site. Des conseils pour la saisie des données peuvent être trouvés dans la feuille [Instructions] du classeur.\n\nUne fois ce processus terminé, téléchargez cette version du fichier. [B1005]\" } ,\n{\"code\" : \"B1006\" , \"Eng-Message\" : \"This workbook contains {0} rows of Site data and {1} rows of UN data for those sites. This exceeds the acceptable limits for the bulk upload of {2} rows for Site data and {3} rows for UN data.  \n\nThe [Instructions] tab within the workbook provides guidance as to what data needs to be provided. If need be, you may consider splitting the file into two Bulk files, each under the limits, and two Bulk submissions. [B1006] \", \"Fr-Message\" :  \"Ce classeur contient {0} lignes de données de site et {1} lignes de données UN pour ces sites. Cela dépasse les limites acceptables pour le téléchargement groupé de {2} lignes pour les données de site et de {3} lignes pour les données de l'ONU.[B1006]\" } ,\n{\"code\" : \"B1007\" , \"Eng-Message\" : \"There are already {0} rows of Site data and {1} rows of UN data for those sites on file for this Company, so no further uploads can continue. [B1007]\", \"Fr-Message\" :  \"\nIl existe déjà {0} lignes de données de site et {1} lignes de données de l'ONU pour ces sites dans le dossier de cette entreprise. Aucun autre téléchargement ne peut donc continuer. [B1007]\" } ,\n{\"code\" : \"B1008\" , \"Eng-Message\" : \"Missing required field: Province. [B1008]\", \"Fr-Message\" :  \"Champ obligatoire manquant : Province. [B1008]\" } ,\n{\"code\" : \"B1009\" , \"Eng-Message\" : \"Missing required field: Postal Code. [B1009]\", \"Fr-Message\" :  \"Champ obligatoire manquant : Code postal. [B1009]\" } ,\n{\"code\" : \"B1010\" , \"Eng-Message\" : \"Missing required field:Address 1. [B1010]\", \"Fr-Message\" :  \"Champ obligatoire manquant :Adresse 1. [B1010]\" } ,\n{\"code\" : \"B1011\" , \"Eng-Message\" : \"Address already exist. [B1011]\", \"Fr-Message\" :  \"\nL'adresse existe déjà pour l'entreprise par. [B1011]\" } ,\n{\"code\" : \"B1012\" , \"Eng-Message\" : \"City name is not correct. [B1012]\", \"Fr-Message\" :  \"Le nom de la ville n'est pas correct. [B1012]\" } ,\n{\"code\" : \"B1013\" , \"Eng-Message\" : \"City doesn't belong to Province. [B1013]\", \"Fr-Message\" :  \"\nLa ville n'appartient pas à la province. [B1013]\" } ,\n{\"code\" : \"B1014\" , \"Eng-Message\" : \"Missing required field:1B. Quarter / LSD. [B1014]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1B. Trimestre / LSD. [B1014]\" } ,\n{\"code\" : \"B1015\" , \"Eng-Message\" : \"Missing required field:1B. Section. [B1015]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1B. Section. [B1015]\" } ,\n{\"code\" : \"B1016\" , \"Eng-Message\" : \"Missing required field:1B. Township. [B1016]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1B. Canton. [B1016]\" } ,\n{\"code\" : \"B1017\" , \"Eng-Message\" : \"Missing required field:1B. Range. [B1017]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1B. Varier. [B1017]\" } ,\n{\"code\" : \"B1018\" , \"Eng-Message\" : \"Missing required field:1B. Meridian. [B1018]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1B. Méridien. [B1018]\" } ,\n{\"code\" : \"B1019\" , \"Eng-Message\" : \"Legal Land description already exists. [B1019]\", \"Fr-Message\" :  \"\nLa description légale du terrain existe déjà. [B1019]\" } ,\n{\"code\" : \"B1020\" , \"Eng-Message\" : \"Missing required field: 1C. Latitude. [B1020]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1C. Latitude. [B1020]\" } ,\n{\"code\" : \"B1021\" , \"Eng-Message\" : \"Missing required field: 1C. Longtitude. [B1021]\", \"Fr-Message\" :  \"Champ obligatoire manquant : 1C. Longitude. [B1021]\" } ,\n{\"code\" : \"B1022\" , \"Eng-Message\" : \"Latitude and Longtitude alerady exists for the company. [B1022]\", \"Fr-Message\" :  \"\nLa latitude et la longitude existent déjà pour l'entreprise. [B1022]\" } ,\n{\"code\" : \"B1023\" , \"Eng-Message\" : \"At least one mode of transportation Need to be selected. [B1023]\", \"Fr-Message\" :  \"Au moins un mode de transport Doit être sélectionné. [B1023]\" } ,\n{\"code\" : \"B1024\" , \"Eng-Message\" : \"At least one Class need to be added. [B1024]\", \"Fr-Message\" :  \"Au moins une classe doit être ajoutée. [B1024]\" } ,\n{\"code\" : \"B1025\" , \"Eng-Message\" : \"Incorrect class. [B1025]\", \"Fr-Message\" :  \"Classe incorrecte. [B1025]\" } ,\n{\"code\" : \"B1026\" , \"Eng-Message\" : \"Extended Site information in not specified. [B1026]\", \"Fr-Message\" :  \"\nLes informations étendues sur le site ne sont pas spécifiées. [B1026]\" } ,\n{\"code\" : \"B1027\" , \"Eng-Message\" : \"Site must have at least one HOTI activities. [B1027]\", \"Fr-Message\" :  \"Le site doit avoir au moins une activité HOTI. [B1027]\" } ,\n{\"code\" : \"B1028\" , \"Eng-Message\" : \"Extednded site must have at Least  on UNNumber Need to be specified. [B1028]\", \"Fr-Message\" :  \"Le site étendu doit avoir au moins un numéro UN Doit être spécifié. [B1028]\" } ,\n{\"code\" : \"B1029\" , \"Eng-Message\" : \"Missing required field: City. [B1029]\", \"Fr-Message\" :  \"Champ obligatoire manquant : Ville. [B1029]\" } ,\n{\"code\" : \"B1030\" , \"Eng-Message\" : \"Missing Annual Quantity/Volume. [B1030]\", \"Fr-Message\" :  \"Quantité/Volume annuel manquant. [B1030]\" } ,\n{\"code\" : \"B1031\" , \"Eng-Message\" : \"Missing Unit of measurement. [B1031]\", \"Fr-Message\" :  \"Unité de mesure manquante. [B1031]\" } ,\n{\"code\" : \"B1032\" , \"Eng-Message\" : \"Missing Annual # of  Consignments. [B1032]\", \"Fr-Message\" :  \"Nombre annuel manquant d'envois. [B1032]\" } ,\n{\"code\" : \"B1033\" , \"Eng-Message\" : \"Site belong to another company. Please go through cliaming process. [B1033]\", \"Fr-Message\" :  \"Le site appartient à une autre société. Veuillez passer par le processus de réclamation. [B1033]\" } ,\n{\"code\" : \"B1034\" , \"Eng-Message\" : \"Once site address is established it cannot be changed.[B1034]\", \"Fr-Message\" :  \"Une fois l'adresse du site établie, elle ne peut plus être modifiée.[B1034]\" } \n\n]"
            },
            "Parse_Messages_to_JSON": {
              "runAfter": {
                "Messaages": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "c7167db6-5d1d-4c49-8959-e8ed51425a00"
              },
              "type": "ParseJson",
              "inputs": {
                "content": "@outputs('Messaages')",
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "code": {
                        "type": "string"
                      },
                      "Eng-Message": {
                        "type": "string"
                      },
                      "Fr-Message": {
                        "type": "string"
                      }
                    },
                    "required": [
                      "code",
                      "Eng-Message",
                      "Fr-Message"
                    ]
                  }
                }
              }
            },
            "Check_Language": {
              "actions": {
                "Select_-_English_Language": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "2f87aa54-460c-45c4-a069-00ea3dbd7bf2"
                  },
                  "type": "Select",
                  "inputs": {
                    "from": "@body('Parse_Messages_to_JSON')",
                    "select": {
                      "code": "@item()['code']",
                      "Message": "@item()['Eng-Message']"
                    }
                  }
                },
                "Apply_to_each_English_Message": {
                  "foreach": "@body('Select_-_English_Language')",
                  "actions": {
                    "Append_to_array_variable_3": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "e34d2bba-d320-4f5a-9b95-0e2454bf437e"
                      },
                      "type": "AppendToArrayVariable",
                      "inputs": {
                        "name": "Messages_Array",
                        "value": "@items('Apply_to_each_English_Message')"
                      }
                    }
                  },
                  "runAfter": {
                    "Select_-_English_Language": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "21b64a4a-96fd-4540-b578-86cee5235ab6"
                  },
                  "type": "Foreach"
                }
              },
              "runAfter": {
                "Parse_Messages_to_JSON": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "Select_-_French_Language": {
                    "runAfter": {},
                    "metadata": {
                      "operationMetadataId": "7e1b1002-0ea0-4737-81cd-7a7ddee851b1"
                    },
                    "type": "Select",
                    "inputs": {
                      "from": "@body('Parse_Messages_to_JSON')",
                      "select": {
                        "code": "@item()['code']",
                        "Message": "@item()['Fr-Message']"
                      }
                    }
                  },
                  "for_each_French_message": {
                    "foreach": "@body('Select_-_French_Language')",
                    "actions": {
                      "Append_to_array_variable_French_Message": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "6ca892ec-2f00-4e9c-9c07-db6a700f96df"
                        },
                        "type": "AppendToArrayVariable",
                        "inputs": {
                          "name": "Messages_Array",
                          "value": "@items('for_each_French_message')"
                        }
                      }
                    },
                    "runAfter": {
                      "Select_-_French_Language": [
                        "Succeeded"
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "1b147b98-4f69-4ed0-a0b3-3d01bf011e07"
                    },
                    "type": "Foreach"
                  }
                }
              },
              "expression": {
                "equals": [
                  "@variables('Language')",
                  "@'918640001'"
                ]
              },
              "metadata": {
                "operationMetadataId": "95a1b3cb-7717-4242-95b3-e1d926135492"
              },
              "type": "If"
            }
          },
          "runAfter": {
            "check_if_language_is_null": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "579a4345-0777-4a5f-8e95-463e308bb3c1"
          },
          "type": "Scope"
        },
        "Initialize_Message_Array": {
          "runAfter": {
            "Initialize_variable_-_Error_Message": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "9c2fcec6-947b-4396-aa5d-63b3262a276f"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Messages_Array",
                "type": "array"
              }
            ]
          }
        },
        "Get_bulk_activities_log_summary_by_ID": {
          "runAfter": {
            "Get_a_account_by_ID": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "ac95dd8f-6edc-4bfd-975a-6c9c22d7f655"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "GetItem",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "cid_bulkactivitylogsummaries",
              "recordId": "@triggerOutputs()?['body/cid_bulkactivitylogsummaryid']"
            },
            "authentication": "@parameters('$authentication')"
          }
        },
        "Initialize_variable_-_Error_Message": {
          "runAfter": {
            "Error_flag": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "eb9a8ba4-4adb-48fa-9736-b2febfa6d858"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Error_Message",
                "type": "string"
              }
            ]
          }
        },
        "totalNumberOferrors": {
          "runAfter": {
            "Check_if_Validation_should_start_on_the_Modified_event": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "28a8735f-bcb1-4554-b08a-6e429977b8d7"
          },
          "type": "Compose",
          "inputs": "@ length(variables('Error_List')) "
        },
        "totalNumberOfSites": {
          "runAfter": {
            "totalNumberOferrors": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "6e482b88-0e20-4cfb-9a9d-59d8799d6efa"
          },
          "type": "Compose",
          "inputs": "@length(body('Filter_table_-_get_none_empty_cells_sites_for_insert_'))"
        },
        "NumberOfUnNumbers": {
          "runAfter": {
            "totalNumberOfSites": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "958aedd2-980b-4aeb-806d-5de021c93c57"
          },
          "type": "Compose",
          "inputs": "@length(body('Filter_table_-_Get_None_empty_cells_Extended_Table'))"
        },
        "Convert_time_zone": {
          "runAfter": {
            "NumberOfUnNumbers": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "f74cfa7b-9df9-43ef-a39a-8f7a83c4e844"
          },
          "type": "Expression",
          "kind": "ConvertTimeZone",
          "inputs": {
            "baseTime": "@outputs('Get_bulk_activities_log_summary_by_ID')?['body/createdon']",
            "formatString": "yyyy-MM-dd hh:mm",
            "sourceTimeZone": "Eastern Standard Time",
            "destinationTimeZone": "Eastern Standard Time"
          }
        },
        "define_basic_info_sheet_columns_2": {
          "actions": {
            "SiteName": {
              "runAfter": {
                "Parse_JSON": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "0b319d79-94cf-4ca6-bb49-3374fdd972f0"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Site']"
            },
            "Address1": {
              "runAfter": {
                "SiteName": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "1f93a4c9-5519-4834-b9a6-fb3d5764c2eb"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Address 1']"
            },
            "City": {
              "runAfter": {
                "Address1": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "dbe26cc1-4c9c-4ba8-b85d-cb64eef8faef"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['City']"
            },
            "Province": {
              "runAfter": {
                "City": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "e975e0f1-f06a-4dca-9047-e47503e2782b"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Province']"
            },
            "PostalCode": {
              "runAfter": {
                "Province": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "75282f2f-4b8b-4689-9ea9-3782d51058df"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Postal Code']"
            },
            "Address2": {
              "runAfter": {
                "PostalCode": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3f6a122f-c20c-4d83-b063-3be620089848"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Address 2']"
            },
            "Address3": {
              "runAfter": {
                "Address2": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "4026d79c-ae18-4b94-8b1d-296b3690cda9"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Address 3']"
            },
            "LLDProvince": {
              "runAfter": {
                "Address3": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "6cdb4c23-56ba-41ce-a13f-03aebdcb78b7"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['ProvinceLLD']"
            },
            "Quarter": {
              "runAfter": {
                "LLDProvince": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a29b5c9a-fe60-4d35-be55-454356d40e4f"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Quarter']"
            },
            "Section": {
              "runAfter": {
                "Quarter": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "42869346-d816-4923-b26b-e3ac7c3bb620"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Section']"
            },
            "TownShip": {
              "runAfter": {
                "Section": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "cdc284ff-1f84-471b-95da-6eddcc7e3427"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Township']"
            },
            "Range": {
              "runAfter": {
                "TownShip": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "f5b44d03-0ea1-4322-ad2e-ea6a9fda2fd5"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Range']"
            },
            "Meridian": {
              "runAfter": {
                "Range": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "794f7754-6314-4932-bb63-f299ce9974c5"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Meridian']"
            },
            "Lat": {
              "runAfter": {
                "Meridian": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3abf2572-b339-4126-a607-688e09d752f9"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Latitude']"
            },
            "Long": {
              "runAfter": {
                "Lat": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "855c0461-a4e4-4454-8a28-ead74c94fb7a"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Longitude']"
            },
            "Air": {
              "runAfter": {
                "Long": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "129357ef-35ce-4762-8f3f-2f1339fcc145"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Air']"
            },
            "Marine": {
              "runAfter": {
                "Air": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "33fb1f99-04f8-4e73-b7c2-71a74178883b"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Marine']"
            },
            "Rail": {
              "runAfter": {
                "Marine": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "b70f0b0e-5265-4b61-8963-fc1b4b8f8b4e"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Rail']"
            },
            "Road": {
              "runAfter": {
                "Rail": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "67efa3fd-0019-4731-ab45-38562b1c3afe"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Road']"
            },
            "Handle": {
              "runAfter": {
                "Road": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "87ed0437-464f-4d68-8884-f0aaa8cc4909"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Handle']"
            },
            "OfferForTransport": {
              "runAfter": {
                "Handle": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a075538b-4938-451b-aa5c-b0b909e8bceb"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Offer for Transport']"
            },
            "Transport": {
              "runAfter": {
                "OfferForTransport": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "4be5c4d6-7fd5-425e-9fd7-93ec3d499774"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Transport']"
            },
            "Import": {
              "runAfter": {
                "Transport": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "b5d428ee-008d-48b7-af90-7003164339a4"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Import']"
            },
            "Class": {
              "runAfter": {
                "Import": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "b8301325-ecf8-44e1-addf-9c005e8daae5"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Class']"
            },
            "extendedYN": {
              "runAfter": {
                "Class": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a3f56429-de62-4db0-8ac3-2f7dba91b8e2"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Extended-Information-Site']"
            },
            "LineNumber": {
              "runAfter": {
                "extendedYN": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "87e59482-f129-418f-b5a6-66cf15fa34a4"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['Row number']"
            },
            "SiteFullAddress": {
              "runAfter": {
                "LineNumber": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "097c3321-7f83-4634-9681-c902ac84dd3a"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['SiteFullAddress']"
            },
            "SiteGUID": {
              "runAfter": {
                "SiteFullAddress": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "5f6eb9ca-7a27-41e2-b0a5-851101b1f606"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON')['site-GUID']"
            },
            "Parse_JSON": {
              "runAfter": {
                "ExclJsonStringColumns": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3f62b9eb-4bd6-419b-953f-ba6f2c27ef27"
              },
              "type": "ParseJson",
              "inputs": {
                "content": "@outputs('ExclJsonStringColumns')",
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserAction": {
                      "type": "string"
                    },
                    "Site Name": {
                      "type": "string"
                    },
                    "Address 1": {
                      "type": "string"
                    },
                    "City": {
                      "type": "string"
                    },
                    "Province": {
                      "type": "string"
                    },
                    "Postal Code ": {
                      "type": "string"
                    },
                    "Address 2": {
                      "type": "string"
                    },
                    "Address 3": {
                      "type": "string"
                    },
                    "Province  ": {
                      "type": "string"
                    },
                    "Quarter ": {
                      "type": "string"
                    },
                    "Section": {
                      "type": "string"
                    },
                    "Township": {
                      "type": "string"
                    },
                    "Range": {
                      "type": "string"
                    },
                    "Meridian": {
                      "type": "string"
                    },
                    "Latitude": {
                      "type": "string"
                    },
                    "Longitude": {
                      "type": "string"
                    },
                    " Air": {
                      "type": "string"
                    },
                    "Marine": {
                      "type": "string"
                    },
                    "Rail": {
                      "type": "string"
                    },
                    "Road": {
                      "type": "string"
                    },
                    "Handle": {
                      "type": "string"
                    },
                    "Offer for Transport": {
                      "type": "string"
                    },
                    "Transport": {
                      "type": "string"
                    },
                    "Import": {
                      "type": "string"
                    },
                    "Class/Division ": {
                      "type": "string"
                    },
                    "Extended Information Site ": {
                      "type": "string"
                    },
                    "Row number": {
                      "type": "string"
                    },
                    "SiteFullAddress": {
                      "type": "string"
                    },
                    "site-GUID": {
                      "type": "string"
                    }
                  }
                }
              }
            },
            "ExclJsonStringColumns": {
              "runAfter": {
                "Filter_array-environmentsetting-getExcelSiteColumns": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "6c280618-ef32-4af0-90e1-8d8d3ad762f4"
              },
              "type": "Compose",
              "inputs": "@body('Filter_array-environmentsetting-getExcelSiteColumns')?[0]['qm_value']"
            },
            "Filter_array-environmentsetting-getExcelSiteColumns": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "41f6f1a2-74a5-40a3-8f7a-1c9d91283a64"
              },
              "type": "Query",
              "inputs": {
                "from": "@outputs('get-environment-settings')?['body/value']",
                "where": "@equals(item()['qm_name'], 'CID_BulkUpload_Sites_Columns_In_Excel')"
              }
            }
          },
          "runAfter": {
            "Filter_environment-CID_Flow_Environment_Folder": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "d4375930-3c4d-472c-a8b9-7d72d1b358f5"
          },
          "type": "Scope"
        },
        "define_extended_columns_in_excel_sheet_2": {
          "actions": {
            "ExtendedSite": {
              "runAfter": {
                "ExtendedAction": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "0b319d79-94cf-4ca6-bb49-3374fdd972f0"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['Site']"
            },
            "ExtendedUNNumber": {
              "runAfter": {
                "ExtendedSite": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "1f93a4c9-5519-4834-b9a6-fb3d5764c2eb"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['unnumber']"
            },
            "ExtendedQuantity": {
              "runAfter": {
                "ExtendedUNNumber": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "dbe26cc1-4c9c-4ba8-b85d-cb64eef8faef"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['Quantity']"
            },
            "ExtendedUnitOfMeasure": {
              "runAfter": {
                "ExtendedQuantity": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "e975e0f1-f06a-4dca-9047-e47503e2782b"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['Unit of Measure']"
            },
            "ExtendedAnnulaConsignment": {
              "runAfter": {
                "ExtendedUnitOfMeasure": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "75282f2f-4b8b-4689-9ea9-3782d51058df"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['Consignments']"
            },
            "ExtendedGUID": {
              "runAfter": {
                "ExtendedAnnulaConsignment": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3f6a122f-c20c-4d83-b063-3be620089848"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['UN-GUID']"
            },
            "Filter_array-environmentsetting-getExcelUNColumns": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "41f6f1a2-74a5-40a3-8f7a-1c9d91283a64"
              },
              "type": "Query",
              "inputs": {
                "from": "@outputs('get-environment-settings')?['body/value']",
                "where": "@equals(item()['qm_name'], 'CID_BulkUpload_Extended_Columns_In_Excel')"
              }
            },
            "ExtendedAction": {
              "runAfter": {
                "Parse_JSON-ExtendedColumns": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "a1598679-b359-4995-8082-c3ab58b5ce7b"
              },
              "type": "Compose",
              "inputs": "@body('Parse_JSON-ExtendedColumns')['UserAction']"
            },
            "ExclJsonUNStringColumns": {
              "runAfter": {
                "Filter_array-environmentsetting-getExcelUNColumns": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "6c280618-ef32-4af0-90e1-8d8d3ad762f4"
              },
              "type": "Compose",
              "inputs": "@body('Filter_array-environmentsetting-getExcelUNColumns')?[0]['qm_value']"
            },
            "Parse_JSON-ExtendedColumns": {
              "runAfter": {
                "ExclJsonUNStringColumns": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "3f62b9eb-4bd6-419b-953f-ba6f2c27ef27"
              },
              "type": "ParseJson",
              "inputs": {
                "content": "@outputs('ExclJsonUNStringColumns')",
                "schema": {
                  "type": "object",
                  "properties": {
                    "UserAction": {
                      "type": "string"
                    },
                    "Site": {
                      "type": "string"
                    },
                    "unnumber": {
                      "type": "string"
                    },
                    "Quantity": {
                      "type": "string"
                    },
                    "Unit of Measure": {
                      "type": "string"
                    },
                    "Consignments": {
                      "type": "string"
                    },
                    "UN-GUID": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "runAfter": {
            "define_basic_info_sheet_columns_2": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "d4375930-3c4d-472c-a8b9-7d72d1b358f5"
          },
          "type": "Scope"
        },
        "Get_a_account_by_ID": {
          "runAfter": {
            "countNumberOfAlphainClassNumber": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "bb1a479b-b31f-40f5-be89-cc058b06769e"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "GetItem",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "accounts",
              "recordId": "@triggerOutputs()?['body/_cid_company_value']"
            },
            "authentication": "@parameters('$authentication')"
          }
        },
        "Initialize_variable_-_ClassNumber": {
          "runAfter": {},
          "metadata": {
            "operationMetadataId": "335e1cf3-05de-4895-aad8-a3fcc6fe240e"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "ClassNumber",
                "type": "string",
                "value": "1.1A"
              }
            ]
          }
        },
        "Initialize_variable_Language": {
          "runAfter": {
            "Initialize_Message_Array": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "d2b5b076-4638-4722-bf77-d73e9f825659"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Language",
                "type": "string",
                "value": "@{outputs('get_contact_email')?['body/cid_languageofcorrespondence']}"
              }
            ]
          }
        },
        "check_if_language_is_null": {
          "actions": {
            "Set_variable_set_language_to_english": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "424cc111-ee2e-411b-95f1-56cd7b0c8997"
              },
              "type": "SetVariable",
              "inputs": {
                "name": "Language",
                "value": "918640001"
              }
            }
          },
          "runAfter": {
            "Initialize_Environment_folder_variable": [
              "Succeeded"
            ]
          },
          "expression": {
            "equals": [
              "@length(trim(variables('Language')))",
              0
            ]
          },
          "metadata": {
            "operationMetadataId": "04cbdb0a-9a6d-4a06-ba70-c4e67bd5e67c"
          },
          "type": "If"
        },
        "Initialize_variable-_Alph-Char": {
          "runAfter": {
            "Initialize_variable_-_ClassNumber": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "7496f90b-f1be-4d52-bb32-81c983492cf0"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "AlphaCharArray",
                "type": "array",
                "value": "@createArray('a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z')"
              }
            ]
          }
        },
        "Initialize_variable-ClassGroup": {
          "runAfter": {
            "Initialize_variable-_Alph-Char": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "c6da49bf-deb0-4c45-864d-cb601b95a6b1"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "ClassGroup",
                "type": "string"
              }
            ]
          }
        },
        "countNumberOfAlphainClassNumber": {
          "runAfter": {
            "Initialize_variable-ClassGroup": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "a04d1f7f-53cf-4961-847c-4450ca3b9bb7"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "countNumberOfAlphainClassNumber",
                "type": "integer"
              }
            ]
          }
        },
        "Error_flag": {
          "runAfter": {
            "Parse_JSON_Messages_From_Web": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "af9c01db-59f3-46fa-826e-e24fc2c82cca"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "IsErrorFree",
                "type": "boolean",
                "value": "@true"
              }
            ]
          }
        },
        "Row_Number_vailable": {
          "runAfter": {
            "Initialize_variable_Language": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "396871f6-9db7-4572-ac20-9b39cc12d51a"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "RowNumber",
                "type": "integer",
                "value": 3
              }
            ]
          }
        },
        "Error_List_Variable": {
          "runAfter": {
            "Row_Number_vailable": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "a10a3b39-9550-46b6-b00c-75dd826be0a2"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Error_List",
                "type": "array",
                "value": []
              }
            ]
          }
        },
        "Initialize_Environment_folder_variable": {
          "runAfter": {
            "Error_List_Variable": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "fc5c3dd6-8d62-49cb-befd-838a6faaacca"
          },
          "type": "InitializeVariable",
          "inputs": {
            "variables": [
              {
                "name": "Environment_Folder",
                "type": "string",
                "value": "@{body('Filter_environment-CID_Flow_Environment_Folder')[0]['qm_value']}"
              }
            ]
          }
        },
        "Filter_environment-CID_Flow_Environment_Folder": {
          "runAfter": {
            "get-environment-settings": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "0e744065-88c2-4338-956b-7400a9256a6e"
          },
          "type": "Query",
          "inputs": {
            "from": "@outputs('get-environment-settings')?['body/value']",
            "where": "@equals(item()?['qm_name'], 'CID_Flow_Environment_Folder')"
          }
        },
        "Get_Bulk_Upload_Messages": {
          "runAfter": {
            "define_extended_columns_in_excel_sheet_2": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "e6ba2658-3ccd-4e8b-9e91-5ff910d21c81"
          },
          "type": "OpenApiConnection",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps_1",
              "operationId": "ListRecords",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "entityName": "annotations",
              "fetchXml": "<fetch version=\"1.0\" output-format=\"xml-platform\" mapping=\"logical\" distinct=\"false\">\n<entity name=\"annotation\">\n<attribute name=\"subject\"/>\n<attribute name=\"notetext\"/>\n<attribute name=\"filename\"/>\n<attribute name=\"documentbody\"/>\n<attribute name=\"annotationid\"/>\n<order attribute=\"subject\" descending=\"false\"/>\n<link-entity name=\"adx_webfile\" from=\"adx_webfileid\" to=\"objectid\" link-type=\"inner\" alias=\"ab\">\n<filter type=\"and\">\n<condition attribute=\"adx_name\" operator=\"eq\" value=\"Sites_Bulk_Upload_Messages\"/>\n</filter>\n</link-entity>\n</entity>\n</fetch>"
            },
            "authentication": "@parameters('$authentication')"
          }
        },
        "Bulk-Messages-From-webFile": {
          "runAfter": {
            "Get_Bulk_Upload_Messages": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "ddf0f80b-60bc-48e8-acae-bbbf45c463c5"
          },
          "type": "Compose",
          "inputs": "@base64ToString(outputs('Get_Bulk_Upload_Messages')?['body/value'][0]['documentbody'])"
        },
        "Parse_JSON_Messages_From_Web": {
          "runAfter": {
            "Bulk-Messages-From-webFile": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "62b7748b-a94f-4e8e-8870-77fadef79885"
          },
          "type": "ParseJson",
          "inputs": {
            "content": "@outputs('Bulk-Messages-From-webFile')",
            "schema": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "code": {
                    "type": "string"
                  },
                  "Eng-Message": {
                    "type": "string"
                  },
                  "Fr-Message": {
                    "type": "string"
                  },
                  "id": {
                    "type": "string"
                  },
                  "order": {
                    "type": "string"
                  },
                  "MessageType": {
                    "type": "string"
                  },
                  "SheetNameInEnglish": {
                    "type": "string"
                  },
                  "SheetNameInFrench": {
                    "type": "string"
                  },
                  "ErrorLog": {
                    "type": "string"
                  }
                },
                "required": [
                  "code",
                  "Eng-Message",
                  "Fr-Message",
                  "id",
                  "order",
                  "MessageType",
                  "SheetNameInEnglish",
                  "SheetNameInFrench",
                  "ErrorLog"
                ]
              }
            }
          }
        },
        "For_each_site_from_http_request": {
          "foreach": "@body('Select_Site_List')",
          "actions": {
            "Current_row": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "692703f0-6bc6-4bc1-8199-14e43dfe7f6a"
              },
              "type": "Compose",
              "inputs": "@items('For_each_site_from_http_request')"
            },
            "Current_Row_number": {
              "runAfter": {
                "Current_Site_Address": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "c8231cfb-e9e8-482c-bdc3-da88465785e4"
              },
              "type": "Compose",
              "inputs": "@add( int(outputs('Current_row')['LineNumber']),5)"
            },
            "Current_Site_Address": {
              "runAfter": {
                "Current_row": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "d07cd0a9-7e62-4379-be92-c323f2fba582"
              },
              "type": "Compose",
              "inputs": "@outputs('current_row')['SiteFullAddress']"
            },
            "check_if_Extended_information_is_specified": {
              "actions": {
                "Check_if_Extended_information_specified": {
                  "actions": {
                    "check_if_site_is_extneded": {
                      "actions": {
                        "Check_if_site_exists_in_extended_table": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "3c730080-51de-459b-8861-551d06758084"
                          },
                          "type": "Query",
                          "inputs": {
                            "from": "@body('Select_extended_info')",
                            "where": "@and (equals(item()['ExtendedSite'], outputs('current_row')['SiteFullAddress']) ,  \ngreater(length(item()['ExtendedUNNumber']), 0) )"
                          }
                        },
                        "Check_if_at_least_one_Unnumber_exists_for_extended_site": {
                          "actions": {
                            "Apply_to_each_-_extended_rows_for_current_site": {
                              "foreach": "@body('Select_extended_info')",
                              "actions": {
                                "Current_extended_row": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "f25b0fe8-d1fd-40d0-b1bd-c5d88646f631"
                                  },
                                  "type": "Compose",
                                  "inputs": "@items('Apply_to_each_-_extended_rows_for_current_site')"
                                },
                                "Annual__Volume-Quantity": {
                                  "runAfter": {
                                    "Site": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "0d5a29eb-dfea-4fd2-8580-ff502eb17755"
                                  },
                                  "type": "Compose",
                                  "inputs": "@outputs('Current_extended_row')['Quantity']"
                                },
                                "Unit_of_Measure": {
                                  "runAfter": {
                                    "RowNumber": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "63ea7799-fd21-4413-a3c4-87b64d5c3658"
                                  },
                                  "type": "Compose",
                                  "inputs": "@outputs('Current_extended_row')['UnitOfMeasure']"
                                },
                                "Annual_number_of__Consignments": {
                                  "runAfter": {
                                    "Unit_of_Measure": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "ef42a387-8f12-40a2-945b-39841bc0a9a7"
                                  },
                                  "type": "Compose",
                                  "inputs": "@outputs('Current_extended_row')['AnnualNumberOfConsignment']"
                                },
                                "Check_quantity": {
                                  "actions": {},
                                  "runAfter": {
                                    "Annual_number_of__Consignments": [
                                      "Succeeded"
                                    ]
                                  },
                                  "else": {
                                    "actions": {
                                      "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors": {
                                        "runAfter": {},
                                        "metadata": {
                                          "operationMetadataId": "eeda5e90-d330-4124-9c56-2029e3095b38"
                                        },
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "IsErrorFree",
                                          "value": "@false"
                                        }
                                      },
                                      "Append_to_array_HOTI_activity_error__2": {
                                        "runAfter": {
                                          "Set_variable_Error_Message_13": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "d1467057-f7f9-4f6e-83a1-2860398aefee"
                                        },
                                        "type": "AppendToArrayVariable",
                                        "inputs": {
                                          "name": "Error_List",
                                          "value": {
                                            "SheetName": "Add Extended Info",
                                            "Row#": "@{outputs('RowNumber')}",
                                            "Site": "@{outputs('Site')}",
                                            "Error": "@{variables('Error_Message')}"
                                          }
                                        }
                                      },
                                      "Filter_array_B1030": {
                                        "runAfter": {
                                          "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                        },
                                        "type": "Query",
                                        "inputs": {
                                          "from": "@variables('Messages_Array')",
                                          "where": "@equals(item()['code'], 'B1030')"
                                        }
                                      },
                                      "Add_Bulk_Log_details_B1030": {
                                        "runAfter": {
                                          "Append_to_array_HOTI_activity_error__2": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "31afab0a-9b91-40ca-ae1a-3cd7c9aeccb2"
                                        },
                                        "type": "OpenApiConnection",
                                        "inputs": {
                                          "host": {
                                            "connectionName": "shared_commondataserviceforapps_1",
                                            "operationId": "CreateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                          },
                                          "parameters": {
                                            "entityName": "cid_bulkactivitylogsdetailses",
                                            "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                            "item/cid_errordetails": "@variables('Error_Message')",
                                            "item/cid_errorwarningcode": "B1030",
                                            "item/cid_excelcolumnname": "Quantity/Volume",
                                            "item/cid_excelrownumber": "@outputs('RowNumber')",
                                            "item/cid_excelsheetname": "Add Extended Info",
                                            "item/cid_sitelocation": "@outputs('Site')",
                                            "item/cid_type": 100000000
                                          },
                                          "authentication": "@parameters('$authentication')"
                                        }
                                      },
                                      "Set_variable_Error_Message_13": {
                                        "runAfter": {
                                          "Filter_array_B1030": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                        },
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "Error_Message",
                                          "value": "@{body('Filter_array_B1030')[0]['Message']}"
                                        }
                                      }
                                    }
                                  },
                                  "expression": {
                                    "greater": [
                                      "@length(string(outputs('Annual__Volume-Quantity')))",
                                      0
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "2ab90895-e7b6-4898-85c4-992378e704ac"
                                  },
                                  "type": "If"
                                },
                                "Check_Unit_of_measure": {
                                  "actions": {},
                                  "runAfter": {
                                    "Check_quantity": [
                                      "Succeeded"
                                    ]
                                  },
                                  "else": {
                                    "actions": {
                                      "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_3": {
                                        "runAfter": {},
                                        "metadata": {
                                          "operationMetadataId": "eeda5e90-d330-4124-9c56-2029e3095b38"
                                        },
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "IsErrorFree",
                                          "value": "@false"
                                        }
                                      },
                                      "Append_to_array_HOTI_activity_error__5": {
                                        "runAfter": {
                                          "Set_variable_Error_Message_14": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "d1467057-f7f9-4f6e-83a1-2860398aefee"
                                        },
                                        "type": "AppendToArrayVariable",
                                        "inputs": {
                                          "name": "Error_List",
                                          "value": {
                                            "SheetName": "Add Extended Info",
                                            "Row#": "@{outputs('RowNumber')}",
                                            "Site": "@{outputs('Site')}",
                                            "Error": "@{variables('Error_Message')}"
                                          }
                                        }
                                      },
                                      "Filter_array_B1031": {
                                        "runAfter": {
                                          "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_3": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                        },
                                        "type": "Query",
                                        "inputs": {
                                          "from": "@variables('Messages_Array')",
                                          "where": "@equals(item()['code'], 'B1031')"
                                        }
                                      },
                                      "Add_Bulk_Log_details_B1031": {
                                        "runAfter": {
                                          "Append_to_array_HOTI_activity_error__5": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "31afab0a-9b91-40ca-ae1a-3cd7c9aeccb2"
                                        },
                                        "type": "OpenApiConnection",
                                        "inputs": {
                                          "host": {
                                            "connectionName": "shared_commondataserviceforapps_1",
                                            "operationId": "CreateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                          },
                                          "parameters": {
                                            "entityName": "cid_bulkactivitylogsdetailses",
                                            "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                            "item/cid_errordetails": "@variables('Error_Message')",
                                            "item/cid_errorwarningcode": "B1031",
                                            "item/cid_excelcolumnname": "Unit of Measure Per UN #",
                                            "item/cid_excelrownumber": "@outputs('RowNumber')",
                                            "item/cid_excelsheetname": "Add Extended Info",
                                            "item/cid_sitelocation": "@outputs('Site')",
                                            "item/cid_type": 100000000
                                          },
                                          "authentication": "@parameters('$authentication')"
                                        }
                                      },
                                      "Set_variable_Error_Message_14": {
                                        "runAfter": {
                                          "Filter_array_B1031": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                        },
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "Error_Message",
                                          "value": "@{body('Filter_array_B1031')[0]['Message']}"
                                        }
                                      }
                                    }
                                  },
                                  "expression": {
                                    "greater": [
                                      "@length(string(outputs('Unit_of_Measure')))",
                                      0
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "2ab90895-e7b6-4898-85c4-992378e704ac"
                                  },
                                  "type": "If"
                                },
                                "Check_Annual_number_of__Consignments": {
                                  "actions": {},
                                  "runAfter": {
                                    "Check_Unit_of_measure": [
                                      "Succeeded"
                                    ]
                                  },
                                  "else": {
                                    "actions": {
                                      "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_4": {
                                        "runAfter": {},
                                        "metadata": {
                                          "operationMetadataId": "eeda5e90-d330-4124-9c56-2029e3095b38"
                                        },
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "IsErrorFree",
                                          "value": "@false"
                                        }
                                      },
                                      "Append_to_array_HOTI_activity_error__3": {
                                        "runAfter": {
                                          "Set_variable_Error_Message_15": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "d1467057-f7f9-4f6e-83a1-2860398aefee"
                                        },
                                        "type": "AppendToArrayVariable",
                                        "inputs": {
                                          "name": "Error_List",
                                          "value": {
                                            "SheetName": "Add Extended Info",
                                            "Row#": "@{outputs('RowNumber')}",
                                            "Site": "@{outputs('Site')}",
                                            "Error": "@{variables('Error_Message')}"
                                          }
                                        }
                                      },
                                      "Filter_array_B1032": {
                                        "runAfter": {
                                          "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_4": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                        },
                                        "type": "Query",
                                        "inputs": {
                                          "from": "@variables('Messages_Array')",
                                          "where": "@equals(item()['code'], 'B1032')"
                                        }
                                      },
                                      "Set_variable_Error_Message_15": {
                                        "runAfter": {
                                          "Filter_array_B1032": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                        },
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "Error_Message",
                                          "value": "@{body('Filter_array_B1032')[0]['Message']}"
                                        }
                                      },
                                      "Add_Bulk_Log_details_B1032": {
                                        "runAfter": {
                                          "Append_to_array_HOTI_activity_error__3": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "31afab0a-9b91-40ca-ae1a-3cd7c9aeccb2"
                                        },
                                        "type": "OpenApiConnection",
                                        "inputs": {
                                          "host": {
                                            "connectionName": "shared_commondataserviceforapps_1",
                                            "operationId": "CreateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                          },
                                          "parameters": {
                                            "entityName": "cid_bulkactivitylogsdetailses",
                                            "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                            "item/cid_errordetails": "@variables('Error_Message')",
                                            "item/cid_errorwarningcode": "B1032",
                                            "item/cid_excelcolumnname": "Annual # of Consignments ",
                                            "item/cid_excelrownumber": "@outputs('RowNumber')",
                                            "item/cid_excelsheetname": "Add Extended Info",
                                            "item/cid_sitelocation": "@outputs('Site')",
                                            "item/cid_type": 100000000
                                          },
                                          "authentication": "@parameters('$authentication')"
                                        }
                                      }
                                    }
                                  },
                                  "expression": {
                                    "greater": [
                                      "@length(string(outputs('Annual_number_of__Consignments')))",
                                      0
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "2ab90895-e7b6-4898-85c4-992378e704ac"
                                  },
                                  "type": "If"
                                },
                                "RowNumber": {
                                  "runAfter": {
                                    "Annual__Volume-Quantity": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "1d7f7640-ce2c-4ad9-9b47-270993d7b4f6"
                                  },
                                  "type": "Compose",
                                  "inputs": "@add( int(outputs('Current_extended_row')['LinNumber']), 5)"
                                },
                                "Site": {
                                  "runAfter": {
                                    "Current_extended_row": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "61796b69-662d-48b5-9067-a5cee179fe74"
                                  },
                                  "type": "Compose",
                                  "inputs": "@outputs('Current_extended_row')['ExtendedSite']"
                                }
                              },
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "b585958a-b648-4adc-83e3-6e8e27fc16d6"
                              },
                              "type": "Foreach"
                            }
                          },
                          "runAfter": {
                            "Check_if_site_exists_in_extended_table": [
                              "Succeeded"
                            ]
                          },
                          "else": {
                            "actions": {
                              "Set_variable_IsErrorFree_to_false_for_Missing_at_least_one_extended_UN_number": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "eeda5e90-d330-4124-9c56-2029e3095b38"
                                },
                                "type": "SetVariable",
                                "inputs": {
                                  "name": "IsErrorFree",
                                  "value": "@false"
                                }
                              },
                              "Append_to_array_-_At_least_one_UN_number_for_extended_site": {
                                "runAfter": {
                                  "Set_variable_Error_Message_12": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "9b195654-ca8f-4757-886a-d4617627de53"
                                },
                                "type": "AppendToArrayVariable",
                                "inputs": {
                                  "name": "Error_List",
                                  "value": {
                                    "SheetName": "Add Basic Info",
                                    "Row#": "@{outputs('Current_Row_number')}",
                                    "Site": "@{outputs('Current_Site_Address')}",
                                    "Error": "@{variables('Error_Message')}"
                                  }
                                }
                              },
                              "Filter_array_B1028": {
                                "runAfter": {
                                  "Set_variable_IsErrorFree_to_false_for_Missing_at_least_one_extended_UN_number": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                },
                                "type": "Query",
                                "inputs": {
                                  "from": "@variables('Messages_Array')",
                                  "where": "@equals(item()['code'], 'B1028')"
                                }
                              },
                              "Set_variable_Error_Message_12": {
                                "runAfter": {
                                  "Filter_array_B1028": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                },
                                "type": "SetVariable",
                                "inputs": {
                                  "name": "Error_Message",
                                  "value": "@{body('Filter_array_B1028')[0]['Message']}"
                                }
                              },
                              "Add_Bulk_Log_details_B1028": {
                                "runAfter": {
                                  "Append_to_array_-_At_least_one_UN_number_for_extended_site": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "3a815e5b-d3d6-46a0-b695-e2fea7723193"
                                },
                                "type": "OpenApiConnection",
                                "inputs": {
                                  "host": {
                                    "connectionName": "shared_commondataserviceforapps_1",
                                    "operationId": "CreateRecord",
                                    "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                  },
                                  "parameters": {
                                    "entityName": "cid_bulkactivitylogsdetailses",
                                    "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                    "item/cid_errordetails": "@variables('Error_Message')",
                                    "item/cid_errorwarningcode": "B1028",
                                    "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                    "item/cid_excelsheetname": "Add Basic Info",
                                    "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                    "item/cid_type": 100000000
                                  },
                                  "authentication": "@parameters('$authentication')"
                                }
                              }
                            }
                          },
                          "expression": {
                            "greater": [
                              "@length(body('Check_if_site_exists_in_extended_table'))",
                              0
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "2ab90895-e7b6-4898-85c4-992378e704ac"
                          },
                          "type": "If"
                        }
                      },
                      "runAfter": {},
                      "expression": {
                        "or": [
                          {
                            "equals": [
                              "@outputs('current_row')['extendedYN']",
                              "Yes"
                            ]
                          },
                          {
                            "equals": [
                              "@outputs('current_row')['extendedYN']",
                              "oui"
                            ]
                          }
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "5ef93ea8-33d9-4c86-afa0-b34fc5c07991"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {},
                  "else": {
                    "actions": {
                      "Set_variable_IsErrorFree_to_false_for_extended_info_column": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "aae50206-625b-41ca-9a89-423723eb8ce8"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "IsErrorFree",
                          "value": "@false"
                        }
                      },
                      "Filter_array_B1026": {
                        "runAfter": {
                          "Set_variable_IsErrorFree_to_false_for_extended_info_column": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                        },
                        "type": "Query",
                        "inputs": {
                          "from": "@variables('Messages_Array')",
                          "where": "@equals(item()['code'], 'B1026')"
                        }
                      },
                      "Set_variable_Error_Message_11": {
                        "runAfter": {
                          "Filter_array_B1026": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "Error_Message",
                          "value": "@{body('Filter_array_B1026')[0]['Message']}"
                        }
                      },
                      "Append_to_array_variable_-_Extended_column_empty": {
                        "runAfter": {
                          "Set_variable_Error_Message_11": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "4f55e617-31bd-44ed-bb0a-b526c97f332f"
                        },
                        "type": "AppendToArrayVariable",
                        "inputs": {
                          "name": "Error_List",
                          "value": {
                            "SheetName": "Add Basic Info",
                            "Row#": "@{outputs('Current_Row_number')}",
                            "Site": "@{outputs('Current_Site_Address')}",
                            "Error": "@{variables('Error_Message')}"
                          }
                        }
                      },
                      "Add_Bulk_Log_details_B1026": {
                        "runAfter": {
                          "Append_to_array_variable_-_Extended_column_empty": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "8af86261-ffd1-4944-9f70-3fca7af3b639"
                        },
                        "type": "OpenApiConnection",
                        "inputs": {
                          "host": {
                            "connectionName": "shared_commondataserviceforapps_1",
                            "operationId": "CreateRecord",
                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                          },
                          "parameters": {
                            "entityName": "cid_bulkactivitylogsdetailses",
                            "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                            "item/cid_errordetails": "@variables('Error_Message')",
                            "item/cid_errorwarningcode": "B1026",
                            "item/cid_excelcolumnname": "Extended Site?",
                            "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                            "item/cid_excelsheetname": "Add Basic Info",
                            "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                            "item/cid_type": 100000000
                          },
                          "authentication": "@parameters('$authentication')"
                        }
                      }
                    }
                  },
                  "expression": {
                    "and": [
                      {
                        "greater": [
                          "@length(outputs('current_row')['extendedYN'])",
                          0
                        ]
                      },
                      {
                        "equals": [
                          1,
                          2
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "d57040f2-d836-43ba-82ee-4dabea0b72c7"
                  },
                  "type": "If"
                }
              },
              "runAfter": {
                "Check_HOTI_activities": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "d6e81ca0-f205-43e3-a52f-8b3fa2b64ca8"
              },
              "type": "Scope"
            },
            "Class_Check_Logic": {
              "actions": {
                "Validate_Class": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "d187d377-b0b0-451d-807d-778c5f6062b1"
                  },
                  "type": "OpenApiConnection",
                  "inputs": {
                    "host": {
                      "connectionName": "shared_commondataserviceforapps_1",
                      "operationId": "PerformUnboundAction",
                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                    },
                    "parameters": {
                      "actionName": "cid_CID_BulkUpload_Validate_ClassDivision",
                      "item/Language": "@variables('Language')",
                      "item/SiteInfo": "@outputs('Current_row')",
                      "item/MessageList": "@body('Parse_Messages_to_JSON')",
                      "item/ClassList": "@outputs('List-rows-division-classes')?['body']['value']"
                    },
                    "authentication": "@parameters('$authentication')"
                  }
                },
                "check_if_error_found": {
                  "actions": {
                    "Set_variable_isErrorFree_false": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "b7b2bd46-8af9-49a7-9d4d-94935a8a52cb"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "IsErrorFree",
                        "value": "@false"
                      }
                    },
                    "Add_Bulk_Log_details_B1024-B1025": {
                      "runAfter": {
                        "Append_to_array_variable": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "6400dadc-a966-4c90-a510-2232709a5494"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps_1",
                          "operationId": "CreateRecord",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "cid_bulkactivitylogsdetailses",
                          "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                          "item/cid_errordetails": "@body('Parse_JSON_ErrorList')?['Error']",
                          "item/cid_errorwarningcode": "@outputs('Validate_Class')?['body/ErrorCode']",
                          "item/cid_excelcolumnname": "Class",
                          "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                          "item/cid_excelsheetname": "Add Basic Info",
                          "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                          "item/cid_type": 100000000
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    },
                    "Parse_JSON_ErrorList": {
                      "runAfter": {
                        "Set_variable_isErrorFree_false": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "2c61b077-5461-4ecf-ab87-42ef66a0e4de"
                      },
                      "type": "ParseJson",
                      "inputs": {
                        "content": "@outputs('Validate_Class')?['body/ErrorList']",
                        "schema": {
                          "type": "object",
                          "properties": {
                            "SheetName": {
                              "type": "string"
                            },
                            "Row#": {
                              "type": "string"
                            },
                            "Site": {
                              "type": "string"
                            },
                            "Error": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "Append_to_array_variable": {
                      "runAfter": {
                        "Parse_JSON_ErrorList": [
                          "Succeeded"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "3c6a8e4a-648b-4317-b99e-f2cb63f87df5"
                      },
                      "type": "AppendToArrayVariable",
                      "inputs": {
                        "name": "Error_List",
                        "value": "@body('Parse_JSON_ErrorList')"
                      }
                    }
                  },
                  "runAfter": {
                    "Validate_Class": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "equals": [
                      "@outputs('Validate_Class')?['body/ErrorFound']",
                      "@true"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "d1ed63ac-4fd0-4851-9a51-b4a823c508f4"
                  },
                  "type": "If"
                }
              },
              "runAfter": {
                "Current_Row_number": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "535fc6fd-165b-4dcb-b9c3-e2af382e3a6f"
              },
              "type": "Scope"
            },
            "Check_if_all_required_address_information_is_entered": {
              "actions": {
                "Increment_RowNumber_2": {
                  "runAfter": {},
                  "metadata": {
                    "operationMetadataId": "ac6b817e-3c8a-4720-89f6-1e0f1734fab5"
                  },
                  "type": "IncrementVariable",
                  "inputs": {
                    "name": "RowNumber",
                    "value": 1
                  }
                },
                "Filter_array_-_Check_address_by_address_,_city_,_and_province": {
                  "runAfter": {
                    "Increment_RowNumber_2": [
                      "Succeeded"
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "cb6ac0c8-ddde-45cd-b7c0-2d89c9b0c0d2"
                  },
                  "type": "Query",
                  "inputs": {
                    "from": "@outputs('List_All_Accounts')?['body/value']",
                    "where": "@and(equals(length(string(outputs('current_row')['SiteGUID'])),0) , equals(item()?['address1_line1'], toUpper(outputs('current_row')['Address1'])),\nequals(item()?['address1_city'], toUpper(outputs('current_row')['City'])), \nequals(item()?['address1_stateorprovince'], toUpper(outputs('current_row')['Province'])))"
                  }
                },
                "Check_if_address_exists_in_the_database": {
                  "actions": {
                    "Set_is_error_free_to_false_2": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "876cbe4c-cf79-41cb-9c82-008a32a55d8c"
                      },
                      "type": "SetVariable",
                      "inputs": {
                        "name": "IsErrorFree",
                        "value": "@false"
                      }
                    },
                    "Check_if_belong_to_account_2": {
                      "actions": {
                        "Site_Already_exist_2": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "a873dcdb-5ed2-41ec-8630-dd79461986d5"
                          },
                          "type": "AppendToArrayVariable",
                          "inputs": {
                            "name": "Error_List",
                            "value": {
                              "SheetName": "Add Basic Info",
                              "Row#": "@{outputs('Current_Row_number')}",
                              "Site": "@{outputs('Current_Site_Address')}",
                              "Error": "Site Already Exists, please use the update process to update site information"
                            }
                          }
                        }
                      },
                      "runAfter": {
                        "Set_is_error_free_to_false_2": [
                          "Succeeded"
                        ]
                      },
                      "else": {
                        "actions": {
                          "Append_to_array_-_site_belong_to_another_account_2": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "0721f40e-9313-4b23-ac3a-e7e03fce1613"
                            },
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "Error_List",
                              "value": {
                                "SheetName": "Add Basic Info",
                                "Row#": "@{outputs('Current_Row_number')}",
                                "Site": "@{outputs('Current_Site_Address')}",
                                "Error": "Site belong to another Company please go thorugh the claim process"
                              }
                            }
                          }
                        }
                      },
                      "expression": {
                        "equals": [
                          "@first(body('Filter_array_-_Check_address_by_address_,_city_,_and_province'))?['parentaccountid']?['accountid']",
                          "@triggerBody()?['accountid']"
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "16b3e2fe-c1c8-41e0-84b0-5630c2ed22a9"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {
                    "Filter_array_-_Check_address_by_address_,_city_,_and_province": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "greater": [
                      "@length(body('Filter_array_-_Check_address_by_address_,_city_,_and_province'))",
                      0
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "c06dbc9d-12fe-441b-8c8d-4ca616d3d7bf"
                  },
                  "type": "If"
                },
                "Check_lat_and_long_is_entered": {
                  "actions": {
                    "Filter_array_-_Check_address_by_Lat_and_Long": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "cb6ac0c8-ddde-45cd-b7c0-2d89c9b0c0d2"
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@outputs('List_All_Accounts')?['body/value']",
                        "where": "@and(\nequals(item()?['address1_latitude'], outputs('current_row')['Lat']), \nequals(item()?['address1_longitude'], outputs('current_row')['Long'])\n)"
                      }
                    },
                    "Check_if_Lat_and_Long_already_exists": {
                      "actions": {
                        "Set_variable_error_free_B1022": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "3e23e089-210a-4907-8ba3-fb9fc8b12b3d"
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "IsErrorFree",
                            "value": "@false"
                          }
                        },
                        "Filter_array_B1022": {
                          "runAfter": {
                            "Set_variable_error_free_B1022": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                          },
                          "type": "Query",
                          "inputs": {
                            "from": "@variables('Messages_Array')",
                            "where": "@equals(item()['code'], 'B1022')"
                          }
                        },
                        "Set_variable_Error_Message_B1022": {
                          "runAfter": {
                            "Filter_array_B1022": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "Error_Message",
                            "value": "@{body('Filter_array_B1022')[0]['Message']}"
                          }
                        },
                        "Append_to_array_-_B1022": {
                          "runAfter": {
                            "Set_variable_Error_Message_B1022": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "0721f40e-9313-4b23-ac3a-e7e03fce1613"
                          },
                          "type": "AppendToArrayVariable",
                          "inputs": {
                            "name": "Error_List",
                            "value": {
                              "SheetName": "Add Basic Info",
                              "Row#": "@{outputs('Current_Row_number')}",
                              "Site": "@{outputs('Current_Site_Address')}",
                              "Error": "@{variables('Error_Message')}"
                            }
                          }
                        },
                        "Add_Bulk_Log_details_B1022": {
                          "runAfter": {
                            "Append_to_array_-_B1022": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "7bd2c7c8-5212-4031-85a3-3de92b775314"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps_1",
                              "operationId": "CreateRecord",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "cid_bulkactivitylogsdetailses",
                              "item/cid_BulkActivityLogSummary@odata.bind": "@outputs('Get_bulk_activities_log_summary_by_ID')?['body/cid_bulkactivitylogsummaryid']",
                              "item/cid_errordetails": "@variables('Error_Message')",
                              "item/cid_errorwarningcode": "B1022",
                              "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                              "item/cid_excelsheetname": "Add Basic Info",
                              "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                              "item/cid_type": 100000000
                            },
                            "authentication": "@parameters('$authentication')"
                          }
                        }
                      },
                      "runAfter": {
                        "Filter_array_-_Check_address_by_Lat_and_Long": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "greater": [
                          "@length(body('Filter_array_-_Check_address_by_Lat_and_Long'))",
                          0
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "d7e399d1-4f8a-41a9-8794-90af77dd6e57"
                      },
                      "type": "If"
                    }
                  },
                  "runAfter": {
                    "Check_Legal_Land_description_": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "and": [
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['Lat']))",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['Long']))",
                          0
                        ]
                      },
                      {
                        "lessOrEquals": [
                          "@length(string(outputs('current_row')['SiteGUID']))",
                          0
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "13085156-71dc-4e0a-9271-2067f2045a7c"
                  },
                  "type": "If"
                },
                "Check_Legal_Land_description_": {
                  "actions": {
                    "Check_if_Legal_land_description_already_exists": {
                      "actions": {
                        "Set_variable_error_free_B1019": {
                          "runAfter": {},
                          "metadata": {
                            "operationMetadataId": "3e23e089-210a-4907-8ba3-fb9fc8b12b3d"
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "IsErrorFree",
                            "value": "@false"
                          }
                        },
                        "Filter_array_B1019": {
                          "runAfter": {
                            "Set_variable_error_free_B1019": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                          },
                          "type": "Query",
                          "inputs": {
                            "from": "@variables('Messages_Array')",
                            "where": "@equals(item()['code'], 'B1022')"
                          }
                        },
                        "Set_variable_Error_Message_B1019": {
                          "runAfter": {
                            "Filter_array_B1019": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                          },
                          "type": "SetVariable",
                          "inputs": {
                            "name": "Error_Message",
                            "value": "@{body('Filter_array_B1019')[0]['Message']}"
                          }
                        },
                        "Append_to_array_-_B1019": {
                          "runAfter": {
                            "Set_variable_Error_Message_B1019": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "0721f40e-9313-4b23-ac3a-e7e03fce1613"
                          },
                          "type": "AppendToArrayVariable",
                          "inputs": {
                            "name": "Error_List",
                            "value": {
                              "SheetName": "Add Basic Info",
                              "Row#": "@{outputs('Current_Row_number')}",
                              "Site": "@{outputs('Current_Site_Address')}",
                              "Error": "@{variables('Error_Message')}"
                            }
                          }
                        },
                        "Add_Bulk_Log_details_B1019": {
                          "runAfter": {
                            "Append_to_array_-_B1019": [
                              "Succeeded"
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "7bd2c7c8-5212-4031-85a3-3de92b775314"
                          },
                          "type": "OpenApiConnection",
                          "inputs": {
                            "host": {
                              "connectionName": "shared_commondataserviceforapps_1",
                              "operationId": "CreateRecord",
                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                            },
                            "parameters": {
                              "entityName": "cid_bulkactivitylogsdetailses",
                              "item/cid_BulkActivityLogSummary@odata.bind": "@outputs('Get_bulk_activities_log_summary_by_ID')?['body/cid_bulkactivitylogsummaryid']",
                              "item/cid_errordetails": "@variables('Error_Message')",
                              "item/cid_errorwarningcode": "B1019",
                              "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                              "item/cid_excelsheetname": "Add Basic Info",
                              "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                              "item/cid_type": 100000000
                            },
                            "authentication": "@parameters('$authentication')"
                          }
                        }
                      },
                      "runAfter": {
                        "Filter_array_-_Check_address_by_Legal_land_description": [
                          "Succeeded"
                        ]
                      },
                      "expression": {
                        "greater": [
                          "@length(body('Filter_array_-_Check_address_by_Legal_land_description'))",
                          0
                        ]
                      },
                      "metadata": {
                        "operationMetadataId": "109a3c27-c25a-444b-9204-3d8cae3fb146"
                      },
                      "type": "If"
                    },
                    "Filter_array_-_Check_address_by_Legal_land_description": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "cb6ac0c8-ddde-45cd-b7c0-2d89c9b0c0d2"
                      },
                      "type": "Query",
                      "inputs": {
                        "from": "@outputs('List_All_Accounts')?['body/value']",
                        "where": "@and\n(\nequals(item()?['ovs_lld_quarter@OData.Community.Display.V1.FormattedValue'], toUpper(string(outputs('current_row')['Quarter']))),\nequals(item()?['ovs_lld_section@OData.Community.Display.V1.FormattedValue'], toUpper(string(outputs('current_row')['Section']))),\nequals(item()?['ovs_lld_township@OData.Community.Display.V1.FormattedValue'],toUpper(string(outputs('current_row')['TownShip']))),\nequals(item()?['ovs_lld_range@OData.Community.Display.V1.FormattedValue'],toUpper(string(outputs('current_row')['Range']))) ,\nequals(item()?['ovs_lld_meridian@OData.Community.Display.V1.FormattedValue'], string(outputs('current_row')['Meridian']))\n)"
                      }
                    }
                  },
                  "runAfter": {
                    "Check_if_address_exists_in_the_database": [
                      "Succeeded"
                    ]
                  },
                  "expression": {
                    "and": [
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['Section']))",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['TownShip']))",
                          0
                        ]
                      },
                      {
                        "lessOrEquals": [
                          "@length(string(outputs('current_row')['SiteGUID']))",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['Range']))",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['Meridian']))",
                          0
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "13085156-71dc-4e0a-9271-2067f2045a7c"
                  },
                  "type": "If"
                }
              },
              "runAfter": {
                "Class_Check_Logic": [
                  "Succeeded"
                ]
              },
              "else": {
                "actions": {
                  "Check_if_Missing_in_postal_address_A1": {
                    "actions": {
                      "Check_Address_1": {
                        "actions": {
                          "Filter_array_B1010": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@variables('Messages_Array')",
                              "where": "@equals(item()['code'], 'B1010')"
                            }
                          },
                          "Append_to_array_variable_4_Errorlist": {
                            "runAfter": {
                              "Set_variable_Error_Message": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                            },
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "Error_List",
                              "value": {
                                "SheetName": "Add Basic Info",
                                "Row#": "@{outputs('Current_Row_number')}",
                                "Site": "@{outputs('Current_Site_Address')}",
                                "Error": "@{variables('Error_Message')}"
                              }
                            }
                          },
                          "Set_variable_Error_Message": {
                            "runAfter": {
                              "Filter_array_B1010": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "Error_Message",
                              "value": "@{body('Filter_array_B1010')[0]['Message']}"
                            }
                          },
                          "Add_Bulk_Log_details_B1010": {
                            "runAfter": {
                              "Filter_Messages_to_log_in_bulk_log_details_B1010": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "7844857d-df1b-4017-be08-95e05a95ec4e"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps_1",
                                "operationId": "CreateRecord",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "cid_bulkactivitylogsdetailses",
                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1010')[0]['Eng-Message']",
                                "item/cid_errorwarningcode": "B1010",
                                "item/cid_excelcolumnname": "Address 1",
                                "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                "item/cid_excelsheetname": "Add Basic Info",
                                "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                "item/cid_type": 100000000
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          },
                          "Filter_Messages_to_log_in_bulk_log_details_B1010": {
                            "runAfter": {
                              "Append_to_array_variable_4_Errorlist": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "e755b2d8-176c-430f-a770-26ce12d5e32a"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@body('Parse_Messages_to_JSON')",
                              "where": "@equals(item()['code'], 'B1010')"
                            }
                          }
                        },
                        "runAfter": {},
                        "expression": {
                          "lessOrEquals": [
                            "@length(outputs('current_row')['Address1'])",
                            0
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                        },
                        "type": "If"
                      },
                      "Check_province": {
                        "actions": {
                          "Filter_array_B1008": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "2caa6a21-68b2-44eb-bf7f-0da00ee065e8"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@variables('Messages_Array')",
                              "where": "@equals(item()['code'], 'B1008')"
                            }
                          },
                          "Append_to_array_variable_4_Errorlist_2": {
                            "runAfter": {
                              "Set_variable_Error_Message_Province": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "09ced01c-ef78-46c4-8f5f-246682477e1c"
                            },
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "Error_List",
                              "value": {
                                "SheetName": "Add Basic Info",
                                "Row#": "@{outputs('Current_Row_number')}",
                                "Site": "@{outputs('Current_Site_Address')}",
                                "Error": "@{variables('Error_Message')}"
                              }
                            }
                          },
                          "Set_variable_Error_Message_Province": {
                            "runAfter": {
                              "Filter_array_B1008": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "f793fce8-1f1d-445e-9c2a-34ae47a340d2"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "Error_Message",
                              "value": "@{body('Filter_array_B1008')[0]['Message']}"
                            }
                          },
                          "Filter_Messages_to_log_in_bulk_log_details_B1008": {
                            "runAfter": {
                              "Append_to_array_variable_4_Errorlist_2": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "1745f3d3-5a58-490f-89f1-50726059ca12"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@body('Parse_Messages_to_JSON')",
                              "where": "@equals(item()['code'], 'B1008')"
                            }
                          },
                          "Add_Bulk_Log_details_B1008": {
                            "runAfter": {
                              "Filter_Messages_to_log_in_bulk_log_details_B1008": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "c9eac902-da6f-42dc-839c-d11d5d9900b0"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps_1",
                                "operationId": "CreateRecord",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "cid_bulkactivitylogsdetailses",
                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1008')[0]['Eng-Message']",
                                "item/cid_errorwarningcode": "B1008",
                                "item/cid_excelcolumnname": "Province",
                                "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                "item/cid_excelsheetname": "Add Basic Info",
                                "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                "item/cid_type": 100000000
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          }
                        },
                        "runAfter": {
                          "check_if_city_exists": [
                            "Succeeded"
                          ]
                        },
                        "expression": {
                          "lessOrEquals": [
                            "@length(outputs('current_row')['Province'])",
                            0
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "72ffeacd-d72b-4874-b2b7-ef368375f998"
                        },
                        "type": "If"
                      },
                      "Check_PostalCode": {
                        "actions": {
                          "Filter_array_B1009": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "3f29ab51-bf71-47bb-a55a-6a2948100237"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@variables('Messages_Array')",
                              "where": "@equals(item()['code'], 'B1009')"
                            }
                          },
                          "Append_to_array_variable_error_Postal_code_missing": {
                            "runAfter": {
                              "Set_variable_Error_Message_Postalcode": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "35bde0e4-44ee-43ee-a978-b15ef18f851b"
                            },
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "Error_List",
                              "value": {
                                "SheetName": "Add Basic Info",
                                "Row#": "@{outputs('Current_Row_number')}",
                                "Site": "@{outputs('Current_Site_Address')}",
                                "Error": "@{variables('Error_Message')}"
                              }
                            }
                          },
                          "Set_variable_Error_Message_Postalcode": {
                            "runAfter": {
                              "Filter_array_B1009": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "1c699dd5-f727-43e8-98d7-ee042d5c3ae6"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "Error_Message",
                              "value": "@{body('Filter_array_B1009')[0]['Message']}"
                            }
                          },
                          "Filter_Messages_to_log_in_bulk_log_details_B1009": {
                            "runAfter": {
                              "Append_to_array_variable_error_Postal_code_missing": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "bba06d84-3400-423d-aee0-c390c43b8cf7"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@body('Parse_Messages_to_JSON')",
                              "where": "@equals(item()['code'], 'B1009')"
                            }
                          },
                          "Add_Bulk_Log_details_Bulk004": {
                            "runAfter": {
                              "Filter_Messages_to_log_in_bulk_log_details_B1009": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "2975a8d4-8d76-4818-b78e-6d8a4d597e72"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps_1",
                                "operationId": "CreateRecord",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "cid_bulkactivitylogsdetailses",
                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1009')[0]['Eng-Message']",
                                "item/cid_errorwarningcode": "B1009",
                                "item/cid_excelcolumnname": "Postal Code",
                                "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                "item/cid_excelsheetname": "Add Basic Info",
                                "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                "item/cid_type": 100000000
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          }
                        },
                        "runAfter": {
                          "Check_province": [
                            "Succeeded"
                          ]
                        },
                        "expression": {
                          "lessOrEquals": [
                            "@length(outputs('current_row')['PostalCode'])",
                            0
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "781d35d3-8a91-434d-92f6-57180284f526"
                        },
                        "type": "If"
                      },
                      "Check_City": {
                        "actions": {
                          "Filter_array_B1029": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "3f29ab51-bf71-47bb-a55a-6a2948100237"
                            },
                            "type": "Query",
                            "inputs": {
                              "from": "@variables('Messages_Array')",
                              "where": "@equals(item()['code'], 'B1029')"
                            }
                          },
                          "Append_to_array_variable_error_Postal_code_missing_2": {
                            "runAfter": {
                              "Set_variable_Error_Message_City": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "35bde0e4-44ee-43ee-a978-b15ef18f851b"
                            },
                            "type": "AppendToArrayVariable",
                            "inputs": {
                              "name": "Error_List",
                              "value": {
                                "SheetName": "Add Basic Info",
                                "Row#": "@{outputs('Current_Row_number')}",
                                "Site": "@{outputs('Current_Site_Address')}",
                                "Error": "@{variables('Error_Message')}"
                              }
                            }
                          },
                          "Set_variable_Error_Message_City": {
                            "runAfter": {
                              "Filter_array_B1029": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "1c699dd5-f727-43e8-98d7-ee042d5c3ae6"
                            },
                            "type": "SetVariable",
                            "inputs": {
                              "name": "Error_Message",
                              "value": "@{body('Filter_array_B1029')[0]['Message']}"
                            }
                          },
                          "Add_Bulk_Log_details_B1029": {
                            "runAfter": {
                              "Append_to_array_variable_error_Postal_code_missing_2": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "2975a8d4-8d76-4818-b78e-6d8a4d597e72"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps_1",
                                "operationId": "CreateRecord",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "cid_bulkactivitylogsdetailses",
                                "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                "item/cid_errordetails": "@variables('Error_Message')",
                                "item/cid_errorwarningcode": "B1029",
                                "item/cid_excelcolumnname": "Postal Code",
                                "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                "item/cid_excelsheetname": "Add Basic Info",
                                "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                "item/cid_type": 100000000
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          }
                        },
                        "runAfter": {
                          "Check_PostalCode": [
                            "Succeeded"
                          ]
                        },
                        "expression": {
                          "lessOrEquals": [
                            "@length(outputs('current_row')['City'])",
                            0
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "781d35d3-8a91-434d-92f6-57180284f526"
                        },
                        "type": "If"
                      },
                      "check_if_city_exists": {
                        "actions": {
                          "Check_if_City_spelling_is_correct_and_province_match_is_correct_2": {
                            "actions": {
                              "Province_2": {
                                "runAfter": {},
                                "metadata": {
                                  "operationMetadataId": "7eab0b76-4c57-41ae-b81a-9d1db24be760"
                                },
                                "type": "Compose",
                                "inputs": "@outputs('current_row')['Province']"
                              },
                              "Get_call_Canada_Geo_Api_to_get_province_2": {
                                "runAfter": {
                                  "Province_2": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "775597cd-69c2-45a3-b4d4-87e01b072cda"
                                },
                                "type": "Http",
                                "inputs": {
                                  "method": "GET",
                                  "uri": "https://geogratis.gc.ca/services/geoname/en/geonames.json?q=@{Trim(toLower(outputs('current_row')['City']))}",
                                  "headers": {
                                    "accept": "application/json"
                                  }
                                }
                              },
                              "check_if_city_is_correct_2": {
                                "actions": {
                                  "Get_Province_Code_from_Province_Array_2": {
                                    "runAfter": {},
                                    "metadata": {
                                      "operationMetadataId": "0b56a4be-ee78-4da6-b112-67912d00a444"
                                    },
                                    "type": "Compose",
                                    "inputs": "@variables('ProvinceCodes')[outputs('Province_2')]"
                                  },
                                  "Filter_Api_result_2": {
                                    "runAfter": {
                                      "Get_Province_Code_from_Province_Array_2": [
                                        "Succeeded"
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "d05bd343-f426-4584-b99f-98ede8fd25a4"
                                    },
                                    "type": "Query",
                                    "inputs": {
                                      "from": "@body('Get_call_Canada_Geo_Api_to_get_province_2')['items']",
                                      "where": "@contains(item()['Province']['code'], outputs('Get_Province_Code_from_Province_Array_2'))"
                                    }
                                  },
                                  "Check_if_province_match_with_city_2": {
                                    "actions": {},
                                    "runAfter": {
                                      "Filter_Api_result_2": [
                                        "Succeeded"
                                      ]
                                    },
                                    "else": {
                                      "actions": {
                                        "Set_is_error_free_to_false_for_city_match_with_province_2": {
                                          "runAfter": {},
                                          "metadata": {
                                            "operationMetadataId": "876cbe4c-cf79-41cb-9c82-008a32a55d8c"
                                          },
                                          "type": "SetVariable",
                                          "inputs": {
                                            "name": "IsErrorFree",
                                            "value": "@true"
                                          }
                                        },
                                        "Append_to_array_-_City_doesn't_belong_to_province": {
                                          "runAfter": {
                                            "Set_variable_Error_Message_8": [
                                              "Succeeded"
                                            ]
                                          },
                                          "metadata": {
                                            "operationMetadataId": "0721f40e-9313-4b23-ac3a-e7e03fce1613"
                                          },
                                          "type": "AppendToArrayVariable",
                                          "inputs": {
                                            "name": "Error_List",
                                            "value": {
                                              "SheetName": "Add Basic Info",
                                              "Row#": "@{outputs('Current_Row_number')}",
                                              "Site": "@{outputs('Current_Site_Address')}",
                                              "Error": "@{variables('Error_Message')}"
                                            }
                                          }
                                        },
                                        "Filter_array_B1013": {
                                          "runAfter": {
                                            "Set_is_error_free_to_false_for_city_match_with_province_2": [
                                              "Succeeded"
                                            ]
                                          },
                                          "metadata": {
                                            "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                          },
                                          "type": "Query",
                                          "inputs": {
                                            "from": "@variables('Messages_Array')",
                                            "where": "@equals(item()['code'], 'B1013')"
                                          }
                                        },
                                        "Set_variable_Error_Message_8": {
                                          "runAfter": {
                                            "Filter_array_B1013": [
                                              "Succeeded"
                                            ]
                                          },
                                          "metadata": {
                                            "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                          },
                                          "type": "SetVariable",
                                          "inputs": {
                                            "name": "Error_Message",
                                            "value": "@{body('Filter_array_B1013')[0]['Message']}"
                                          }
                                        },
                                        "Add_Bulk_Log_details_Bulk008": {
                                          "runAfter": {
                                            "Append_to_array_-_City_doesn't_belong_to_province": [
                                              "Succeeded"
                                            ]
                                          },
                                          "metadata": {
                                            "operationMetadataId": "30269661-ce1c-4f70-abfe-8a81cf3f27d7"
                                          },
                                          "type": "OpenApiConnection",
                                          "inputs": {
                                            "host": {
                                              "connectionName": "shared_commondataserviceforapps_1",
                                              "operationId": "CreateRecord",
                                              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                            },
                                            "parameters": {
                                              "entityName": "cid_bulkactivitylogsdetailses",
                                              "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                              "item/cid_errordetails": "@variables('Error_Message')",
                                              "item/cid_errorwarningcode": "B1013",
                                              "item/cid_excelcolumnname": "City",
                                              "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                              "item/cid_excelsheetname": "Add Basic Info",
                                              "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                              "item/cid_type": 100000000
                                            },
                                            "authentication": "@parameters('$authentication')"
                                          }
                                        }
                                      }
                                    },
                                    "expression": {
                                      "greater": [
                                        "@length(body('Filter_Api_result_2'))",
                                        0
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "e95639cc-e26e-49c7-8d7b-b6bccf2987b5"
                                    },
                                    "type": "If"
                                  }
                                },
                                "runAfter": {
                                  "CityName": [
                                    "Succeeded"
                                  ]
                                },
                                "else": {
                                  "actions": {
                                    "Set_variable_error_free_to_false_for_city_not_correct_2_#": {
                                      "runAfter": {},
                                      "metadata": {
                                        "operationMetadataId": "3e23e089-210a-4907-8ba3-fb9fc8b12b3d"
                                      },
                                      "type": "SetVariable",
                                      "inputs": {
                                        "name": "IsErrorFree",
                                        "value": "@true"
                                      }
                                    },
                                    "Append_to_array_-_City_doesn't_belong_to_province_2": {
                                      "runAfter": {
                                        "Set_variable_Error_Message_Bulk007": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "0721f40e-9313-4b23-ac3a-e7e03fce1613"
                                      },
                                      "type": "AppendToArrayVariable",
                                      "inputs": {
                                        "name": "Error_List",
                                        "value": {
                                          "SheetName": "Add Basic Info",
                                          "Row#": "@{outputs('Current_Row_number')}",
                                          "Site": "@{outputs('Current_Site_Address')}",
                                          "Error": "@{variables('Error_Message')}"
                                        }
                                      }
                                    },
                                    "Filter_array_B1012": {
                                      "runAfter": {
                                        "Set_variable_error_free_to_false_for_city_not_correct_2_#": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                      },
                                      "type": "Query",
                                      "inputs": {
                                        "from": "@variables('Messages_Array')",
                                        "where": "@equals(item()['code'], 'B1012')"
                                      }
                                    },
                                    "Set_variable_Error_Message_Bulk007": {
                                      "runAfter": {
                                        "Filter_array_B1012": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                      },
                                      "type": "SetVariable",
                                      "inputs": {
                                        "name": "Error_Message",
                                        "value": "@{Replace(body('Filter_array_B1012')[0]['Message'] , '{0}' , outputs('CityName'))}"
                                      }
                                    },
                                    "Add_Bulk_Log_details_Bulk007": {
                                      "runAfter": {
                                        "Append_to_array_-_City_doesn't_belong_to_province_2": [
                                          "Succeeded"
                                        ]
                                      },
                                      "metadata": {
                                        "operationMetadataId": "7bd2c7c8-5212-4031-85a3-3de92b775314"
                                      },
                                      "type": "OpenApiConnection",
                                      "inputs": {
                                        "host": {
                                          "connectionName": "shared_commondataserviceforapps_1",
                                          "operationId": "CreateRecord",
                                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                        },
                                        "parameters": {
                                          "entityName": "cid_bulkactivitylogsdetailses",
                                          "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                          "item/cid_errordetails": "@variables('Error_Message')",
                                          "item/cid_errorwarningcode": "B1012",
                                          "item/cid_excelcolumnname": "City",
                                          "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                          "item/cid_excelsheetname": "Add Basic Info",
                                          "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                          "item/cid_type": 100000000
                                        },
                                        "authentication": "@parameters('$authentication')"
                                      }
                                    }
                                  }
                                },
                                "expression": {
                                  "greater": [
                                    "@length(body('Get_call_Canada_Geo_Api_to_get_province_2')['items'])",
                                    0
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "a9eea2f4-9c8d-4417-b0cc-5f707635bfcc"
                                },
                                "type": "If"
                              },
                              "CityName": {
                                "runAfter": {
                                  "Get_call_Canada_Geo_Api_to_get_province_2": [
                                    "Succeeded"
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "81202c9c-928b-469b-ae91-bff4c2633e78"
                                },
                                "type": "Compose",
                                "inputs": "@outputs('current_row')['City']"
                              }
                            },
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "288eb829-ba04-4fd3-87ca-4176b7fca5d4"
                            },
                            "type": "Scope"
                          }
                        },
                        "runAfter": {
                          "Check_Address_1": [
                            "Succeeded"
                          ]
                        },
                        "expression": {
                          "and": [
                            {
                              "greater": [
                                "@length(outputs('current_row')['City'])",
                                0
                              ]
                            },
                            {
                              "equals": [
                                1,
                                2
                              ]
                            }
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "420196d7-f357-4689-9c90-ba57b9d93b79"
                        },
                        "type": "If"
                      }
                    },
                    "runAfter": {},
                    "else": {
                      "actions": {
                        "Check_if_Missing_Legal_Land_description": {
                          "actions": {
                            "Check_section": {
                              "actions": {
                                "Filter_array_B1015": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                  },
                                  "type": "Query",
                                  "inputs": {
                                    "from": "@variables('Messages_Array')",
                                    "where": "@equals(item()['code'], 'B1015')"
                                  }
                                },
                                "Append_to_array_variable_4_Errorlist_3": {
                                  "runAfter": {
                                    "Set_variable_Error_Message_2": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                  },
                                  "type": "AppendToArrayVariable",
                                  "inputs": {
                                    "name": "Error_List",
                                    "value": {
                                      "SheetName": "Add Basic Info",
                                      "Row#": "@{outputs('Current_Row_number')}",
                                      "Site": "@{outputs('Current_Site_Address')}",
                                      "Error": "@{variables('Error_Message')}"
                                    }
                                  }
                                },
                                "Set_variable_Error_Message_2": {
                                  "runAfter": {
                                    "Filter_array_B1015": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                  },
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Error_Message",
                                    "value": "@{body('Filter_array_B1015')[0]['Message']}"
                                  }
                                },
                                "Filter_Messages_to_log_in_bulk_log_details_B1015": {
                                  "runAfter": {
                                    "Append_to_array_variable_4_Errorlist_3": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "fe2dd070-afaa-4b12-b4fe-f9c9f795184f"
                                  },
                                  "type": "Query",
                                  "inputs": {
                                    "from": "@body('Parse_Messages_to_JSON')",
                                    "where": "@equals(item()['code'], 'B1015')"
                                  }
                                },
                                "Add_Bulk_Log_details_B1015": {
                                  "runAfter": {
                                    "Filter_Messages_to_log_in_bulk_log_details_B1015": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "b54fee31-33a5-45b9-bf79-2014ffad6776"
                                  },
                                  "type": "OpenApiConnection",
                                  "inputs": {
                                    "host": {
                                      "connectionName": "shared_commondataserviceforapps_1",
                                      "operationId": "CreateRecord",
                                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                    },
                                    "parameters": {
                                      "entityName": "cid_bulkactivitylogsdetailses",
                                      "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                      "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1015')[0]['Eng-Message']",
                                      "item/cid_errorwarningcode": "B1015",
                                      "item/cid_excelcolumnname": "Section",
                                      "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                      "item/cid_excelsheetname": "Add Basic Info",
                                      "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                      "item/cid_type": 100000000
                                    },
                                    "authentication": "@parameters('$authentication')"
                                  }
                                }
                              },
                              "runAfter": {},
                              "expression": {
                                "lessOrEquals": [
                                  "@length(string(outputs('current_row')['Section']))",
                                  0
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                              },
                              "type": "If"
                            },
                            "Check_TownShip": {
                              "actions": {
                                "Filter_array_B1016": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                  },
                                  "type": "Query",
                                  "inputs": {
                                    "from": "@variables('Messages_Array')",
                                    "where": "@equals(item()['code'], 'B1016')"
                                  }
                                },
                                "Append_to_array_variable_4_Errorlist_4": {
                                  "runAfter": {
                                    "Set_variable_Error_Message_3": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                  },
                                  "type": "AppendToArrayVariable",
                                  "inputs": {
                                    "name": "Error_List",
                                    "value": {
                                      "SheetName": "Add Basic Info",
                                      "Row#": "@{outputs('Current_Row_number')}",
                                      "Site": "@{outputs('Current_Site_Address')}",
                                      "Error": "@{variables('Error_Message')}"
                                    }
                                  }
                                },
                                "Set_variable_Error_Message_3": {
                                  "runAfter": {
                                    "Filter_array_B1016": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                  },
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Error_Message",
                                    "value": "@{body('Filter_array_B1016')[0]['Message']}"
                                  }
                                },
                                "Filter_Messages_to_log_in_bulk_log_details_B1016": {
                                  "runAfter": {
                                    "Append_to_array_variable_4_Errorlist_4": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "7b170bd0-0ff4-4d36-ad8f-3b0a1dab84af"
                                  },
                                  "type": "Query",
                                  "inputs": {
                                    "from": "@body('Parse_Messages_to_JSON')",
                                    "where": "@equals(item()['code'], 'Bulk012')"
                                  }
                                },
                                "Add_Bulk_Log_details_B1016": {
                                  "runAfter": {
                                    "Filter_Messages_to_log_in_bulk_log_details_B1016": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "e5be8d2d-7ebb-4d4a-81a0-a845b30523f1"
                                  },
                                  "type": "OpenApiConnection",
                                  "inputs": {
                                    "host": {
                                      "connectionName": "shared_commondataserviceforapps_1",
                                      "operationId": "CreateRecord",
                                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                    },
                                    "parameters": {
                                      "entityName": "cid_bulkactivitylogsdetailses",
                                      "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                      "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1016')[0]['Eng-Message']",
                                      "item/cid_errorwarningcode": "B1016",
                                      "item/cid_excelcolumnname": "Township",
                                      "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                      "item/cid_excelsheetname": "Add Basic Info",
                                      "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                      "item/cid_type": 100000000
                                    },
                                    "authentication": "@parameters('$authentication')"
                                  }
                                }
                              },
                              "runAfter": {
                                "Check_section": [
                                  "Succeeded"
                                ]
                              },
                              "expression": {
                                "lessOrEquals": [
                                  "@length(string(outputs('current_row')['TownShip']))",
                                  0
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                              },
                              "type": "If"
                            },
                            "Check_Range": {
                              "actions": {
                                "Filter_array_B1017": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                  },
                                  "type": "Query",
                                  "inputs": {
                                    "from": "@variables('Messages_Array')",
                                    "where": "@equals(item()['code'], 'B1017')"
                                  }
                                },
                                "Append_to_array_variable_4_Errorlist_5": {
                                  "runAfter": {
                                    "Set_variable_Error_Message_4": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                  },
                                  "type": "AppendToArrayVariable",
                                  "inputs": {
                                    "name": "Error_List",
                                    "value": {
                                      "SheetName": "Add Basic Info",
                                      "Row#": "@{outputs('Current_Row_number')}",
                                      "Site": "@{outputs('Current_Site_Address')}",
                                      "Error": "@{variables('Error_Message')}"
                                    }
                                  }
                                },
                                "Set_variable_Error_Message_4": {
                                  "runAfter": {
                                    "Filter_array_B1017": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                  },
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Error_Message",
                                    "value": "@{body('Filter_array_B1017')[0]['Message']}"
                                  }
                                },
                                "Filter_Messages_to_log_in_bulk_log_details_B1017": {
                                  "runAfter": {
                                    "Append_to_array_variable_4_Errorlist_5": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "d99d7787-edfb-4878-aff6-3c52ff11aa06"
                                  },
                                  "type": "Query",
                                  "inputs": {
                                    "from": "@body('Parse_Messages_to_JSON')",
                                    "where": "@equals(item()['code'], 'B1017')"
                                  }
                                },
                                "Add_Bulk_Log_details_B1017": {
                                  "runAfter": {
                                    "Filter_Messages_to_log_in_bulk_log_details_B1017": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "e2b2b8a7-82cc-4b92-a48f-c1692a32610b"
                                  },
                                  "type": "OpenApiConnection",
                                  "inputs": {
                                    "host": {
                                      "connectionName": "shared_commondataserviceforapps_1",
                                      "operationId": "CreateRecord",
                                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                    },
                                    "parameters": {
                                      "entityName": "cid_bulkactivitylogsdetailses",
                                      "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                      "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1017')[0]['Eng-Message']",
                                      "item/cid_errorwarningcode": "B1017",
                                      "item/cid_excelcolumnname": "Range",
                                      "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                      "item/cid_excelsheetname": "Add Basic Info",
                                      "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                      "item/cid_type": 100000000
                                    },
                                    "authentication": "@parameters('$authentication')"
                                  }
                                }
                              },
                              "runAfter": {
                                "Check_TownShip": [
                                  "Succeeded"
                                ]
                              },
                              "expression": {
                                "lessOrEquals": [
                                  "@length(string(outputs('current_row')['Range']))",
                                  0
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                              },
                              "type": "If"
                            },
                            "Check_Meridian": {
                              "actions": {
                                "Filter_array_B1018": {
                                  "runAfter": {},
                                  "metadata": {
                                    "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                  },
                                  "type": "Query",
                                  "inputs": {
                                    "from": "@variables('Messages_Array')",
                                    "where": "@equals(item()['code'], 'B1018')"
                                  }
                                },
                                "Append_to_array_variable_4_Errorlist_6": {
                                  "runAfter": {
                                    "Set_variable_Error_Message_5": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                  },
                                  "type": "AppendToArrayVariable",
                                  "inputs": {
                                    "name": "Error_List",
                                    "value": {
                                      "SheetName": "Add Basic Info",
                                      "Row#": "@{outputs('Current_Row_number')}",
                                      "Site": "@{outputs('Current_Site_Address')}",
                                      "Error": "@{variables('Error_Message')}"
                                    }
                                  }
                                },
                                "Set_variable_Error_Message_5": {
                                  "runAfter": {
                                    "Filter_array_B1018": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                  },
                                  "type": "SetVariable",
                                  "inputs": {
                                    "name": "Error_Message",
                                    "value": "@{body('Filter_array_B1018')[0]['Message']}"
                                  }
                                },
                                "Filter_Messages_to_log_in_bulk_log_details_B1018": {
                                  "runAfter": {
                                    "Append_to_array_variable_4_Errorlist_6": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "304a49df-cd00-4266-bcd1-0ade7b0728ff"
                                  },
                                  "type": "Query",
                                  "inputs": {
                                    "from": "@body('Parse_Messages_to_JSON')",
                                    "where": "@equals(item()['code'], 'B1018')"
                                  }
                                },
                                "Add_Bulk_Log_details_B1018": {
                                  "runAfter": {
                                    "Filter_Messages_to_log_in_bulk_log_details_B1018": [
                                      "Succeeded"
                                    ]
                                  },
                                  "metadata": {
                                    "operationMetadataId": "0e77b235-1a2c-406e-929a-e9749c90e44c"
                                  },
                                  "type": "OpenApiConnection",
                                  "inputs": {
                                    "host": {
                                      "connectionName": "shared_commondataserviceforapps_1",
                                      "operationId": "CreateRecord",
                                      "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                    },
                                    "parameters": {
                                      "entityName": "cid_bulkactivitylogsdetailses",
                                      "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                      "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1018')[0]['Eng-Message']",
                                      "item/cid_errorwarningcode": "B1018",
                                      "item/cid_excelcolumnname": "Meridian",
                                      "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                      "item/cid_excelsheetname": "Add Basic Info",
                                      "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                      "item/cid_type": 100000000
                                    },
                                    "authentication": "@parameters('$authentication')"
                                  }
                                }
                              },
                              "runAfter": {
                                "Check_Range": [
                                  "Succeeded"
                                ]
                              },
                              "expression": {
                                "lessOrEquals": [
                                  "@length(string(outputs('current_row')['Meridian']))",
                                  0
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                              },
                              "type": "If"
                            }
                          },
                          "runAfter": {},
                          "else": {
                            "actions": {
                              "Check_if_Missing_Lat_and_Long_1C_address": {
                                "actions": {
                                  "Check_Latitude": {
                                    "actions": {
                                      "Filter_array_B1020": {
                                        "runAfter": {},
                                        "metadata": {
                                          "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                        },
                                        "type": "Query",
                                        "inputs": {
                                          "from": "@variables('Messages_Array')",
                                          "where": "@equals(item()['code'], 'B1020')"
                                        }
                                      },
                                      "Append_to_array_variable_4_Errorlist_7": {
                                        "runAfter": {
                                          "Set_variable_Error_Message_6": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                        },
                                        "type": "AppendToArrayVariable",
                                        "inputs": {
                                          "name": "Error_List",
                                          "value": {
                                            "SheetName": "Add Basic Info",
                                            "Row#": "@{outputs('Current_Row_number')}",
                                            "Site": "@{outputs('Current_Site_Address')}",
                                            "Error": "@{variables('Error_Message')}"
                                          }
                                        }
                                      },
                                      "Set_variable_Error_Message_6": {
                                        "runAfter": {
                                          "Filter_array_B1020": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                        },
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "Error_Message",
                                          "value": "@{body('Filter_array_B1020')[0]['Message']}"
                                        }
                                      },
                                      "Filter_Messages_to_log_in_bulk_log_details_B1020": {
                                        "runAfter": {
                                          "Append_to_array_variable_4_Errorlist_7": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "322f87e9-71bf-4108-aeb9-e87f3dfd7dd8"
                                        },
                                        "type": "Query",
                                        "inputs": {
                                          "from": "@body('Parse_Messages_to_JSON')",
                                          "where": "@equals(item()['code'], 'B1020')"
                                        }
                                      },
                                      "Add_Bulk_Log_details_B1020": {
                                        "runAfter": {
                                          "Filter_Messages_to_log_in_bulk_log_details_B1020": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "8d221767-ff8f-4d7a-90c7-8b3284c6d76a"
                                        },
                                        "type": "OpenApiConnection",
                                        "inputs": {
                                          "host": {
                                            "connectionName": "shared_commondataserviceforapps_1",
                                            "operationId": "CreateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                          },
                                          "parameters": {
                                            "entityName": "cid_bulkactivitylogsdetailses",
                                            "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                            "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1020')[0]['Eng-Message']",
                                            "item/cid_errorwarningcode": "B1020",
                                            "item/cid_excelcolumnname": "Latitude",
                                            "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                            "item/cid_excelsheetname": "Add Basic Info",
                                            "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                            "item/cid_type": 100000000
                                          },
                                          "authentication": "@parameters('$authentication')"
                                        }
                                      }
                                    },
                                    "runAfter": {},
                                    "expression": {
                                      "lessOrEquals": [
                                        "@length(string(outputs('current_row')['Lat']))",
                                        0
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                                    },
                                    "type": "If"
                                  },
                                  "Check_Longitude": {
                                    "actions": {
                                      "Filter_array_B1021": {
                                        "runAfter": {},
                                        "metadata": {
                                          "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                                        },
                                        "type": "Query",
                                        "inputs": {
                                          "from": "@variables('Messages_Array')",
                                          "where": "@equals(item()['code'], 'B1021')"
                                        }
                                      },
                                      "Append_to_array_variable_4_Errorlist_8": {
                                        "runAfter": {
                                          "Set_variable_Error_Message_7": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "85c7e65a-af81-4614-ac8e-c5e10abdba27"
                                        },
                                        "type": "AppendToArrayVariable",
                                        "inputs": {
                                          "name": "Error_List",
                                          "value": {
                                            "SheetName": "Add Basic Info",
                                            "Row#": "@{outputs('Current_Row_number')}",
                                            "Site": "@{outputs('Current_Site_Address')}",
                                            "Error": "@{variables('Error_Message')}"
                                          }
                                        }
                                      },
                                      "Set_variable_Error_Message_7": {
                                        "runAfter": {
                                          "Filter_array_B1021": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                                        },
                                        "type": "SetVariable",
                                        "inputs": {
                                          "name": "Error_Message",
                                          "value": "@{body('Filter_array_B1021')[0]['Message']}"
                                        }
                                      },
                                      "Filter_Messages_to_log_in_bulk_log_details_B1021": {
                                        "runAfter": {
                                          "Append_to_array_variable_4_Errorlist_8": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "63457463-77bd-4d80-b3f2-d8e61ee01398"
                                        },
                                        "type": "Query",
                                        "inputs": {
                                          "from": "@body('Parse_Messages_to_JSON')",
                                          "where": "@equals(item()['code'], 'B1021')"
                                        }
                                      },
                                      "Add_Bulk_Log_details_Longitude": {
                                        "runAfter": {
                                          "Filter_Messages_to_log_in_bulk_log_details_B1021": [
                                            "Succeeded"
                                          ]
                                        },
                                        "metadata": {
                                          "operationMetadataId": "26a6204e-8cb3-417f-ab0e-14dad7a3067a"
                                        },
                                        "type": "OpenApiConnection",
                                        "inputs": {
                                          "host": {
                                            "connectionName": "shared_commondataserviceforapps_1",
                                            "operationId": "CreateRecord",
                                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                          },
                                          "parameters": {
                                            "entityName": "cid_bulkactivitylogsdetailses",
                                            "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                                            "item/cid_errordetails": "@body('Filter_Messages_to_log_in_bulk_log_details_B1021')[0]['Eng-Message']",
                                            "item/cid_errorwarningcode": "B1021",
                                            "item/cid_excelcolumnname": "Longtitude",
                                            "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                                            "item/cid_excelsheetname": "Add Basic Info",
                                            "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                                            "item/cid_type": 100000000
                                          },
                                          "authentication": "@parameters('$authentication')"
                                        }
                                      }
                                    },
                                    "runAfter": {
                                      "Check_Latitude": [
                                        "Succeeded"
                                      ]
                                    },
                                    "expression": {
                                      "lessOrEquals": [
                                        "@length(string(outputs('current_row')['Long']))",
                                        0
                                      ]
                                    },
                                    "metadata": {
                                      "operationMetadataId": "725e56d3-242b-452e-9c3a-45d947d14ada"
                                    },
                                    "type": "If"
                                  }
                                },
                                "runAfter": {},
                                "expression": {
                                  "or": [
                                    {
                                      "greater": [
                                        "@length(string(outputs('current_row')['Lat']))",
                                        0
                                      ]
                                    },
                                    {
                                      "greater": [
                                        "@length(string(outputs('current_row')['Long']))",
                                        0
                                      ]
                                    }
                                  ]
                                },
                                "metadata": {
                                  "operationMetadataId": "74bae040-97ca-4985-9ad3-540d32283954"
                                },
                                "type": "If"
                              }
                            }
                          },
                          "expression": {
                            "or": [
                              {
                                "greater": [
                                  "@length(string(outputs('current_row')['Section']))",
                                  0
                                ]
                              },
                              {
                                "greater": [
                                  "@length(string(outputs('current_row')['TownShip']))",
                                  0
                                ]
                              },
                              {
                                "greater": [
                                  "@length(string(outputs('current_row')['Range']))",
                                  0
                                ]
                              },
                              {
                                "greater": [
                                  "@length(string(outputs('current_row')['Meridian']))",
                                  0
                                ]
                              }
                            ]
                          },
                          "metadata": {
                            "operationMetadataId": "74bae040-97ca-4985-9ad3-540d32283954"
                          },
                          "type": "If"
                        }
                      }
                    },
                    "expression": {
                      "or": [
                        {
                          "or": [
                            {
                              "greater": [
                                "@length(outputs('current_row')['Address1'])",
                                0
                              ]
                            },
                            {
                              "greater": [
                                "@length(outputs('current_row')['City'])",
                                0
                              ]
                            },
                            {
                              "greater": [
                                "@length(outputs('current_row')['Province'])",
                                0
                              ]
                            },
                            {
                              "greater": [
                                "@length(outputs('current_row')['PostalCode'])",
                                0
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    "metadata": {
                      "operationMetadataId": "74bae040-97ca-4985-9ad3-540d32283954"
                    },
                    "type": "If"
                  }
                }
              },
              "expression": {
                "or": [
                  {
                    "and": [
                      {
                        "greater": [
                          "@length(outputs('current_row')['Address1'])",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length(outputs('current_row')['City'])",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length(outputs('current_row')['Province'])",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length(outputs('current_row')['PostalCode'])",
                          0
                        ]
                      },
                      {
                        "not": {
                          "equals": [
                            "@outputs('current_row')['Class']",
                            "@null"
                          ]
                        }
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['Range']))",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['Section']))",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['TownShip']))",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['Meridian']))",
                          0
                        ]
                      }
                    ]
                  },
                  {
                    "and": [
                      {
                        "greater": [
                          "@length(string(outputs('current_row')['Lat']))",
                          0
                        ]
                      },
                      {
                        "greater": [
                          "@length( string(outputs('current_row')['Long']))",
                          0
                        ]
                      }
                    ]
                  }
                ]
              },
              "metadata": {
                "operationMetadataId": "74bae040-97ca-4985-9ad3-540d32283954"
              },
              "type": "If"
            },
            "Mode_of_Transportation_Logic": {
              "actions": {
                "Check_if_at_least_one_mode_exists": {
                  "actions": {},
                  "runAfter": {},
                  "else": {
                    "actions": {
                      "Set_variable_IsErrorFree_to_false_for_mode_errors": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "e9edbab6-4b56-410c-842e-a982a3055db1"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "IsErrorFree",
                          "value": "@false"
                        }
                      },
                      "Append_to_array_variable_-_modes_error": {
                        "runAfter": {
                          "Set_variable_Error_Message_B1023": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "d1d67445-b348-4caa-83df-ac7c8e361e9a"
                        },
                        "type": "AppendToArrayVariable",
                        "inputs": {
                          "name": "Error_List",
                          "value": {
                            "SheetName": "Add Basic Info",
                            "Row#": "@{outputs('Current_Row_number')}",
                            "Site": "@{outputs('Current_Site_Address')}",
                            "Error": "@{variables('Error_Message')}"
                          }
                        }
                      },
                      "Filter_array_B1023": {
                        "runAfter": {
                          "Set_variable_IsErrorFree_to_false_for_mode_errors": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                        },
                        "type": "Query",
                        "inputs": {
                          "from": "@variables('Messages_Array')",
                          "where": "@equals(item()['code'], 'B1023')"
                        }
                      },
                      "Set_variable_Error_Message_B1023": {
                        "runAfter": {
                          "Filter_array_B1023": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "Error_Message",
                          "value": "@{body('Filter_array_B1023')[0]['Message']}"
                        }
                      },
                      "Add_Bulk_Log_details_Bulk019": {
                        "runAfter": {
                          "Append_to_array_variable_-_modes_error": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "0c1b58a4-09cf-4bca-b3a2-1f3988851215"
                        },
                        "type": "OpenApiConnection",
                        "inputs": {
                          "host": {
                            "connectionName": "shared_commondataserviceforapps_1",
                            "operationId": "CreateRecord",
                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                          },
                          "parameters": {
                            "entityName": "cid_bulkactivitylogsdetailses",
                            "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                            "item/cid_errordetails": "@variables('Error_Message')",
                            "item/cid_errorwarningcode": "B1023",
                            "item/cid_excelcolumnname": "Mode of Transportation",
                            "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                            "item/cid_excelsheetname": "Add Basic Info",
                            "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                            "item/cid_type": 100000000
                          },
                          "authentication": "@parameters('$authentication')"
                        }
                      }
                    }
                  },
                  "expression": {
                    "or": [
                      {
                        "equals": [
                          "@outputs('current_row')['Air']",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Marine']",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Rail']",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Road']",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Air']",
                          "oui"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Marine']",
                          "oui"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Rail']",
                          "oui"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Road']",
                          "oui"
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "d7a96b62-a00a-407a-b778-10a161f45109"
                  },
                  "type": "If"
                }
              },
              "runAfter": {
                "Check_if_all_required_address_information_is_entered": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "0a977c2b-2929-4abe-88a5-96f8d33788c9"
              },
              "type": "Scope"
            },
            "Check_HOTI_activities": {
              "actions": {
                "Check_if_at_least_one_HOT_IT_activity_is_selected": {
                  "actions": {},
                  "runAfter": {},
                  "else": {
                    "actions": {
                      "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_2": {
                        "runAfter": {},
                        "metadata": {
                          "operationMetadataId": "eeda5e90-d330-4124-9c56-2029e3095b38"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "IsErrorFree",
                          "value": "@false"
                        }
                      },
                      "Append_to_array_HOTI_activity_error_": {
                        "runAfter": {
                          "Set_variable_Error_Message_B1027": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "5156ed84-5eb7-4e4c-877b-da09e286f3f8"
                        },
                        "type": "AppendToArrayVariable",
                        "inputs": {
                          "name": "Error_List",
                          "value": {
                            "SheetName": "Add Basic Info",
                            "Row#": "@{outputs('Current_Row_number')}",
                            "Site": "@{outputs('Current_Site_Address')}",
                            "Error": "@{variables('Error_Message')}"
                          }
                        }
                      },
                      "Filter_array_B1027": {
                        "runAfter": {
                          "Set_variable_IsErrorFree_to_false_for_HOTI_activities_errors_2": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "80b29c84-7347-4907-bf75-cb1f1f4e2161"
                        },
                        "type": "Query",
                        "inputs": {
                          "from": "@variables('Messages_Array')",
                          "where": "@equals(item()['code'], 'B1027')"
                        }
                      },
                      "Set_variable_Error_Message_B1027": {
                        "runAfter": {
                          "Filter_array_B1027": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "cf2c55e7-ed16-4aa6-b13e-61c36959a8f5"
                        },
                        "type": "SetVariable",
                        "inputs": {
                          "name": "Error_Message",
                          "value": "@{body('Filter_array_B1027')[0]['Message']}"
                        }
                      },
                      "Add_Bulk_Log_details_B1027": {
                        "runAfter": {
                          "Append_to_array_HOTI_activity_error_": [
                            "Succeeded"
                          ]
                        },
                        "metadata": {
                          "operationMetadataId": "6e1bfa11-2ebb-42d9-8b27-288724513534"
                        },
                        "type": "OpenApiConnection",
                        "inputs": {
                          "host": {
                            "connectionName": "shared_commondataserviceforapps_1",
                            "operationId": "CreateRecord",
                            "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                          },
                          "parameters": {
                            "entityName": "cid_bulkactivitylogsdetailses",
                            "item/cid_BulkActivityLogSummary@odata.bind": "@concat('\\cid_bulkactivitylogsummaries\\',triggerOutputs()?['body/cid_bulkactivitylogsummaryid'])",
                            "item/cid_errordetails": "@variables('Error_Message')",
                            "item/cid_errorwarningcode": "B1027",
                            "item/cid_excelcolumnname": "HOT IT Activities",
                            "item/cid_excelrownumber": "@outputs('Current_Row_number')",
                            "item/cid_excelsheetname": "Add Basic Info",
                            "item/cid_sitelocation": "@outputs('Current_Site_Address')",
                            "item/cid_type": 100000000
                          },
                          "authentication": "@parameters('$authentication')"
                        }
                      }
                    }
                  },
                  "expression": {
                    "or": [
                      {
                        "equals": [
                          "@outputs('current_row')['Handle']",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['OfferForTransport']",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Transport']",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Import']",
                          "Yes"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Handle']",
                          "oui"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['OfferForTransport']",
                          "oui"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Transport']",
                          "oui"
                        ]
                      },
                      {
                        "equals": [
                          "@outputs('current_row')['Import']",
                          "oui"
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "operationMetadataId": "2ab90895-e7b6-4898-85c4-992378e704ac"
                  },
                  "type": "If"
                }
              },
              "runAfter": {
                "Mode_of_Transportation_Logic": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "1a6fe45b-fc97-4bcd-a416-c44ce3a96775"
              },
              "type": "Scope"
            }
          },
          "runAfter": {
            "Terminate": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "a13dfb1a-1128-4977-9f3a-295db5d71229"
          },
          "type": "Foreach"
        },
        "Terminate": {
          "runAfter": {
            "check_error_flag": [
              "Succeeded"
            ]
          },
          "metadata": {
            "operationMetadataId": "0b7cb723-a2be-415c-94fc-92d3ff0c050f"
          },
          "type": "Terminate",
          "inputs": {
            "runStatus": "Succeeded"
          }
        }
      }
    }
  },
  "schemaVersion": "1.0.0.0"
}