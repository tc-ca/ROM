<?xml version="1.0" encoding="utf-8"?>
<RibbonDiffXml xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <CustomActions />
  <Templates>
    <RibbonTemplates Id="Mscrm.Templates"></RibbonTemplates>
  </Templates>
  <CommandDefinitions>
    <CommandDefinition Id="Mscrm.AddExistingRecordFromSubGridAssociated">
      <EnableRules>
        <EnableRule Id="Mscrm.AppendToPrimary" />
        <EnableRule Id="Mscrm.EntityFormIsEnabled" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.AddExisting" />
        <DisplayRule Id="Mscrm.ShowForManyToManyGrids" />
        <DisplayRule Id="Mscrm.AppendToPrimary" />
        <DisplayRule Id="Mscrm.AppendPrimary" />
        <DisplayRule Id="Mscrm.AppendSelected" />
        <DisplayRule Id="Mscrm.AppendToSelected" />
        <DisplayRule Id="ovs.tc_tcfiscalyear.HideButtonOnSubGridWhenEntityIsOperation.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.AddFromSubGrid.addExistingFromSubGridAssociated" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="SelectedEntityTypeName" />
          <CrmParameter Value="SelectedControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.AddExistingRecordFromSubGridStandard">
      <EnableRules>
        <EnableRule Id="Mscrm.AppendToPrimary" />
        <EnableRule Id="Mscrm.EntityFormIsEnabled" />
        <EnableRule Id="Mscrm.IsEntityAvailableForUserInMocaOffline" />
        <EnableRule Id="Mscrm.IsRelationshipEnabledInMocaOffline" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.AddExisting" />
        <DisplayRule Id="Mscrm.ShowForOneToManyGrids" />
        <DisplayRule Id="Mscrm.AppendToPrimary" />
        <DisplayRule Id="Mscrm.AppendSelected" />
        <DisplayRule Id="Mscrm.CanWriteSelected" />
        <DisplayRule Id="ovs.tc_tcfiscalyear.HideButtonOnSubGridWhenEntityIsOperation.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.AddFromSubGrid.addExistingFromSubGridStandard" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="SelectedEntityTypeName" />
          <CrmParameter Value="SelectedControl" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.AssignSelectedRecord">
      <EnableRules>
        <EnableRule Id="Mscrm.SelectionCountAtLeastOne" />
        <EnableRule Id="Mscrm.VisualizationPaneNotMaximized" />
        <EnableRule Id="Mscrm.NotOffline" />
        <EnableRule Id="Mscrm.IsValidForHierarchyView" />
        <EnableRule Id="Mscrm.IsValidForHierarchyPageInUC" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.AssignSelectedEntityPermission" />
        <DisplayRule Id="ovs.tc_tcfiscalyear.HideButtonOnSubGridWhenEntityIsOperation.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.Assign.assignSelectedRecords" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="SelectedControl" />
          <CrmParameter Value="SelectedControlSelectedItemReferences" />
          <CrmParameter Value="SelectedEntityTypeName" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.EditSelectedRecord">
      <EnableRules>
        <EnableRule Id="Mscrm.CheckBulkEditSupportForEntity" />
        <EnableRule Id="Mscrm.VisualizationPaneNotMaximized" />
        <EnableRule Id="Mscrm.IsValidForHierarchyView" />
        <EnableRule Id="Mscrm.ShowOnNonModernAndModernIfAllowed" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.BulkEditPrivilege" />
        <DisplayRule Id="Mscrm.WriteSelectedEntityPermission" />
        <DisplayRule Id="ovs.tc_tcfiscalyear.HideButtonOnSubGridWhenEntityIsOperation.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.BulkEdit.bulkEditRecords" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="SelectedControl" />
          <CrmParameter Value="SelectedControlSelectedItemReferences" />
          <CrmParameter Value="SelectedEntityTypeName" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.HomepageGrid.Activate">
      <EnableRules>
        <EnableRule Id="Mscrm.VisualizationPaneNotMaximized" />
        <EnableRule Id="Mscrm.SelectionCountAtLeastOne" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.CanWriteSelected" />
        <DisplayRule Id="Mscrm.SelectedEntityHasStatecode" />
        <DisplayRule Id="ovs.tc_tcfiscalyear.HideButtonOnSubGridWhenEntityIsOperation.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.Activate.activateRecords" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="SelectedControl" />
          <CrmParameter Value="SelectedControlSelectedItemReferences" />
          <CrmParameter Value="SelectedEntityTypeName" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.HomepageGrid.Deactivate">
      <EnableRules>
        <EnableRule Id="Mscrm.VisualizationPaneNotMaximized" />
        <EnableRule Id="Mscrm.SelectionCountAtLeastOne" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.CanWriteSelected" />
        <DisplayRule Id="Mscrm.SelectedEntityHasStatecode" />
        <DisplayRule Id="ovs.tc_tcfiscalyear.HideButtonOnSubGridWhenEntityIsOperation.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.Deactivate.deactivateRecords" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="SelectedControl" />
          <CrmParameter Value="SelectedControlSelectedItemReferences" />
          <CrmParameter Value="SelectedEntityTypeName" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.RemoveSelectedRecord">
      <EnableRules>
        <EnableRule Id="Mscrm.SelectionCountAtLeastOne" />
        <EnableRule Id="Mscrm.AppendToPrimary" />
        <EnableRule Id="Mscrm.VisualizationPaneNotMaximized" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.ShowForManyToManyGrids" />
        <DisplayRule Id="Mscrm.AppendToPrimary" />
        <DisplayRule Id="ovs.tc_tcfiscalyear.HideButtonOnSubGridWhenEntityIsOperation.DisplayRule" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.Disassociate.gridDisassociate" Library="$webresource:Main_system_library.js">
          <CrmParameter Value="SelectedEntityTypeName" />
          <CrmParameter Value="SelectedControl" />
          <CrmParameter Value="FirstSelectedItemId" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
  </CommandDefinitions>
  <RuleDefinitions>
    <TabDisplayRules />
    <DisplayRules>
      <DisplayRule Id="Mscrm.AssignSelectedEntityPermission">
        <EntityPrivilegeRule PrivilegeType="Assign" PrivilegeDepth="Basic" AppliesTo="SelectedEntity" />
      </DisplayRule>
      <DisplayRule Id="ovs.tc_tcfiscalyear.HideButtonOnSubGridWhenEntityIsOperation.DisplayRule">
        <EntityRule EntityName="ovs_mocregistration" AppliesTo="PrimaryEntity" Context="SubGridStandard" Default="false" InvertResult="true" />
      </DisplayRule>
    </DisplayRules>
    <EnableRules>
      <EnableRule Id="Mscrm.IsValidForHierarchyPageInUC">
        <CustomRule FunctionName="XrmCore.Rules.HierarchyView.isValidForHierarchyPageInUC" Library="$webresource:Main_system_library.js" />
      </EnableRule>
    </EnableRules>
  </RuleDefinitions>
  <LocLabels />
</RibbonDiffXml>